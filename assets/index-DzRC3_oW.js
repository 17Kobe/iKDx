import{x as $,a6 as ce,y as D,N as Y,O as _,r as S,ab as he,ac as Ue,h as xe,a8 as Ze,f as oe,ad as Ge,$ as H,d as p,c as ee,u as se,k as r,a7 as Oe,T as Pe,ae as Je,a2 as L,j as Te,v as Ee,l as U,t as te,a as q,o as Le,g as Qe,J as pe,m as V,af as et,n as Q,H as tt,I as X,ag as Ae,ah as nt,X as at,Z as lt,ai as ot,i as rt,aj as it,ak as ct,al as st,am as ut,a4 as dt,S as ft,an as vt,e as me,ao as gt,ap as ht,aq as be,M as mt,ar as bt,as as yt,q as ye}from"./index-BP_xmi17.js";function ue(e){const n=ce();n&&$(n.proxy,e)}let It=2e3;const Ct=()=>++It,_e={show:Boolean,zIndex:_,overlay:D,duration:_,teleport:[String,Object],lockScroll:D,lazyRender:D,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:Y,transitionAppear:Boolean,closeOnClickOverlay:D},Jt=Object.keys(_e);function kt(e,n){return e>n?"horizontal":n>e?"vertical":""}function St(){const e=S(0),n=S(0),a=S(0),f=S(0),l=S(0),o=S(0),h=S(""),v=S(!0),i=()=>h.value==="vertical",m=()=>h.value==="horizontal",u=()=>{a.value=0,f.value=0,l.value=0,o.value=0,h.value="",v.value=!0};return{move:I=>{const w=I.touches[0];a.value=(w.clientX<0?0:w.clientX)-e.value,f.value=w.clientY-n.value,l.value=Math.abs(a.value),o.value=Math.abs(f.value);const y=10;(!h.value||l.value<y&&o.value<y)&&(h.value=kt(l.value,o.value)),v.value&&(l.value>he||o.value>he)&&(v.value=!1)},start:I=>{u(),e.value=I.touches[0].clientX,n.value=I.touches[0].clientY},reset:u,startX:e,startY:n,deltaX:a,deltaY:f,offsetX:l,offsetY:o,direction:h,isVertical:i,isHorizontal:m,isTap:v}}let G=0;const Ie="van-overflow-hidden";function wt(e,n){const a=St(),f="01",l="10",o=u=>{a.move(u);const x=a.deltaY.value>0?l:f,T=Ge(u.target,e.value),{scrollHeight:I,offsetHeight:w,scrollTop:y}=T;let C="11";y===0?C=w>=I?"00":"01":y+w>=I&&(C="10"),C!=="11"&&a.isVertical()&&!(parseInt(C,2)&parseInt(x,2))&&H(u,!0)},h=()=>{document.addEventListener("touchstart",a.start),document.addEventListener("touchmove",o,{passive:!1}),G||document.body.classList.add(Ie),G++},v=()=>{G&&(document.removeEventListener("touchstart",a.start),document.removeEventListener("touchmove",o),G--,G||document.body.classList.remove(Ie))},i=()=>n()&&h(),m=()=>n()&&v();Ue(i),xe(m),Ze(m),oe(n,u=>{u?h():v()})}function Ve(e){const n=S(!1);return oe(e,a=>{a&&(n.value=a)},{immediate:!0}),a=>()=>n.value?a():null}const Ce=()=>{var e;const{scopeId:n}=((e=ce())==null?void 0:e.vnode)||{};return n?{[n]:""}:null},[xt,Ot]=ee("overlay"),Pt={show:Boolean,zIndex:_,duration:_,className:Y,lockScroll:D,lazyRender:D,customStyle:Object,teleport:[String,Object]};var Tt=p({name:xt,inheritAttrs:!1,props:Pt,setup(e,{attrs:n,slots:a}){const f=S(),l=Ve(()=>e.show||!e.lazyRender),o=v=>{e.lockScroll&&H(v,!0)},h=l(()=>{var v;const i=$(Je(e.zIndex),e.customStyle);return L(e.duration)&&(i.animationDuration=`${e.duration}s`),Te(r("div",U({ref:f,style:i,class:[Ot(),e.className]},n),[(v=a.default)==null?void 0:v.call(a)]),[[Ee,e.show]])});return se("touchmove",o,{target:f}),()=>{const v=r(Oe,{name:"van-fade",appear:!0},{default:h});return e.teleport?r(Pe,{to:e.teleport},{default:()=>[v]}):v}}});const Et=te(Tt),Lt=$({},_e,{round:Boolean,position:V("center"),closeIcon:V("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:V("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[At,ke]=ee("popup");var _t=p({name:At,inheritAttrs:!1,props:Lt,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:n,attrs:a,slots:f}){let l,o;const h=S(),v=S(),i=Ve(()=>e.show||!e.lazyRender),m=q(()=>{const g={zIndex:h.value};if(L(e.duration)){const O=e.position==="center"?"animationDuration":"transitionDuration";g[O]=`${e.duration}s`}return g}),u=()=>{l||(l=!0,h.value=e.zIndex!==void 0?+e.zIndex:Ct(),n("open"))},x=()=>{l&&et(e.beforeClose,{done(){l=!1,n("close"),n("update:show",!1)}})},T=g=>{n("clickOverlay",g),e.closeOnClickOverlay&&x()},I=()=>{if(e.overlay){const g=$({show:e.show,class:e.overlayClass,zIndex:h.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return r(Et,U(g,Ce(),{onClick:T}),{default:f["overlay-content"]})}},w=g=>{n("clickCloseIcon",g),x()},y=()=>{if(e.closeable)return r(X,{role:"button",tabindex:0,name:e.closeIcon,class:[ke("close-icon",e.closeIconPosition),tt],classPrefix:e.iconPrefix,onClick:w},null)};let C;const R=()=>{C&&clearTimeout(C),C=setTimeout(()=>{n("opened")})},N=()=>n("closed"),Z=g=>n("keydown",g),M=i(()=>{var g;const{destroyOnClose:O,round:z,position:K,safeAreaInsetTop:re,safeAreaInsetBottom:ne,show:ae}=e;if(!(!ae&&O))return Te(r("div",U({ref:v,style:m.value,role:"dialog",tabindex:0,class:[ke({round:z,[K]:K}),{"van-safe-area-top":re,"van-safe-area-bottom":ne}],onKeydown:Z},a,Ce()),[(g=f.default)==null?void 0:g.call(f),y()]),[[Ee,ae]])}),d=()=>{const{position:g,transition:O,transitionAppear:z}=e,K=g==="center"?"van-fade":`van-popup-slide-${g}`;return r(Oe,{name:O||K,appear:z,onAfterEnter:R,onAfterLeave:N},{default:M})};return oe(()=>e.show,g=>{g&&!l&&(u(),a.tabindex===0&&Q(()=>{var O;(O=v.value)==null||O.focus()})),!g&&l&&(l=!1,n("close"))}),ue({popupRef:v}),wt(v,()=>e.show&&e.lockScroll),se("popstate",()=>{e.closeOnPopstate&&(x(),o=!1)}),Le(()=>{e.show&&u()}),Qe(()=>{o&&(n("update:show",!0),o=!1)}),xe(()=>{e.show&&e.teleport&&(x(),o=!0)}),Ae(nt,()=>e.show),()=>e.teleport?r(Pe,{to:e.teleport},{default:()=>[I(),d()]}):r(pe,null,[I(),d()])}});const Qt=te(_t);let Vt=0;function Re(){const e=ce(),{name:n="unknown"}=e?.type||{};return`${n}-${++Vt}`}const[Rt,W]=ee("cell"),Be={tag:V("div"),icon:String,size:String,title:_,value:_,label:_,center:Boolean,isLink:Boolean,border:D,iconPrefix:String,valueClass:Y,labelClass:Y,titleClass:Y,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},Bt=$({},Be,lt);var Mt=p({name:Rt,props:Bt,setup(e,{slots:n}){const a=at(),f=()=>{if(n.label||L(e.label))return r("div",{class:[W("label"),e.labelClass]},[n.label?n.label():e.label])},l=()=>{var i;if(n.title||L(e.title)){const m=(i=n.title)==null?void 0:i.call(n);return Array.isArray(m)&&m.length===0?void 0:r("div",{class:[W("title"),e.titleClass],style:e.titleStyle},[m||r("span",null,[e.title]),f()])}},o=()=>{const i=n.value||n.default;if(i||L(e.value))return r("div",{class:[W("value"),e.valueClass]},[i?i():r("span",null,[e.value])])},h=()=>{if(n.icon)return n.icon();if(e.icon)return r(X,{name:e.icon,class:W("left-icon"),classPrefix:e.iconPrefix},null)},v=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const i=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return r(X,{name:i,class:W("right-icon")},null)}};return()=>{var i;const{tag:m,size:u,center:x,border:T,isLink:I,required:w}=e,y=(i=e.clickable)!=null?i:I,C={center:x,required:!!w,clickable:y,borderless:!T};return u&&(C[u]=!!u),r(m,{class:W(C),role:y?"button":void 0,tabindex:y?0:void 0,onClick:a},{default:()=>{var R;return[h(),l(),o(),v(),(R=n.extra)==null?void 0:R.call(n)]}})}}});const zt=te(Mt);function Me(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Dt(e,n){if(Me(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function $t(e,n){return new Promise(a=>{const f=n.validator(e,n);if(st(f)){f.then(a);return}a(f)})}function Se(e,n){const{message:a}=n;return ct(a)?a(e,n):a||""}function Nt({target:e}){e.composing=!0}function we({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function jt(e,n){const a=ot();e.style.height="auto";let f=e.scrollHeight;if(rt(n)){const{maxHeight:l,minHeight:o}=n;l!==void 0&&(f=Math.min(f,l)),o!==void 0&&(f=Math.max(f,o))}f&&(e.style.height=`${f}px`,it(a))}function Ft(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function B(e){return[...e].length}function ie(e,n){return[...e].slice(0,n).join("")}const[qt,P]=ee("field"),de={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:_,max:Number,min:Number,formatter:Function,clearIcon:V("clear"),modelValue:ut(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:V("focus"),formatTrigger:V("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},Kt=$({},Be,de,{rows:_,type:V("text"),rules:Array,autosize:[Boolean,Object],labelWidth:_,labelClass:Y,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Wt=p({name:qt,props:Kt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const f=Re(),l=dt({status:"unvalidated",focused:!1,validateMessage:""}),o=S(),h=S(),v=S(),{parent:i}=ft(vt),m=()=>{var t;return String((t=e.modelValue)!=null?t:"")},u=t=>{if(L(e[t]))return e[t];if(i&&L(i.props[t]))return i.props[t]},x=q(()=>{const t=u("readonly");if(e.clearable&&!t){const c=m()!=="",s=e.clearTrigger==="always"||e.clearTrigger==="focus"&&l.focused;return c&&s}return!1}),T=q(()=>v.value&&a.input?v.value():e.modelValue),I=q(()=>{var t;const c=u("required");return c==="auto"?(t=e.rules)==null?void 0:t.some(s=>s.required):c}),w=t=>t.reduce((c,s)=>c.then(()=>{if(l.status==="failed")return;let{value:b}=T;if(s.formatter&&(b=s.formatter(b,s)),!Dt(b,s)){l.status="failed",l.validateMessage=Se(b,s);return}if(s.validator)return Me(b)&&s.validateEmpty===!1?void 0:$t(b,s).then(k=>{k&&typeof k=="string"?(l.status="failed",l.validateMessage=k):k===!1&&(l.status="failed",l.validateMessage=Se(b,s))})}),Promise.resolve()),y=()=>{l.status="unvalidated",l.validateMessage=""},C=()=>n("endValidate",{status:l.status,message:l.validateMessage}),R=(t=e.rules)=>new Promise(c=>{y(),t?(n("startValidate"),w(t).then(()=>{l.status==="failed"?(c({name:e.name,message:l.validateMessage}),C()):(l.status="passed",c(),C())})):c()}),N=t=>{if(i&&e.rules){const{validateTrigger:c}=i.props,s=be(c).includes(t),b=e.rules.filter(k=>k.trigger?be(k.trigger).includes(t):s);b.length&&R(b)}},Z=t=>{var c;const{maxlength:s}=e;if(L(s)&&B(t)>+s){const b=m();if(b&&B(b)===+s)return b;const k=(c=o.value)==null?void 0:c.selectionEnd;if(l.focused&&k){const j=[...t],F=j.length-+s;return j.splice(k-F,F),j.join("")}return ie(t,+s)}return t},M=(t,c="onChange")=>{var s,b;const k=t;t=Z(t);const j=B(k)-B(t);if(e.type==="number"||e.type==="digit"){const A=e.type==="number";if(t=gt(t,A,A),c==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const E=ht(+t,(s=e.min)!=null?s:-1/0,(b=e.max)!=null?b:1/0);+t!==E&&(t=E.toString())}}let F=0;if(e.formatter&&c===e.formatTrigger){const{formatter:A,maxlength:E}=e;if(t=A(t),L(E)&&B(t)>+E&&(t=ie(t,+E)),o.value&&l.focused){const{selectionEnd:le}=o.value,ge=ie(k,le);F=B(A(ge))-B(ge)}}if(o.value&&o.value.value!==t)if(l.focused){let{selectionStart:A,selectionEnd:E}=o.value;if(o.value.value=t,L(A)&&L(E)){const le=B(t);j?(A-=j,E-=j):F&&(A+=F,E+=F),o.value.setSelectionRange(Math.min(A,le),Math.min(E,le))}}else o.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},d=t=>{t.target.composing||M(t.target.value)},g=()=>{var t;return(t=o.value)==null?void 0:t.blur()},O=()=>{var t;return(t=o.value)==null?void 0:t.focus()},z=()=>{const t=o.value;e.type==="textarea"&&e.autosize&&t&&jt(t,e.autosize)},K=t=>{l.focused=!0,n("focus",t),Q(z),u("readonly")&&g()},re=t=>{l.focused=!1,M(m(),"onBlur"),n("blur",t),!u("readonly")&&(N("onBlur"),Q(z),bt())},ne=t=>n("clickInput",t),ae=t=>n("clickLeftIcon",t),ze=t=>n("clickRightIcon",t),De=t=>{H(t),n("update:modelValue",""),n("clear",t)},fe=q(()=>{if(typeof e.error=="boolean")return e.error;if(i&&i.props.showError&&l.status==="failed")return!0}),$e=q(()=>{const t=u("labelWidth"),c=u("labelAlign");if(t&&c!=="top")return{width:me(t)}}),Ne=t=>{t.keyCode===13&&(!(i&&i.props.submitOnEnter)&&e.type!=="textarea"&&H(t),e.type==="search"&&g()),n("keypress",t)},ve=()=>e.id||`${f}-input`,je=()=>l.status,Fe=()=>{const t=P("control",[u("inputAlign"),{error:fe.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return r("div",{class:t,onClick:ne},[a.input()]);const c={id:ve(),ref:o,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:u("disabled"),readonly:u("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${f}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:re,onFocus:K,onInput:d,onClick:ne,onChange:we,onKeypress:Ne,onCompositionend:we,onCompositionstart:Nt};return e.type==="textarea"?r("textarea",U(c,{inputmode:e.inputmode}),null):r("input",U(Ft(e.type,e.inputmode),c),null)},qe=()=>{const t=a["left-icon"];if(e.leftIcon||t)return r("div",{class:P("left-icon"),onClick:ae},[t?t():r(X,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ke=()=>{const t=a["right-icon"];if(e.rightIcon||t)return r("div",{class:P("right-icon"),onClick:ze},[t?t():r(X,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},We=()=>{if(e.showWordLimit&&e.maxlength){const t=B(m());return r("div",{class:P("word-limit")},[r("span",{class:P("word-num")},[t]),mt("/"),e.maxlength])}},Ye=()=>{if(i&&i.props.showErrorMessage===!1)return;const t=e.errorMessage||l.validateMessage;if(t){const c=a["error-message"],s=u("errorMessageAlign");return r("div",{class:P("error-message",s)},[c?c({message:t}):t])}},He=()=>{const t=u("labelWidth"),c=u("labelAlign"),s=u("colon")?":":"";if(a.label)return[a.label(),s];if(e.label)return r("label",{id:`${f}-label`,for:a.input?void 0:ve(),"data-allow-mismatch":"attribute",onClick:b=>{H(b),O()},style:c==="top"&&t?{width:me(t)}:void 0},[e.label+s])},Xe=()=>[r("div",{class:P("body")},[Fe(),x.value&&r(X,{ref:h,name:e.clearIcon,class:P("clear")},null),Ke(),a.button&&r("div",{class:P("button")},[a.button()])]),We(),Ye()];return ue({blur:g,focus:O,validate:R,formValue:T,resetValidation:y,getValidationStatus:je}),Ae(yt,{customValue:v,resetValidation:y,validateWithTrigger:N}),oe(()=>e.modelValue,()=>{M(m()),y(),N("onChange"),Q(z)}),Le(()=>{M(m(),e.formatTrigger),Q(z)}),se("touchstart",De,{target:q(()=>{var t;return(t=h.value)==null?void 0:t.$el})}),()=>{const t=u("disabled"),c=u("labelAlign"),s=qe(),b=()=>{const k=He();return c==="top"?[s,k].filter(Boolean):k||[]};return r(zt,{size:e.size,class:P({error:fe.value,disabled:t,[`label-${c}`]:c}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:$e.value,valueClass:P("value"),titleClass:[P("label",[c,{required:I.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:s&&c!=="top"?()=>s:null,title:b,value:Xe,extra:a.extra})}}});const Yt=te(Wt),[Ht,J,Xt]=ee("search"),Ut=$({},de,{label:String,shape:V("square"),leftIcon:V("search"),clearable:D,actionText:String,background:String,showAction:Boolean});var Zt=p({name:Ht,props:Ut,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:f}){const l=Re(),o=S(),h=()=>{a.action||(n("update:modelValue",""),n("cancel"))},v=d=>{d.keyCode===13&&(H(d),n("search",e.modelValue))},i=()=>e.id||`${l}-input`,m=()=>{if(a.label||e.label)return r("label",{class:J("label"),for:i(),"data-allow-mismatch":"attribute"},[a.label?a.label():e.label])},u=()=>{if(e.showAction){const d=e.actionText||Xt("cancel");return r("div",{class:J("action"),role:"button",tabindex:0,onClick:h},[a.action?a.action():d])}},x=()=>{var d;return(d=o.value)==null?void 0:d.blur()},T=()=>{var d;return(d=o.value)==null?void 0:d.focus()},I=d=>n("blur",d),w=d=>n("focus",d),y=d=>n("clear",d),C=d=>n("clickInput",d),R=d=>n("clickLeftIcon",d),N=d=>n("clickRightIcon",d),Z=Object.keys(de),M=()=>{const d=$({},f,ye(e,Z),{id:i()}),g=O=>n("update:modelValue",O);return r(Yt,U({ref:o,type:"search",class:J("field",{"with-message":d.errorMessage}),border:!1,onBlur:I,onFocus:w,onClear:y,onKeypress:v,onClickInput:C,onClickLeftIcon:R,onClickRightIcon:N,"onUpdate:modelValue":g},d),ye(a,["left-icon","right-icon"]))};return ue({focus:T,blur:x}),()=>{var d;return r("div",{class:J({"show-action":e.showAction}),style:{background:e.background}},[(d=a.left)==null?void 0:d.call(a),r("div",{class:J("content",e.shape)},[m(),M()]),u()])}}});const pt=te(Zt);export{Qt as P,pt as S,_e as a,ue as b,Jt as p,St as u};
