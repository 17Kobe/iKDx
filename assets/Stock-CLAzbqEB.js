import{d as se,r as g,c as B,o as U,n as V,w as R,a as he,b as pe,e as ge,v as me,f as h,m as ce,T as ye,u as de,g as xe,h as be,i as b,j as $,k as y,l as C,p as w,q as we,F as Y,s as G,t as ke,x as M,_ as Se,y as De}from"./index-B_U1_LjV.js";import{w as j,a as A,u as Ie,p as Pe,P as _e,b as Be,H as Ce,S as Te}from"./index-AD8Nz6r1.js";import{c as re,m as Ee,i as J,a as Q,u as Me,s as je,b as Ae,p as N,w as ve,e as Le,t as L,d as Ke,I as Oe}from"./index-ALnLekCr.js";function Z(e,t){return e.reduce((a,d)=>Math.abs(a-t)<Math.abs(d-t)?a:d)}const Ve={gap:{type:[Number,Object],default:24},icon:String,axis:Ee("y"),magnetic:String,offset:Object,teleport:{type:[String,Object],default:"body"}},[Re,ee]=re("floating-bubble");var $e=se({name:Re,inheritAttrs:!1,props:Ve,emits:["click","update:offset","offsetChange"],setup(e,{slots:t,emit:a,attrs:d}){const o=g(),n=g({x:0,y:0,width:0,height:0}),r=B(()=>J(e.gap)?e.gap.x:e.gap),p=B(()=>J(e.gap)?e.gap.y:e.gap),s=B(()=>({top:p.value,right:A.value-n.value.width-r.value,bottom:j.value-n.value.height-p.value,left:r.value})),m=g(!1);let S=!1;const I=B(()=>{const v={},D=Q(n.value.x),f=Q(n.value.y);return v.transform=`translate3d(${D}, ${f}, 0)`,(m.value||!S)&&(v.transition="none"),v}),c=()=>{if(!_.value)return;const{width:v,height:D}=Ae(o.value),{offset:f}=e;n.value={x:f?f.x:A.value-v-r.value,y:f?f.y:j.value-D-p.value,width:v,height:D}},i=Ie();let u=0,l=0;const P=v=>{i.start(v),m.value=!0,u=n.value.x,l=n.value.y};Me("touchmove",v=>{if(v.preventDefault(),i.move(v),e.axis!=="lock"&&!i.isTap.value){if(e.axis==="x"||e.axis==="xy"){let f=u+i.deltaX.value;f<s.value.left&&(f=s.value.left),f>s.value.right&&(f=s.value.right),n.value.x=f}if(e.axis==="y"||e.axis==="xy"){let f=l+i.deltaY.value;f<s.value.top&&(f=s.value.top),f>s.value.bottom&&(f=s.value.bottom),n.value.y=f}const D=N(n.value,["x","y"]);a("update:offset",D)}},{target:o});const X=()=>{m.value=!1,V(()=>{if(e.magnetic==="x"){const v=Z([s.value.left,s.value.right],n.value.x);n.value.x=v}if(e.magnetic==="y"){const v=Z([s.value.top,s.value.bottom],n.value.y);n.value.y=v}if(!i.isTap.value){const v=N(n.value,["x","y"]);a("update:offset",v),(u!==v.x||l!==v.y)&&a("offsetChange",v)}})},fe=v=>{i.isTap.value?a("click",v):v.stopPropagation()};U(()=>{c(),V(()=>{S=!0})}),R([A,j,r,p,()=>e.offset],c,{deep:!0});const _=g(!0);return he(()=>{_.value=!0}),pe(()=>{e.teleport&&(_.value=!1)}),()=>{const v=ge(h("div",ce({class:ee(),ref:o,onTouchstartPassive:P,onTouchend:X,onTouchcancel:X,onClickCapture:fe,style:I.value},d),[t.default?t.default():h(je,{name:e.icon,class:ee("icon")},null)]),[[me,_.value]]);return e.teleport?h(ye,{to:e.teleport},{default:()=>[v]}):v}}});const Ne=ve($e),ze=e=>e?.includes("/"),Fe=[...Pe,"round","closeOnPopstate","safeAreaInsetBottom"],We={qq:"qq",link:"link-o",weibo:"weibo",qrcode:"qr",poster:"photo-o",wechat:"wechat","weapp-qrcode":"miniprogram-o","wechat-moments":"wechat-moments"},[qe,x,He]=re("share-sheet"),Ue=Le({},Be,{title:String,round:L,options:Ke(),cancelText:String,description:String,closeOnPopstate:L,safeAreaInsetBottom:L});var Xe=se({name:qe,props:Ue,emits:["cancel","select","update:show"],setup(e,{emit:t,slots:a}){const d=c=>t("update:show",c),o=()=>{d(!1),t("cancel")},n=(c,i)=>t("select",c,i),r=()=>{const c=a.title?a.title():e.title,i=a.description?a.description():e.description;if(c||i)return h("div",{class:x("header")},[c&&h("h2",{class:x("title")},[c]),i&&h("span",{class:x("description")},[i])])},p=c=>ze(c)?h("img",{src:c,class:x("image-icon")},null):h("div",{class:x("icon",[c])},[h(Oe,{name:We[c]||c},null)]),s=(c,i)=>{const{name:u,icon:l,className:P,description:E}=c;return h("div",{role:"button",tabindex:0,class:[x("option"),P,Ce],onClick:()=>n(c,i)},[p(l),u&&h("span",{class:x("name")},[u]),E&&h("span",{class:x("option-description")},[E])])},m=(c,i)=>h("div",{class:x("options",{border:i})},[c.map(s)]),S=()=>{const{options:c}=e;return Array.isArray(c[0])?c.map((i,u)=>m(i,u!==0)):m(c)},I=()=>{var c;const i=(c=e.cancelText)!=null?c:He("cancel");if(a.cancel||i)return h("button",{type:"button",class:x("cancel"),onClick:o},[a.cancel?a.cancel():i])};return()=>h(_e,ce({class:x(),position:"bottom","onUpdate:show":d},N(e,Fe)),{default:()=>[r(),S(),I()]})}});const Ye=ve(Xe),z=(e,t)=>t.some(a=>e instanceof a);let te,ae;function Ge(){return te||(te=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Je(){return ae||(ae=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const F=new WeakMap,K=new WeakMap,T=new WeakMap;function Qe(e){const t=new Promise((a,d)=>{const o=()=>{e.removeEventListener("success",n),e.removeEventListener("error",r)},n=()=>{a(k(e.result)),o()},r=()=>{d(e.error),o()};e.addEventListener("success",n),e.addEventListener("error",r)});return T.set(t,e),t}function Ze(e){if(F.has(e))return;const t=new Promise((a,d)=>{const o=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",r),e.removeEventListener("abort",r)},n=()=>{a(),o()},r=()=>{d(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",n),e.addEventListener("error",r),e.addEventListener("abort",r)});F.set(e,t)}let W={get(e,t,a){if(e instanceof IDBTransaction){if(t==="done")return F.get(e);if(t==="store")return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return k(e[t])},set(e,t,a){return e[t]=a,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function le(e){W=e(W)}function et(e){return Je().includes(e)?function(...t){return e.apply(q(this),t),k(this.request)}:function(...t){return k(e.apply(q(this),t))}}function tt(e){return typeof e=="function"?et(e):(e instanceof IDBTransaction&&Ze(e),z(e,Ge())?new Proxy(e,W):e)}function k(e){if(e instanceof IDBRequest)return Qe(e);if(K.has(e))return K.get(e);const t=tt(e);return t!==e&&(K.set(e,t),T.set(t,e)),t}const q=e=>T.get(e);function at(e,t,{blocked:a,upgrade:d,blocking:o,terminated:n}={}){const r=indexedDB.open(e,t),p=k(r);return d&&r.addEventListener("upgradeneeded",s=>{d(k(r.result),s.oldVersion,s.newVersion,k(r.transaction),s)}),a&&r.addEventListener("blocked",s=>a(s.oldVersion,s.newVersion,s)),p.then(s=>{n&&s.addEventListener("close",()=>n()),o&&s.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),p}const nt=["get","getKey","getAll","getAllKeys","count"],it=["put","add","delete","clear"],O=new Map;function ne(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(O.get(t))return O.get(t);const a=t.replace(/FromIndex$/,""),d=t!==a,o=it.includes(a);if(!(a in(d?IDBIndex:IDBObjectStore).prototype)||!(o||nt.includes(a)))return;const n=async function(r,...p){const s=this.transaction(r,o?"readwrite":"readonly");let m=s.store;return d&&(m=m.index(p.shift())),(await Promise.all([m[a](...p),o&&s.done]))[0]};return O.set(t,n),n}le(e=>({...e,get:(t,a,d)=>ne(t,a)||e.get(t,a,d),has:(t,a)=>!!ne(t,a)||e.has(t,a)}));const ot=["continue","continuePrimaryKey","advance"],ie={},H=new WeakMap,ue=new WeakMap,st={get(e,t){if(!ot.includes(t))return e[t];let a=ie[t];return a||(a=ie[t]=function(...d){H.set(this,ue.get(this)[t](...d))}),a}};async function*ct(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const a=new Proxy(t,st);for(ue.set(a,t),T.set(a,q(t));t;)yield a,t=await(H.get(a)||t.continue()),H.delete(a)}function oe(e,t){return t===Symbol.asyncIterator&&z(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&z(e,[IDBIndex,IDBObjectStore])}le(e=>({...e,get(t,a,d){return oe(t,a)?ct:e.get(t,a,d)},has(t,a){return oe(t,a)||e.has(t,a)}}));const dt=at("stock-db",1,{upgrade(e){e.objectStoreNames.contains("stocks")||e.createObjectStore("stocks",{keyPath:"id"})}});async function rt(){const e=await dt;if(await e.count("stocks")>0)return await e.getAll("stocks");{const o=await(await fetch("/iKDx/"+"stocks/stocks.json")).json(),n=e.transaction("stocks","readwrite"),r=n.objectStore("stocks");for(const p of o)await r.put(p);return await n.done,o}}const vt={style:{display:"flex","flex-direction":"column",height:"100%","min-height":"60vh"}},lt={style:{flex:"1 1 auto"}},ut={style:{display:"flex",gap:"8px","flex-wrap":"wrap","justify-content":"center","margin-bottom":"24px"}},ft=["onClick"],ht={key:0,style:{"margin-top":"12px"}},pt={key:0},gt={style:{"font-size":"17px","font-weight":"bold",color:"#222","margin-right":"16px","min-width":"60px"}},mt={style:{"font-size":"16px",color:"#333",flex:"1"}},yt={key:1,style:{color:"#999","text-align":"center","margin-top":"16px"}},xt={__name:"StockSearch",setup(e){const t=de("stock-search"),a=g(!1);U(()=>{t.on(i=>{a.value=i})}),xe(()=>{t.reset()});const d=g(),o=g(""),n=g([]),r=["台積電","鴻海","聯發科","長榮","中鋼"],p={background:"#fff",color:"#878787",borderRadius:"16px",padding:"4px 16px",fontSize:"15px",cursor:"pointer",userSelect:"none",fontWeight:"500",transition:"background 0.2s, color 0.2s"},s={background:"#ffe066",color:"#222",fontWeight:"bold",boxShadow:"0 0 0 2px #ffe06688"};function m(i){return o.value===i?{...p,...s}:p}function S(){V(()=>{const i=d.value?.$el?.querySelector("input");i&&i.focus()})}R(()=>a.value,i=>{i&&setTimeout(()=>{S()},300)}),R(()=>o.value,async i=>{if(!i||i.length<1){n.value=[];return}const u=await rt();n.value=u.filter(l=>l.name.includes(i)||l.id.includes(i))});function I(i){}function c(i){o.value=i}return(i,u)=>(b(),be(C(Ye),{show:a.value,"onUpdate:show":u[1]||(u[1]=l=>C(t).emit(!1)),"cancel-text":"離開",options:[],style:{"--van-share-sheet-header-padding":"24px 24px 0 24px"}},{title:$(()=>u[2]||(u[2]=[y("div",{style:{"font-size":"18px","font-weight":"bold","letter-spacing":"1px","text-align":"center","margin-top":"0","margin-bottom":"0",color:"#222","line-height":"1.2"}}," 股票搜尋 ",-1)])),description:$(()=>[y("div",vt,[y("div",lt,[y("div",null,[h(C(Te),{ref_key:"searchInputRef",ref:d,modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=l=>o.value=l),placeholder:"請輸入股票名稱或代碼","action-text":"",style:{"--van-search-input-height":"48px","font-size":"18px"},onSearch:I},null,8,["modelValue"])]),y("div",null,[u[3]||(u[3]=y("div",{style:{display:"flex","align-items":"center",margin:"0 0 10px 0"}},[y("div",{style:{"margin-left":"16px","font-size":"16px",color:"#222","font-weight":"bold","letter-spacing":"1px"}}," | 熱門股票 ")],-1)),y("div",ut,[(b(),w(Y,null,G(r,l=>y("span",{key:l,onClick:P=>c(l),style:ke(m(l))},M(l),13,ft)),64))]),o.value&&o.value.length>=1?(b(),w("div",ht,[n.value.length?(b(),w("div",pt,[(b(!0),w(Y,null,G(n.value,l=>(b(),w("div",{key:l.id,style:{background:"#fff","border-radius":"12px","box-shadow":"0 2px 8px #0001",padding:"16px 20px","margin-bottom":"12px",display:"flex","align-items":"center","min-height":"56px"}},[y("div",gt,M(l.id),1),y("div",mt,M(l.name),1)]))),128))])):(b(),w("div",yt," 查無資料 "))])):we("",!0)])])])]),_:1},8,["show"]))}},bt={class:"stock-page"},wt={__name:"Stock",setup(e){const t=de("stock-search"),a=g(null);g(null),g(0),g(-1),g(0),g(0),g(!1),g(null),g([{id:"2330",name:"台積電",code:"2330",price:1140,change:-1.72,changePercent:-.15,weeklyKD:22.6,rsi:45.2},{id:"2317",name:"鴻海",code:"2317",price:135,change:1.45,changePercent:1.08,weeklyKD:68.5,rsi:62.1},{id:"2454",name:"聯發科",code:"2454",price:1350,change:-18.5,changePercent:-1.35,weeklyKD:20.8,rsi:38.9},{id:"2881",name:"富邦金",code:"2881",price:31.55,change:.35,changePercent:1.12,weeklyKD:72.3,rsi:58.7},{id:"0056",name:"元大高股息",code:"0056",price:34.81,change:.02,changePercent:.06,weeklyKD:55.4,rsi:52.1},{id:"1215",name:"卜蜂",code:"1215",price:115.5,change:-.5,changePercent:-.43,weeklyKD:56.87,rsi:71.63},{id:"2885",name:"元大金",code:"2885",price:34.81,change:.06,changePercent:.17,weeklyKD:73.16,rsi:80.46},{id:"2646",name:"星宇航空",code:"2646",price:47.7,change:.5,changePercent:1.06,weeklyKD:54.87,rsi:58.55},{id:"2646",name:"華泰",code:"2646",price:47.7,change:.5,changePercent:1.06,weeklyKD:54.87,rsi:58.55}]);function d(){t.emit(!0)}return U(()=>{}),(o,n)=>(b(),w("div",bt,[y("div",{class:"stock-list1",ref_key:"stockListRef",ref:a},n[0]||(n[0]=[De("<div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div><div data-v-9f477c82>3532</div>",79)]),512),h(C(Ne),{axis:"xy",magnetic:"x",gap:{x:20,y:80},icon:"plus",style:{"--van-floating-bubble-size":"56px","--van-floating-bubble-background":"#ffe066","--van-floating-bubble-icon-size":"22px","--van-floating-bubble-color":"#322b0d"},onClick:d},{default:$(()=>n[1]||(n[1]=[y("div",{class:"bubble-content"},[y("span",{class:"bubble-label",style:{color:"#322b0d"}},"新增")],-1)])),_:1,__:[1]}),h(xt)]))}},It=Se(wt,[["__scopeId","data-v-9f477c82"]]);export{It as default};
