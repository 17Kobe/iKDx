import{aA as I,h as v,aB as P,w as j,aj as A,j as y,q,aC as z,_ as N,a5 as d,a1 as c,a3 as s,aa as i,a7 as F,a8 as O,ak as E,a9 as G,ap as K,v as u,a2 as b,a4 as o,a6 as U,C as B,a0 as Q,as as R,ab as H}from"./index-D7CXKJ5a.js";import{I as $,s as J}from"./iconify-4xP2o8FB.js";import{T as X,a as Y}from"./index-CZxcFqFv.js";import{B as W}from"./index-DlfS8eZJ.js";import{A as C}from"./index-BG7XSBli.js";import"./index-BuzD4fYg.js";const Z=I("theme",()=>{const _=v(0),a=v(!1),p=P();return j([_,p],()=>{_.value===0?a.value=p.value:_.value===1?a.value=!1:a.value=!0,document.body.classList.toggle("dark",a.value)},{immediate:!0}),{mode:_,isDark:a}}),ss={class:"worker-monitor"},ts={class:"monitor-header"},es={class:"total-cpu"},os={class:"pool-stats"},as={class:"pool-name"},ls={class:"pool-info"},is={class:"stat-item"},ns={class:"value"},rs={class:"stat-item"},us={class:"value busy"},cs={class:"stat-item"},ds={class:"value queue"},vs={class:"stat-item"},ps={class:"value utilization"},ms={class:"progress-bar"},_s={class:"overall-stats"},hs={class:"stat-box"},gs={class:"stat-value"},fs={class:"stat-box"},ks={class:"stat-value"},bs={class:"stat-box"},ws={class:"stat-value"},ys={__name:"WorkerMonitor",setup(_){const a=v({}),p=v(navigator.hardwareConcurrency||4),n=y(()=>Object.values(a.value).reduce((l,e)=>l+e.busyWorkers,0)),w=y(()=>Object.values(a.value).reduce((l,e)=>l+e.queuedTasks,0)),h=y(()=>{const l=Object.values(a.value);return l.length===0?"0.0":(l.reduce((f,x)=>{const S=parseFloat(x.utilization)||0;return f+S},0)/l.length).toFixed(1)}),g=(l,e,r)=>{a.value={...r}};return q(()=>{z.onAllStatusChange(g),a.value=z.getAllStatus()}),N(()=>{}),(l,e)=>(c(),d("div",ss,[s("div",ts,[e[0]||(e[0]=s("h3",null,"Worker Pool 監控",-1)),s("span",es,"CPU 核心數: "+i(p.value),1)]),s("div",os,[(c(!0),d(F,null,O(a.value,(r,f)=>(c(),d("div",{key:f,class:E(["pool-card",{"pool-busy":r.busyWorkers>0}])},[s("div",as,i(f),1),s("div",ls,[s("div",is,[e[1]||(e[1]=s("span",{class:"label"},"可用:",-1)),s("span",ns,i(r.availableWorkers)+"/"+i(r.totalWorkers),1)]),s("div",rs,[e[2]||(e[2]=s("span",{class:"label"},"使用中:",-1)),s("span",us,i(r.busyWorkers),1)]),s("div",cs,[e[3]||(e[3]=s("span",{class:"label"},"排隊:",-1)),s("span",ds,i(r.queuedTasks),1)]),s("div",vs,[e[4]||(e[4]=s("span",{class:"label"},"使用率:",-1)),s("span",ps,i(r.utilization)+"%",1)])]),s("div",ms,[s("div",{class:"progress-fill",style:G({width:r.utilization+"%"})},null,4)])],2))),128))]),s("div",_s,[s("div",hs,[s("div",gs,i(n.value),1),e[5]||(e[5]=s("div",{class:"stat-label"},"總使用中",-1))]),s("div",fs,[s("div",ks,i(w.value),1),e[6]||(e[6]=s("div",{class:"stat-label"},"總排隊",-1))]),s("div",bs,[s("div",ws,i(h.value)+"%",1),e[7]||(e[7]=s("div",{class:"stat-label"},"整體使用率",-1))])])]))}},xs=A(ys,[["__scopeId","data-v-4aea0f26"]]),Ss={class:"my-page"},$s={class:"tab-content"},Cs={key:0,class:"auth-section"},Ts={class:"login-prompt"},zs={class:"login-icon"},Us={key:1,class:"user-section"},Bs={class:"user-info"},Ws={class:"user-avatar"},As=["src","alt"],Ds={class:"user-details"},Ms={key:2,class:"guest-section"},Ls={class:"guest-info"},Vs={class:"guest-icon"},Is={class:"guest-details"},Ps={class:"setting-list"},js={class:"setting-right"},qs={class:"setting-value"},Ns={style:{padding:"20px","max-height":"70vh","overflow-y":"auto"}},Fs={__name:"My",setup(_){const a=R(),p=Z(),n=K(),w=v("basic"),h=v(!1),g=v(!1),l=v(!1),e=y(()=>{switch(p.mode){case 0:return"跟隨系統";case 1:return"亮";case 2:return"暗";default:return"跟隨系統"}}),r=[{name:"跟隨系統",value:0},{name:"亮",value:1},{name:"暗",value:2}],f=[{name:"Worker Pool 監控",value:"worker"},{name:"應用資訊",value:"info"},{name:"清除快取",value:"clear"}];function x(){h.value=!0}function S(){g.value=!0}function T(){a.push("/login")}function D(){J({title:"確認登出",message:"確定要登出嗎？",showCancelButton:!0,confirmButtonText:"登出",cancelButtonText:"取消"}).then(()=>{n.logout(),H.success("已登出")}).catch(()=>{})}function M(k){console.log("切換到：",k)}function L(k){p.mode=k.value,h.value=!1}function V(k){switch(g.value=!1,k.value){case"worker":l.value=!0;break;case"info":console.log("顯示應用資訊");break;case"clear":console.log("清除快取");break}}return(k,t)=>(c(),d("div",Ss,[u(o(Y),{active:w.value,"onUpdate:active":t[0]||(t[0]=m=>w.value=m),swipeable:"",sticky:"",onChange:M,class:"custom-tabs"},{default:b(()=>[u(o(X),{title:"基本",name:"basic"},{default:b(()=>[s("div",$s,[o(n).isAuthenticated?o(n).isLoggedIn?(c(),d("div",Us,[s("div",Bs,[s("div",Ws,[o(n).user?.avatar?(c(),d("img",{key:0,src:o(n).user.avatar,alt:o(n).user.name},null,8,As)):(c(),Q(o($),{key:1,icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#ccc"}))]),s("div",Ds,[s("h3",null,i(o(n).user?.name||"用戶"),1),s("p",null,i(o(n).user?.email),1)])])])):o(n).isGuestMode?(c(),d("div",Ms,[s("div",Ls,[s("div",Vs,[u(o($),{icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#999"})]),s("div",Is,[t[8]||(t[8]=s("h3",null,"訪客模式",-1)),t[9]||(t[9]=s("p",null,"資料僅保存在本地",-1)),u(o(W),{type:"primary",size:"small",plain:"",onClick:T,style:{"margin-top":"8px"}},{default:b(()=>t[7]||(t[7]=[B(" 切換到登入 ",-1)])),_:1,__:[7]})])])])):U("",!0):(c(),d("div",Cs,[s("div",Ts,[s("div",zs,[u(o($),{icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#ccc"})]),t[5]||(t[5]=s("h3",null,"歡迎使用 iKDx",-1)),t[6]||(t[6]=s("p",null,"登入後可同步您的股票資料",-1)),u(o(W),{type:"primary",size:"large",round:"",block:"",onClick:T,style:{"margin-top":"16px"}},{default:b(()=>t[4]||(t[4]=[B(" 立即登入 ",-1)])),_:1,__:[4]})])])),s("div",Ps,[o(n).isLoggedIn?(c(),d("div",{key:0,class:"setting-item",onClick:D},t[10]||(t[10]=[s("div",{class:"setting-left"},[s("span",{class:"setting-title"},"登出")],-1),s("div",{class:"setting-right"},[s("span",{class:"arrow"},">")],-1)]))):U("",!0),s("div",{class:"setting-item",onClick:x},[t[12]||(t[12]=s("div",{class:"setting-left"},[s("span",{class:"setting-title"},"主題")],-1)),s("div",js,[s("span",qs,i(e.value),1),t[11]||(t[11]=s("span",{class:"arrow"},">",-1))])]),s("div",{class:"setting-item",onClick:S},t[13]||(t[13]=[s("div",{class:"setting-left"},[s("span",{class:"setting-title"},"開發者")],-1),s("div",{class:"setting-right"},[s("span",{class:"arrow"},">")],-1)]))])])]),_:1})]),_:1},8,["active"]),u(o(C),{show:h.value,"onUpdate:show":t[1]||(t[1]=m=>h.value=m),actions:r,title:"選擇主題","cancel-text":"取消",onSelect:L},null,8,["show"]),u(o(C),{show:g.value,"onUpdate:show":t[2]||(t[2]=m=>g.value=m),actions:f,title:"開發者選項","cancel-text":"取消",onSelect:V},null,8,["show"]),u(o(C),{show:l.value,"onUpdate:show":t[3]||(t[3]=m=>l.value=m),title:"Worker Pool 監控","cancel-text":"關閉"},{default:b(()=>[s("div",Ns,[u(xs)])]),_:1},8,["show"])]))}},Hs=A(Fs,[["__scopeId","data-v-14fc3f2f"]]);export{Hs as default};
