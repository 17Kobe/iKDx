import{_ as V,C as O,u as U}from"./user-stock-list-store-V5R_NKI4.js";import{d as A,t as Z,c as W,a as t,ae as P,b as q,aw as J,ax as j,w as K,m as Q,ay as X,aq as B,L as Y,I as $,y as E,A as L,as as k,ac as v,a8 as p,aa as g,af as R,a7 as z,ad as G,a9 as x,R as tt,ag as T,ah as F,ar as b,az as et,J as at,ab as M}from"./index-CWi8SmC5.js";import{u as rt}from"./index-DiUMXIjI.js";import{T as I,a as nt}from"./index-BrO-h5VH.js";import"./worker-pool-DJ0nWca6.js";const[lt,N]=W("cell-group"),it={title:String,inset:Boolean,border:Z};var ot=A({name:lt,inheritAttrs:!1,props:it,setup(s,{slots:l,attrs:f}){const e=()=>{var o;return t("div",q({class:[N({inset:s.inset}),{[j]:s.border&&!s.inset}]},f,J()),[(o=l.default)==null?void 0:o.call(l)])},u=()=>t("div",{class:N("title",{inset:s.inset})},[l.title?l.title():s.title]);return()=>s.title||l.title?t(P,null,[u(),e()]):e()}});const st=K(ot),[ct,S]=W("empty"),dt={image:Q("default"),imageSize:[Number,String,Array],description:String};var ut=A({name:ct,props:dt,setup(s,{slots:l}){const f=()=>{const d=l.description?l.description():s.description;if(d)return t("p",{class:S("description")},[d])},e=()=>{if(l.default)return t("div",{class:S("bottom")},[l.default()])},u=rt(),o=d=>`${u}-${d}`,i=d=>`url(#${o(d)})`,c=(d,C,H)=>t("stop",{"stop-color":d,offset:`${C}%`,"stop-opacity":H},null),m=(d,C)=>[c(d,0),c(C,100)],r=d=>[t("defs",null,[t("radialGradient",{id:o(d),cx:"50%",cy:"54%",fx:"50%",fy:"54%",r:"297%",gradientTransform:"matrix(-.16 0 0 -.33 .58 .72)","data-allow-mismatch":"attribute"},[c("#EBEDF0",0),c("#F2F3F5",100,.3)])]),t("ellipse",{fill:i(d),opacity:".8",cx:"80",cy:"140",rx:"46",ry:"8","data-allow-mismatch":"attribute"},null)],y=()=>[t("defs",null,[t("linearGradient",{id:o("a"),x1:"64%",y1:"100%",x2:"64%","data-allow-mismatch":"attribute"},[c("#FFF",0,.5),c("#F2F3F5",100)])]),t("g",{opacity:".8","data-allow-mismatch":"children"},[t("path",{d:"M36 131V53H16v20H2v58h34z",fill:i("a")},null),t("path",{d:"M123 15h22v14h9v77h-31V15z",fill:i("a")},null)])],a=()=>[t("defs",null,[t("linearGradient",{id:o("b"),x1:"64%",y1:"97%",x2:"64%",y2:"0%","data-allow-mismatch":"attribute"},[c("#F2F3F5",0,.3),c("#F2F3F5",100)])]),t("g",{opacity:".8","data-allow-mismatch":"children"},[t("path",{d:"M87 6c3 0 7 3 8 6a8 8 0 1 1-1 16H80a7 7 0 0 1-8-6c0-4 3-7 6-7 0-5 4-9 9-9Z",fill:i("b")},null),t("path",{d:"M19 23c2 0 3 1 4 3 2 0 4 2 4 4a4 4 0 0 1-4 3v1h-7v-1l-1 1c-2 0-3-2-3-4 0-1 1-3 3-3 0-2 2-4 4-4Z",fill:i("b")},null)])],_=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",{"data-allow-mismatch":"children"},[t("linearGradient",{id:o(1),x1:"64%",y1:"100%",x2:"64%"},[c("#FFF",0,.5),c("#F2F3F5",100)]),t("linearGradient",{id:o(2),x1:"50%",x2:"50%",y2:"84%"},[c("#EBEDF0",0),c("#DCDEE0",100,0)]),t("linearGradient",{id:o(3),x1:"100%",x2:"100%",y2:"100%"},[m("#EAEDF0","#DCDEE0")]),t("radialGradient",{id:o(4),cx:"50%",cy:"0%",fx:"50%",fy:"0%",r:"100%",gradientTransform:"matrix(0 1 -.54 0 .5 -.5)"},[c("#EBEDF0",0),c("#FFF",100,0)])]),t("g",{fill:"none"},[y(),t("path",{fill:i(4),d:"M0 139h160v21H0z","data-allow-mismatch":"attribute"},null),t("path",{d:"M80 54a7 7 0 0 1 3 13v27l-2 2h-2a2 2 0 0 1-2-2V67a7 7 0 0 1 3-13z",fill:i(2),"data-allow-mismatch":"attribute"},null),t("g",{opacity:".6","stroke-linecap":"round","stroke-width":"7","data-allow-mismatch":"children"},[t("path",{d:"M64 47a19 19 0 0 0-5 13c0 5 2 10 5 13",stroke:i(3)},null),t("path",{d:"M53 36a34 34 0 0 0 0 48",stroke:i(3)},null),t("path",{d:"M95 73a19 19 0 0 0 6-13c0-5-2-9-6-13",stroke:i(3)},null),t("path",{d:"M106 84a34 34 0 0 0 0-48",stroke:i(3)},null)]),t("g",{transform:"translate(31 105)"},[t("rect",{fill:"#EBEDF0",width:"98",height:"34",rx:"2"},null),t("rect",{fill:"#FFF",x:"9",y:"8",width:"80",height:"18",rx:"1.1"},null),t("rect",{fill:"#EBEDF0",x:"15",y:"12",width:"18",height:"6",rx:"1.1"},null)])])]),n=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",{"data-allow-mismatch":"children"},[t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:o(5)},[m("#F2F3F5","#DCDEE0")]),t("linearGradient",{x1:"95%",y1:"48%",x2:"5.5%",y2:"51%",id:o(6)},[m("#EAEDF1","#DCDEE0")]),t("linearGradient",{y1:"45%",x2:"100%",y2:"54%",id:o(7)},[m("#EAEDF1","#DCDEE0")])]),y(),a(),t("g",{transform:"translate(36 50)",fill:"none"},[t("g",{transform:"translate(8)"},[t("rect",{fill:"#EBEDF0",opacity:".6",x:"38",y:"13",width:"36",height:"53",rx:"2"},null),t("rect",{fill:i(5),width:"64",height:"66",rx:"2","data-allow-mismatch":"attribute"},null),t("rect",{fill:"#FFF",x:"6",y:"6",width:"52",height:"55",rx:"1"},null),t("g",{transform:"translate(15 17)",fill:i(6),"data-allow-mismatch":"attribute"},[t("rect",{width:"34",height:"6",rx:"1"},null),t("path",{d:"M0 14h34v6H0z"},null),t("rect",{y:"28",width:"34",height:"6",rx:"1"},null)])]),t("rect",{fill:i(7),y:"61",width:"88",height:"28",rx:"1","data-allow-mismatch":"attribute"},null),t("rect",{fill:"#F7F8FA",x:"29",y:"72",width:"30",height:"6",rx:"1"},null)])]),h=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",null,[t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:o(8),"data-allow-mismatch":"attribute"},[m("#EAEDF1","#DCDEE0")])]),y(),a(),r("c"),t("path",{d:"m59 60 21 21 21-21h3l9 9v3L92 93l21 21v3l-9 9h-3l-21-21-21 21h-3l-9-9v-3l21-21-21-21v-3l9-9h3Z",fill:i(8),"data-allow-mismatch":"attribute"},null)]),D=()=>t("svg",{viewBox:"0 0 160 160"},[t("defs",{"data-allow-mismatch":"children"},[t("linearGradient",{x1:"50%",y1:"100%",x2:"50%",id:o(9)},[m("#EEE","#D8D8D8")]),t("linearGradient",{x1:"100%",y1:"50%",y2:"50%",id:o(10)},[m("#F2F3F5","#DCDEE0")]),t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:o(11)},[m("#F2F3F5","#DCDEE0")]),t("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:o(12)},[m("#FFF","#F7F8FA")])]),y(),a(),r("d"),t("g",{transform:"rotate(-45 113 -4)",fill:"none","data-allow-mismatch":"children"},[t("rect",{fill:i(9),x:"24",y:"52.8",width:"5.8",height:"19",rx:"1"},null),t("rect",{fill:i(10),x:"22.1",y:"67.3",width:"9.9",height:"28",rx:"1"},null),t("circle",{stroke:i(11),"stroke-width":"8",cx:"27",cy:"27",r:"27"},null),t("circle",{fill:i(12),cx:"27",cy:"27",r:"16"},null),t("path",{d:"M37 7c-8 0-15 5-16 12",stroke:i(11),"stroke-width":"3",opacity:".5","stroke-linecap":"round",transform:"rotate(45 29 13)"},null)])]),w=()=>{var d;if(l.image)return l.image();const C={error:h,search:D,network:_,default:n};return((d=C[s.image])==null?void 0:d.call(C))||t("img",{src:s.image},null)};return()=>t("div",{class:S()},[t("div",{class:S("image"),style:X(s.imageSize)},[w()]),f(),e()])}});const ht=K(ut),ft={name:"VantTable",components:{VanIcon:$,VanEmpty:ht,VanLoading:Y},props:{columns:{type:Array,required:!0},data:{type:Array,default:()=>[]},height:{type:String,default:"400px"},loading:{type:Boolean,default:!1},rowKey:{type:[String,Function],default:"id"}},emits:["row-click","sort-change"],setup(s,{emit:l}){const f=E(null),e=E(null),u=E(null),o=(n,h)=>typeof s.rowKey=="function"?s.rowKey(n,h):n[s.rowKey]||h,i=(n,h)=>V.get(n,h),c=(n,h)=>{if(n==null)return"-";switch(h.type){case"number":return typeof n=="number"?n.toLocaleString("zh-TW",{minimumFractionDigits:h.decimal||0}):n;case"percent":return typeof n=="number"?`${(n*100).toFixed(h.decimal||2)}%`:n;case"currency":return typeof n=="number"?`$${n.toLocaleString("zh-TW",{minimumFractionDigits:h.decimal||0})}`:n;default:return h.formatter?h.formatter(n):n}},m=n=>{n.sortable&&(e.value===n.key?u.value==="asc"?u.value="desc":u.value==="desc"?(u.value=null,e.value=null):u.value="asc":(e.value=n.key,u.value="asc"),l("sort-change",{key:e.value,order:u.value,column:n}))},r=n=>e.value!==n?"exchange":u.value==="asc"?"arrow-up":"arrow-down",y=L(()=>!e.value||!u.value?s.data:V.orderBy(s.data,[e.value],[u.value])),a=(n,h)=>{l("row-click",n,h)},_=V.throttle(()=>{},16);return{tableBodyRef:f,sortKey:e,sortOrder:u,sortedData:y,getRowKey:o,getValue:i,formatValue:c,handleSort:m,getSortIcon:r,handleRowClick:a,handleScroll:_}}},mt={class:"vant-table-wrapper"},yt={class:"table-header"},gt={class:"header-row"},pt=["onClick"],_t={class:"cell-content"},vt=["onClick"],xt={class:"cell-content"},wt={key:1,class:"table-loading"};function Ft(s,l,f,e,u,o){const i=k("van-icon"),c=k("van-empty"),m=k("van-loading");return p(),v("div",mt,[g("div",yt,[g("div",gt,[(p(!0),v(P,null,R(f.columns,r=>(p(),v("div",{key:r.key,class:"header-cell",style:T({width:r.width,minWidth:r.minWidth,flexBasis:r.flex||"auto"}),onClick:y=>e.handleSort(r)},[g("span",_t,F(r.title),1),r.sortable?(p(),z(i,{key:0,name:e.getSortIcon(r.key),class:b(["sort-icon",{active:e.sortKey===r.key}])},null,8,["name","class"])):G("",!0)],12,pt))),128))])]),g("div",{ref:"tableBodyRef",class:"table-body",style:T({maxHeight:f.height}),onScroll:l[0]||(l[0]=(...r)=>e.handleScroll&&e.handleScroll(...r))},[(p(!0),v(P,null,R(e.sortedData,(r,y)=>(p(),v("div",{key:e.getRowKey(r,y),class:"table-row",onClick:a=>e.handleRowClick(r,y)},[(p(!0),v(P,null,R(f.columns,a=>(p(),v("div",{key:a.key,class:b(["body-cell",a.align?`text-${a.align}`:""]),style:T({width:a.width,minWidth:a.minWidth,flexBasis:a.flex||"auto"})},[et(s.$slots,a.key,{row:r,value:e.getValue(r,a.key),index:y,column:a},()=>[g("span",xt,F(e.formatValue(e.getValue(r,a.key),a)),1)])],6))),128))],8,vt))),128)),e.sortedData.length===0&&!f.loading?(p(),z(c,{key:0,description:"暫無資料",class:"table-empty"})):G("",!0),f.loading?(p(),v("div",wt,[t(m,{size:"24px"},{default:x(()=>l[1]||(l[1]=[tt("載入中...",-1)])),_:1,__:[1]})])):G("",!0)],36)])}const bt=B(ft,[["render",Ft],["__scopeId","data-v-5ef4d0d4"]]),Ct={name:"PriceDiff",components:{VantTable:bt,VanCell:O,VanCellGroup:st},setup(){const s=U(),l=E(!1),f=[{key:"name",title:"名稱",sortable:!0,flex:"1.5",minWidth:"100px"},{key:"changePercent",title:"漲跌幅",sortable:!0,align:"right",flex:"1",minWidth:"80px"},{key:"principal",title:"本金",sortable:!0,align:"right",flex:"1.2",minWidth:"90px"},{key:"returnRate",title:"報酬率",sortable:!0,align:"right",flex:"1",minWidth:"80px"},{key:"priceDiff",title:"價差",sortable:!0,align:"right",flex:"1.2",minWidth:"90px"}],e=L(()=>s.userStockList?.length?s.userStockList.map(a=>{const _=(a.buyPrice||0)*(a.shares||0),h=(a.currentPrice||a.price||0)*(a.shares||0)-_,D=_>0?h/_:0,w=a.buyPrice>0?((a.currentPrice||a.price||0)-a.buyPrice)/a.buyPrice:0;return{stockCode:a.stockCode,name:a.stockName||a.name||a.stockCode||"未知股票",changePercent:w,principal:_,returnRate:D,priceDiff:h,...a}}):[]),u=L(()=>{const a=e.value,_=a.reduce((w,d)=>w+d.principal,0),n=a.reduce((w,d)=>w+d.principal+d.priceDiff,0),h=a.reduce((w,d)=>w+d.priceDiff,0),D=_>0?h/_:0;return{totalPrincipal:_,totalMarketValue:n,totalProfitLoss:h,totalReturnRate:D}}),o=a=>typeof a!="number"||isNaN(a)?"-":`${(a*100).toFixed(2)}%`,i=a=>typeof a!="number"||isNaN(a)?"-":a.toLocaleString("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0}),c=a=>typeof a!="number"||isNaN(a)?"":a>0?"positive":a<0?"negative":"",m=a=>{console.log("點擊股票行：",a)},r=a=>{console.log("排序變化：",a)},y=async()=>{try{l.value=!0,await s.loadUserStockList()}catch(a){console.error("載入股票清單失敗：",a)}finally{l.value=!1}};return at(()=>{y()}),{loading:l,tableColumns:f,stockProfitData:e,summary:u,formatPercent:o,formatCurrency:i,getChangeClass:c,handleRowClick:m,handleSortChange:r}}},kt={class:"price-diff-page"},Dt={class:"profit-table-section"},Et={class:"stock-name-cell"},St={class:"stock-name"},Pt={class:"principal-amount"},Bt={class:"summary-section"};function Vt(s,l,f,e,u,o){const i=k("VantTable"),c=k("van-cell"),m=k("van-cell-group");return p(),v("div",kt,[g("div",Dt,[t(i,{columns:e.tableColumns,data:e.stockProfitData,loading:e.loading,height:"calc(100vh - 160px)","row-key":"stockCode",onRowClick:e.handleRowClick,onSortChange:e.handleSortChange},{name:x(({row:r,value:y})=>[g("div",Et,[g("div",St,F(y||"未知股票"),1)])]),changePercent:x(({value:r})=>[g("span",{class:b(["change-percent",e.getChangeClass(r)])},F(e.formatPercent(r)),3)]),principal:x(({value:r})=>[g("span",Pt,F(e.formatCurrency(r)),1)]),returnRate:x(({value:r})=>[g("span",{class:b(["return-rate",e.getChangeClass(r)])},F(e.formatPercent(r)),3)]),priceDiff:x(({value:r})=>[g("span",{class:b(["price-diff",e.getChangeClass(r)])},F(e.formatCurrency(r)),3)]),_:1},8,["columns","data","loading","onRowClick","onSortChange"])]),g("div",Bt,[t(m,null,{default:x(()=>[t(c,{title:"總本金",value:e.formatCurrency(e.summary.totalPrincipal)},null,8,["value"]),t(c,{title:"總市值",value:e.formatCurrency(e.summary.totalMarketValue)},null,8,["value"]),t(c,{title:"總損益",value:e.formatCurrency(e.summary.totalProfitLoss),class:b(e.getChangeClass(e.summary.totalProfitLoss))},null,8,["value","class"]),t(c,{title:"總報酬率",value:e.formatPercent(e.summary.totalReturnRate),class:b(e.getChangeClass(e.summary.totalReturnRate))},null,8,["value","class"])]),_:1})])])}const Rt=B(Ct,[["render",Vt],["__scopeId","data-v-4377a15c"]]),Gt={class:"dividend-content"},Tt={__name:"Dividend",setup(s){return(l,f)=>(p(),v("div",Gt,f[0]||(f[0]=[g("h3",null,"股利內容",-1),g("p",null,"這裡是股利相關的內容",-1)])))}},Mt=B(Tt,[["__scopeId","data-v-d857dac8"]]),Lt={class:"profit-page"},zt={__name:"Profit",setup(s){const l=E("price-diff"),f=e=>{console.log("切換到：",e)};return(e,u)=>(p(),v("div",Lt,[t(M(nt),{active:l.value,"onUpdate:active":u[0]||(u[0]=o=>l.value=o),swipeable:"",sticky:"",onChange:f,class:"custom-tabs"},{default:x(()=>[t(M(I),{title:"價差",name:"price-diff"},{default:x(()=>[t(Rt)]),_:1}),t(M(I),{title:"股利",name:"dividend"},{default:x(()=>[t(Mt)]),_:1})]),_:1},8,["active"])]))}},Ht=B(zt,[["__scopeId","data-v-10f55ce1"]]);export{Ht as default};
