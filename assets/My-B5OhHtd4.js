import{aA as te,r as g,aB as oe,g as ne,a5 as L,a as x,o as ae,aC as U,L as le,S as w,O as m,Q as e,Y as d,V as ie,W as re,a6 as ue,X as ce,ac as V,U as F,R as a,l as r,P as v,a7 as $,N as de,ab as I,ad as ve,ae as ge,Z as y,af as me}from"./index-BNLaFu7d.js";import{I as C}from"./iconify-Bg9OKoC-.js";import{B as T,s as S}from"./function-call-CZyfJ8Dw.js";import{T as P,a as fe}from"./index-UG-JSCTC.js";import{A as B}from"./index-D7W3H4gB.js";import"./index-C8zZl8Tg.js";const G=te("theme",()=>{const b=g(0),l=g(!1),s=oe();return ne([b,s],()=>{b.value===0?l.value=s.value:b.value===1?l.value=!1:l.value=!0,document.body.classList.toggle("dark",l.value)},{immediate:!0}),{mode:b,isDark:l}}),pe={class:"worker-monitor"},he={class:"monitor-header"},we={class:"total-cpu"},ke={class:"pool-stats"},be={class:"pool-name"},_e={class:"pool-info"},$e={class:"stat-item"},ye={class:"value"},Se={class:"stat-item"},Ce={class:"value busy"},xe={class:"stat-item"},Te={class:"value queue"},Be={class:"stat-item"},Le={class:"value utilization"},ze={class:"progress-bar"},Ae={class:"overall-stats"},De={class:"stat-box"},We={class:"stat-value"},Ue={class:"stat-box"},Fe={class:"stat-value"},Ie={class:"stat-box"},Pe={class:"stat-value"},Ve={__name:"WorkerMonitor",setup(b){const l=g({}),s=g(navigator.hardwareConcurrency||4),f=x(()=>Object.values(l.value).reduce((u,n)=>u+n.busyWorkers,0)),p=x(()=>Object.values(l.value).reduce((u,n)=>u+n.queuedTasks,0)),t=x(()=>{const u=Object.values(l.value);return u.length===0?"0.0":(u.reduce((_,z)=>{const A=parseFloat(z.utilization)||0;return _+A},0)/u.length).toFixed(1)}),k=(u,n,c)=>{l.value={...c}};return ae(()=>{U.onAllStatusChange(k),l.value=U.getAllStatus()}),le(()=>{}),(u,n)=>(m(),w("div",pe,[e("div",he,[n[0]||(n[0]=e("h3",null,"Worker Pool 監控",-1)),e("span",we,"CPU 核心數: "+d(s.value),1)]),e("div",ke,[(m(!0),w(ie,null,re(l.value,(c,_)=>(m(),w("div",{key:_,class:ue(["pool-card",{"pool-busy":c.busyWorkers>0}])},[e("div",be,d(_),1),e("div",_e,[e("div",$e,[n[1]||(n[1]=e("span",{class:"label"},"可用:",-1)),e("span",ye,d(c.availableWorkers)+"/"+d(c.totalWorkers),1)]),e("div",Se,[n[2]||(n[2]=e("span",{class:"label"},"使用中:",-1)),e("span",Ce,d(c.busyWorkers),1)]),e("div",xe,[n[3]||(n[3]=e("span",{class:"label"},"排隊:",-1)),e("span",Te,d(c.queuedTasks),1)]),e("div",Be,[n[4]||(n[4]=e("span",{class:"label"},"使用率:",-1)),e("span",Le,d(c.utilization)+"%",1)])]),e("div",ze,[e("div",{class:"progress-fill",style:ce({width:c.utilization+"%"})},null,4)])],2))),128))]),e("div",Ae,[e("div",De,[e("div",We,d(f.value),1),n[5]||(n[5]=e("div",{class:"stat-label"},"總使用中",-1))]),e("div",Ue,[e("div",Fe,d(p.value),1),n[6]||(n[6]=e("div",{class:"stat-label"},"總排隊",-1))]),e("div",Ie,[e("div",Pe,d(t.value)+"%",1),n[7]||(n[7]=e("div",{class:"stat-label"},"整體使用率",-1))])])]))}},Ge=L(Ve,[["__scopeId","data-v-4aea0f26"]]),Me={class:"preference-settings"},Ne={key:0,class:"auth-section"},Ee={class:"login-prompt"},Oe={class:"login-icon"},je={key:1,class:"user-section"},qe={class:"user-info"},Ke={class:"user-avatar"},Qe=["src","alt"],Re={class:"user-details"},Xe={key:2,class:"guest-section"},Ye={class:"guest-info"},Ze={class:"guest-icon"},He={class:"guest-details"},Je={class:"setting-list"},es={class:"setting-right"},ss={class:"setting-value"},ts={__name:"PreferenceSettings",emits:["showLogin","showLogout","showTheme"],setup(b){const l=G(),s=V(),f=x(()=>{switch(l.mode){case 0:return"跟隨系統";case 1:return"亮";case 2:return"暗";default:return"跟隨系統"}});return(p,t)=>(m(),w("div",Me,[a(s).isAuthenticated?a(s).isLoggedIn?(m(),w("div",je,[e("div",qe,[e("div",Ke,[a(s).user?.avatar?(m(),w("img",{key:0,src:a(s).user.avatar,alt:a(s).user.name},null,8,Qe)):(m(),de(a(C),{key:1,icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#ccc"}))]),e("div",Re,[e("h3",null,d(a(s).user?.name||"用戶"),1),e("p",null,d(a(s).user?.email),1)])])])):a(s).isGuestMode?(m(),w("div",Xe,[e("div",Ye,[e("div",Ze,[r(a(C),{icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#999"})]),e("div",He,[t[8]||(t[8]=e("h3",null,"訪客模式",-1)),t[9]||(t[9]=e("p",null,"資料僅保存在本地",-1)),r(a(T),{type:"primary",size:"small",plain:"",onClick:t[1]||(t[1]=k=>p.$emit("showLogin")),style:{"margin-top":"8px"}},{default:v(()=>t[7]||(t[7]=[$(" 切換到登入 ",-1)])),_:1,__:[7]})])])])):F("",!0):(m(),w("div",Ne,[e("div",Ee,[e("div",Oe,[r(a(C),{icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#ccc"})]),t[5]||(t[5]=e("h3",null,"歡迎使用 iKDx",-1)),t[6]||(t[6]=e("p",null,"登入後可同步您的股票資料",-1)),r(a(T),{type:"primary",size:"large",round:"",block:"",onClick:t[0]||(t[0]=k=>p.$emit("showLogin")),style:{"margin-top":"16px"}},{default:v(()=>t[4]||(t[4]=[$(" 立即登入 ",-1)])),_:1,__:[4]})])])),e("div",Je,[a(s).isLoggedIn?(m(),w("div",{key:0,class:"setting-item",onClick:t[2]||(t[2]=k=>p.$emit("showLogout"))},t[10]||(t[10]=[e("div",{class:"setting-left"},[e("span",{class:"setting-title"},"登出")],-1),e("div",{class:"setting-right"},[e("span",{class:"arrow"},">")],-1)]))):F("",!0),e("div",{class:"setting-item",onClick:t[3]||(t[3]=k=>p.$emit("showTheme"))},[t[12]||(t[12]=e("div",{class:"setting-left"},[e("span",{class:"setting-title"},"主題")],-1)),e("div",es,[e("span",ss,d(f.value),1),t[11]||(t[11]=e("span",{class:"arrow"},">",-1))])])])]))}},os=L(ts,[["__scopeId","data-v-346c921a"]]),ns={class:"advanced-settings"},as={class:"setting-list"},ls={__name:"AdvancedSettings",emits:["showDeveloper","showAppInfo","clearCache","showBackup","showExperimental"],setup(b){return(l,s)=>(m(),w("div",ns,[e("div",as,[e("div",{class:"setting-item",onClick:s[0]||(s[0]=f=>l.$emit("showDeveloper"))},s[5]||(s[5]=[e("div",{class:"setting-left"},[e("span",{class:"setting-title"},"開發者")],-1),e("div",{class:"setting-right"},[e("span",{class:"arrow"},">")],-1)])),e("div",{class:"setting-item",onClick:s[1]||(s[1]=f=>l.$emit("showAppInfo"))},s[6]||(s[6]=[e("div",{class:"setting-left"},[e("span",{class:"setting-title"},"應用資訊")],-1),e("div",{class:"setting-right"},[e("span",{class:"arrow"},">")],-1)])),e("div",{class:"setting-item",onClick:s[2]||(s[2]=f=>l.$emit("clearCache"))},s[7]||(s[7]=[e("div",{class:"setting-left"},[e("span",{class:"setting-title"},"清除快取")],-1),e("div",{class:"setting-right"},[e("span",{class:"arrow"},">")],-1)])),e("div",{class:"setting-item",onClick:s[3]||(s[3]=f=>l.$emit("showBackup"))},s[8]||(s[8]=[e("div",{class:"setting-left"},[e("span",{class:"setting-title"},"備份與還原")],-1),e("div",{class:"setting-right"},[e("span",{class:"arrow"},">")],-1)])),e("div",{class:"setting-item",onClick:s[4]||(s[4]=f=>l.$emit("showExperimental"))},s[9]||(s[9]=[e("div",{class:"setting-left"},[e("span",{class:"setting-title"},"實驗性功能")],-1),e("div",{class:"setting-right"},[e("span",{class:"arrow"},">")],-1)]))])]))}},is=L(ls,[["__scopeId","data-v-99f5ef92"]]),rs={class:"my-page"},us={style:{padding:"20px","max-height":"70vh","overflow-y":"auto"}},cs={class:"login-sheet-content"},ds={class:"login-logo-section"},vs={class:"app-logo"},gs={class:"login-buttons"},ms={class:"login-terms"},fs={class:"terms-text"},ps={class:"loading-content"},hs={__name:"My",setup(b){me();const l=G(),s=V(),f=g("preference"),p=g(!1),t=g(!1),k=g(!1),u=g(!1),n=g(!1),c=g(!1),_=g(!1),z=x(()=>[{name:"跟隨系統",value:0,color:l.mode===0?"#1989fa":void 0,className:l.mode===0?"selected-theme":void 0},{name:"亮",value:1,color:l.mode===1?"#1989fa":void 0,className:l.mode===1?"selected-theme":void 0},{name:"暗",value:2,color:l.mode===2?"#1989fa":void 0,className:l.mode===2?"selected-theme":void 0}]),A=[{name:"Worker Pool 監控",value:"worker"},{name:"應用資訊",value:"info"},{name:"清除快取",value:"clear"}];function M(){p.value=!0}function N(){t.value=!0}function E(){u.value=!0}function O(){S({title:"確認登出",message:"確定要登出嗎？",showCancelButton:!0,confirmButtonText:"登出",cancelButtonText:"取消"}).then(()=>{s.logout(),y.success("已登出")}).catch(()=>{})}function j(i){console.log("切換到：",i)}function q(i){l.mode=i.value,p.value=!1}function K(i){switch(t.value=!1,i.value){case"worker":k.value=!0;break;case"info":D();break;case"clear":W();break}}function D(){S({title:"應用資訊",message:`
應用名稱：iKDx 智能股票分析平台
版本：v1.0.0
構建日期：${new Date().toLocaleDateString()}
框架：Vue 3 + Vant + Tauri
            `.trim(),showCancelButton:!1,confirmButtonText:"我知道了"})}function W(){S({title:"清除快取",message:"確定要清除所有快取資料嗎？這將會清除本地保存的股票資料。",showCancelButton:!0,confirmButtonText:"清除",cancelButtonText:"取消"}).then(()=>{localStorage.clear(),sessionStorage.clear(),y.success("快取已清除")}).catch(()=>{})}function Q(){S({title:"備份與還原",message:"此功能將在未來版本中提供，敬請期待。",showCancelButton:!1,confirmButtonText:"我知道了"})}function R(){S({title:"實驗性功能",message:"此功能將在未來版本中提供，敬請期待。",showCancelButton:!1,confirmButtonText:"我知道了"})}async function X(){try{c.value=!0,n.value=!0;const i=await H();if(i.success)await s.loginWithGoogle(i.token),y.success("Google 登入成功！"),u.value=!1;else throw new Error(i.error)}catch(i){console.error("Google 登入失敗:",i),y.fail("Google 登入失敗，請稍後再試")}finally{c.value=!1,n.value=!1}}async function Y(){try{_.value=!0,n.value=!0;const i=await J();if(i.success)await s.loginWithFacebook(i.token),y.success("Facebook 登入成功！"),u.value=!1;else throw new Error(i.error)}catch(i){console.error("Facebook 登入失敗:",i),y.fail("Facebook 登入失敗，請稍後再試")}finally{_.value=!1,n.value=!1}}function Z(){u.value=!1,y("繼續使用訪客模式")}async function H(){return new Promise(i=>{setTimeout(()=>{i({success:!0,token:"mock-google-token",user:{id:"google-123",name:"測試用戶",email:"test@gmail.com",avatar:""}})},1500)})}async function J(){return new Promise(i=>{setTimeout(()=>{i({success:!0,token:"mock-facebook-token",user:{id:"fb-123",name:"測試用戶",email:"test@facebook.com",avatar:""}})},1500)})}function ee(){S({title:"服務條款",message:"這裡是服務條款內容...",showCancelButton:!1,confirmButtonText:"我知道了"})}function se(){S({title:"隱私政策",message:"這裡是隱私政策內容...",showCancelButton:!1,confirmButtonText:"我知道了"})}return(i,o)=>(m(),w("div",rs,[r(a(fe),{active:f.value,"onUpdate:active":o[0]||(o[0]=h=>f.value=h),swipeable:"",sticky:"",onChange:j,class:"custom-tabs"},{default:v(()=>[r(a(P),{title:"偏好",name:"preference"},{default:v(()=>[r(os,{onShowLogin:E,onShowLogout:O,onShowTheme:M})]),_:1}),r(a(P),{title:"進階",name:"advanced"},{default:v(()=>[r(is,{onShowDeveloper:N,onShowAppInfo:D,onClearCache:W,onShowBackup:Q,onShowExperimental:R})]),_:1})]),_:1},8,["active"]),r(a(B),{show:p.value,"onUpdate:show":o[1]||(o[1]=h=>p.value=h),actions:z.value,title:"選擇主題","cancel-text":"取消",onSelect:q,class:"theme-action-sheet"},null,8,["show","actions"]),r(a(B),{show:t.value,"onUpdate:show":o[2]||(o[2]=h=>t.value=h),actions:A,title:"開發者選項","cancel-text":"取消",onSelect:K},null,8,["show"]),r(a(B),{show:k.value,"onUpdate:show":o[3]||(o[3]=h=>k.value=h),title:"Worker Pool 監控","cancel-text":"關閉"},{default:v(()=>[e("div",us,[r(Ge)])]),_:1},8,["show"]),r(a(B),{show:u.value,"onUpdate:show":o[4]||(o[4]=h=>u.value=h),title:"登入 iKDx","cancel-text":"取消",class:"login-action-sheet"},{default:v(()=>[e("div",cs,[e("div",ds,[e("div",vs,[r(a(C),{icon:"flowbite:star-solid",width:"50",height:"50",color:"#FFD600"})]),o[6]||(o[6]=e("h2",{class:"app-title"},"智能股票分析平台",-1)),o[7]||(o[7]=e("p",{class:"login-subtitle"},"登入後可同步您的股票資料到雲端",-1))]),e("div",gs,[r(a(T),{class:"login-btn google-btn",size:"large",block:"",loading:c.value,onClick:X},{default:v(()=>[r(a(C),{icon:"logos:google-icon",width:"20",height:"20",style:{"margin-right":"8px"}}),o[8]||(o[8]=$(" 使用 Google 帳號登入 ",-1))]),_:1,__:[8]},8,["loading"]),r(a(T),{class:"login-btn facebook-btn",size:"large",block:"",loading:_.value,onClick:Y},{default:v(()=>[r(a(C),{icon:"logos:facebook",width:"20",height:"20",style:{"margin-right":"8px"}}),o[9]||(o[9]=$(" 使用 Facebook 帳號登入 ",-1))]),_:1,__:[9]},8,["loading"]),o[11]||(o[11]=e("div",{class:"login-divider"},[e("span",null,"或")],-1)),r(a(T),{class:"guest-continue-btn",size:"large",block:"",plain:"",onClick:Z},{default:v(()=>o[10]||(o[10]=[$(" 繼續使用訪客模式 ",-1)])),_:1,__:[10]})]),e("div",ms,[e("p",fs,[o[12]||(o[12]=$(" 登入即表示您同意我們的 ",-1)),e("a",{href:"#",onClick:I(ee,["prevent"])},"服務條款"),o[13]||(o[13]=$(" 和 ",-1)),e("a",{href:"#",onClick:I(se,["prevent"])},"隱私政策")])])])]),_:1},8,["show"]),r(a(ge),{show:n.value,"onUpdate:show":o[5]||(o[5]=h=>n.value=h),class:"loading-overlay"},{default:v(()=>[e("div",ps,[r(a(ve),{size:"24px",vertical:""},{default:v(()=>o[14]||(o[14]=[$("登入中...",-1)])),_:1,__:[14]})])]),_:1},8,["show"])]))}},Ss=L(hs,[["__scopeId","data-v-103fb177"]]);export{Ss as default};
