import{d as He,t as Be,m as Re,n as st,c as qe,r as G,a as Pt,u as Mt,b as wo,e as oe,f as an,w as De,g as So,o as Ye,h as Bn,i as _o,j as Rn,k as Yn,l as Nt,p as B,q as dn,s as Se,v as yt,x as dt,y as bt,z as wt,A as rn,B as Ge,C as Do,D as xo,E as fn,F as hn,G as Eo,H as Co,I as To,J as Hn,T as $o,K as Ln,L as Gt,M as ko,N as Ao,O as Io,P as Oo,Q as Po,R as Mo,S as No,U as Fo,V as Bo,W as Wn,X as gn,Y as Ro,Z as Yo,_ as jn,$ as zn,a0 as Vn,a1 as Ho,a2 as Lo,a3 as Wo,a4 as ft,a5 as jo,a6 as zo,a7 as pn,a8 as Un,a9 as Vo,aa as Uo,ab as me,ac as ce,ad as j,ae as ne,af as we,ag as Xo,ah as mn,ai as vn,aj as Xn,ak as fe,al as Kt,am as je,an as sn,ao as qo,ap as Zt,aq as Go,ar as Ko,as as yn,at as Zo,au as Jo}from"./index-MizcOQpi.js";import{S as Qo,B as St}from"./index-RgHt_U9-.js";function bn(e,t){return e.reduce((n,o)=>Math.abs(n-t)<Math.abs(o-t)?n:o)}const[qn,ht]=qe("swipe"),ea={loop:Be,width:st,height:st,vertical:Boolean,autoplay:Re(0),duration:Re(500),touchable:Be,lazyRender:Boolean,initialSwipe:Re(0),indicatorColor:String,showIndicators:Be,stopPropagation:Be},Gn=Symbol(qn);var ta=He({name:qn,props:ea,emits:["change","dragStart","dragEnd"],setup(e,{emit:t,slots:n}){const o=G(),a=G(),r=Pt({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let i=!1;const s=Mt(),{children:l,linkChildren:u}=wo(Gn),d=oe(()=>l.length),f=oe(()=>r[e.vertical?"height":"width"]),c=oe(()=>e.vertical?s.deltaY.value:s.deltaX.value),h=oe(()=>r.rect?(e.vertical?r.rect.height:r.rect.width)-f.value*d.value:0),g=oe(()=>f.value?Math.ceil(Math.abs(h.value)/f.value):d.value),p=oe(()=>d.value*f.value),D=oe(()=>(r.active+d.value)%d.value),v=oe(()=>{const x=e.vertical?"vertical":"horizontal";return s.direction.value===x}),$=oe(()=>{const x={transitionDuration:`${r.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${+r.offset.toFixed(2)}px)`};if(f.value){const R=e.vertical?"height":"width",L=e.vertical?"width":"height";x[R]=`${p.value}px`,x[L]=e[L]?`${e[L]}px`:""}return x}),C=x=>{const{active:R}=r;return x?e.loop?yt(R+x,-1,d.value):yt(R+x,0,g.value):R},S=(x,R=0)=>{let L=x*f.value;e.loop||(L=Math.min(L,-h.value));let U=R-L;return e.loop||(U=yt(U,h.value,0)),U},y=({pace:x=0,offset:R=0,emitChange:L})=>{if(d.value<=1)return;const{active:U}=r,X=C(x),ge=S(X,R);if(e.loop){if(l[0]&&ge!==h.value){const ve=ge<h.value;l[0].setOffset(ve?p.value:0)}if(l[d.value-1]&&ge!==0){const ve=ge>0;l[d.value-1].setOffset(ve?-p.value:0)}}r.active=X,r.offset=ge,L&&X!==U&&t("change",D.value)},F=()=>{r.swiping=!0,r.active<=-1?y({pace:d.value}):r.active>=d.value&&y({pace:-d.value})},W=()=>{F(),s.reset(),dt(()=>{r.swiping=!1,y({pace:-1,emitChange:!0})})},A=()=>{F(),s.reset(),dt(()=>{r.swiping=!1,y({pace:1,emitChange:!0})})};let P;const H=()=>clearTimeout(P),k=()=>{H(),+e.autoplay>0&&d.value>1&&(P=setTimeout(()=>{A(),k()},+e.autoplay))},K=(x=+e.initialSwipe)=>{if(!o.value)return;const R=()=>{var L,U;if(!dn(o)){const X={width:o.value.offsetWidth,height:o.value.offsetHeight};r.rect=X,r.width=+((L=e.width)!=null?L:X.width),r.height=+((U=e.height)!=null?U:X.height)}d.value&&(x=Math.min(d.value-1,x),x===-1&&(x=d.value-1)),r.active=x,r.swiping=!0,r.offset=S(x),l.forEach(X=>{X.setOffset(0)}),k()};dn(o)?Se().then(R):R()},ee=()=>K(r.active);let T;const _=x=>{!e.touchable||x.touches.length>1||(s.start(x),i=!1,T=Date.now(),H(),F())},m=x=>{e.touchable&&r.swiping&&(s.move(x),v.value&&(!e.loop&&(r.active===0&&c.value>0||r.active===d.value-1&&c.value<0)||(rn(x,e.stopPropagation),y({offset:c.value}),i||(t("dragStart",{index:D.value}),i=!0))))},E=()=>{if(!e.touchable||!r.swiping)return;const x=Date.now()-T,R=c.value/x;if((Math.abs(R)>.25||Math.abs(c.value)>f.value/2)&&v.value){const U=e.vertical?s.offsetY.value:s.offsetX.value;let X=0;e.loop?X=U>0?c.value>0?-1:1:0:X=-Math[c.value>0?"ceil":"floor"](c.value/f.value),y({pace:X,emitChange:!0})}else c.value&&y({pace:0});i=!1,r.swiping=!1,t("dragEnd",{index:D.value}),k()},w=(x,R={})=>{F(),s.reset(),dt(()=>{let L;e.loop&&x===d.value?L=r.active===0?0:x:L=x%d.value,R.immediate?dt(()=>{r.swiping=!1}):r.swiping=!1,y({pace:L-r.active,emitChange:!0})})},M=(x,R)=>{const L=R===D.value,U=L?{backgroundColor:e.indicatorColor}:void 0;return B("i",{style:U,class:ht("indicator",{active:L})},null)},N=()=>{if(n.indicator)return n.indicator({active:D.value,total:d.value});if(e.showIndicators&&d.value>1)return B("div",{class:ht("indicators",{vertical:e.vertical})},[Array(d.value).fill("").map(M)])};return an({prev:W,next:A,state:r,resize:ee,swipeTo:w}),u({size:f,props:e,count:d,activeIndicator:D}),De(()=>e.initialSwipe,x=>K(+x)),De(d,()=>K(r.active)),De(()=>e.autoplay,k),De([bt,wt,()=>e.width,()=>e.height],ee),De(So(),x=>{x==="visible"?k():H()}),Ye(K),Bn(()=>K(r.active)),_o(()=>K(r.active)),Rn(H),Yn(H),Nt("touchmove",m,{target:a}),()=>{var x;return B("div",{ref:o,class:ht()},[B("div",{ref:a,style:$.value,class:ht("track",{vertical:e.vertical}),onTouchstartPassive:_,onTouchend:E,onTouchcancel:E},[(x=n.default)==null?void 0:x.call(n)]),N()])}}});const na=Ge(ta),[oa,aa]=qe("swipe-item");var ra=He({name:oa,setup(e,{slots:t}){let n;const o=Pt({offset:0,inited:!1,mounted:!1}),{parent:a,index:r}=Do(Gn);if(!a)return;const i=oe(()=>{const u={},{vertical:d}=a.props;return a.size.value&&(u[d?"height":"width"]=`${a.size.value}px`),o.offset&&(u.transform=`translate${d?"Y":"X"}(${o.offset}px)`),u}),s=oe(()=>{const{loop:u,lazyRender:d}=a.props;if(!d||n)return!0;if(!o.mounted)return!1;const f=a.activeIndicator.value,c=a.count.value-1,h=f===0&&u?c:f-1,g=f===c&&u?0:f+1;return n=r.value===f||r.value===h||r.value===g,n}),l=u=>{o.offset=u};return Ye(()=>{Se(()=>{o.mounted=!0})}),an({setOffset:l}),()=>{var u;return B("div",{class:aa(),style:i.value},[s.value?(u=t.default)==null?void 0:u.call(t):null])}}});const wn=Ge(ra),ia={gap:{type:[Number,Object],default:24},icon:String,axis:xo("y"),magnetic:String,offset:Object,teleport:{type:[String,Object],default:"body"}},[sa,Sn]=qe("floating-bubble");var la=He({name:sa,inheritAttrs:!1,props:ia,emits:["click","update:offset","offsetChange"],setup(e,{slots:t,emit:n,attrs:o}){const a=G(),r=G({x:0,y:0,width:0,height:0}),i=oe(()=>fn(e.gap)?e.gap.x:e.gap),s=oe(()=>fn(e.gap)?e.gap.y:e.gap),l=oe(()=>({top:s.value,right:bt.value-r.value.width-i.value,bottom:wt.value-r.value.height-s.value,left:i.value})),u=G(!1);let d=!1;const f=oe(()=>{const y={},F=hn(r.value.x),W=hn(r.value.y);return y.transform=`translate3d(${F}, ${W}, 0)`,(u.value||!d)&&(y.transition="none"),y}),c=()=>{if(!S.value)return;const{width:y,height:F}=Ln(a.value),{offset:W}=e;r.value={x:W?W.x:bt.value-y-i.value,y:W?W.y:wt.value-F-s.value,width:y,height:F}},h=Mt();let g=0,p=0;const D=y=>{h.start(y),u.value=!0,g=r.value.x,p=r.value.y};Nt("touchmove",y=>{if(y.preventDefault(),h.move(y),e.axis!=="lock"&&!h.isTap.value){if(e.axis==="x"||e.axis==="xy"){let W=g+h.deltaX.value;W<l.value.left&&(W=l.value.left),W>l.value.right&&(W=l.value.right),r.value.x=W}if(e.axis==="y"||e.axis==="xy"){let W=p+h.deltaY.value;W<l.value.top&&(W=l.value.top),W>l.value.bottom&&(W=l.value.bottom),r.value.y=W}const F=Gt(r.value,["x","y"]);n("update:offset",F)}},{target:a});const $=()=>{u.value=!1,Se(()=>{if(e.magnetic==="x"){const y=bn([l.value.left,l.value.right],r.value.x);r.value.x=y}if(e.magnetic==="y"){const y=bn([l.value.top,l.value.bottom],r.value.y);r.value.y=y}if(!h.isTap.value){const y=Gt(r.value,["x","y"]);n("update:offset",y),(g!==y.x||p!==y.y)&&n("offsetChange",y)}})},C=y=>{h.isTap.value?n("click",y):y.stopPropagation()};Ye(()=>{c(),Se(()=>{d=!0})}),De([bt,wt,i,s,()=>e.offset],c,{deep:!0});const S=G(!0);return Bn(()=>{S.value=!0}),Rn(()=>{e.teleport&&(S.value=!1)}),()=>{const y=Eo(B("div",Hn({class:Sn(),ref:a,onTouchstartPassive:D,onTouchend:$,onTouchcancel:$,onClickCapture:C,style:f.value},o),[t.default?t.default():B(To,{name:e.icon,class:Sn("icon")},null)]),[[Co,S.value]]);return e.teleport?B($o,{to:e.teleport},{default:()=>[y]}):y}}});const ca=Ge(la),[ua,Je,da]=qe("pull-refresh"),Kn=50,fa=["pulling","loosing","success"],ha={disabled:Boolean,modelValue:Boolean,headHeight:Re(Kn),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:st,successDuration:Re(500),animationDuration:Re(300)};var ga=He({name:ua,props:ha,emits:["change","refresh","update:modelValue"],setup(e,{emit:t,slots:n}){let o;const a=G(),r=G(),i=ko(a),s=Pt({status:"normal",distance:0,duration:0}),l=Mt(),u=()=>{if(e.headHeight!==Kn)return{height:`${e.headHeight}px`}},d=()=>s.status!=="loading"&&s.status!=="success"&&!e.disabled,f=S=>{const y=+(e.pullDistance||e.headHeight);return S>y&&(S<y*2?S=y+(S-y)/2:S=y*1.5+(S-y*2)/4),Math.round(S)},c=(S,y)=>{const F=+(e.pullDistance||e.headHeight);s.distance=S,y?s.status="loading":S===0?s.status="normal":S<F?s.status="pulling":s.status="loosing",t("change",{status:s.status,distance:S})},h=()=>{const{status:S}=s;return S==="normal"?"":e[`${S}Text`]||da(S)},g=()=>{const{status:S,distance:y}=s;if(n[S])return n[S]({distance:y});const F=[];return fa.includes(S)&&F.push(B("div",{class:Je("text")},[h()])),S==="loading"&&F.push(B(Ao,{class:Je("loading")},{default:h})),F},p=()=>{s.status="success",setTimeout(()=>{c(0)},+e.successDuration)},D=S=>{o=Io(i.value)===0,o&&(s.duration=0,l.start(S))},v=S=>{d()&&D(S)},$=S=>{if(d()){o||D(S);const{deltaY:y}=l;l.move(S),o&&y.value>=0&&l.isVertical()&&(rn(S),c(f(y.value)))}},C=()=>{o&&l.deltaY.value&&d()&&(s.duration=+e.animationDuration,s.status==="loosing"?(c(+e.headHeight,!0),t("update:modelValue",!0),Se(()=>t("refresh"))):c(0))};return De(()=>e.modelValue,S=>{s.duration=+e.animationDuration,S?c(+e.headHeight,!0):n.success||e.successText?p():c(0,!1)}),Nt("touchmove",$,{target:r}),()=>{var S;const y={transitionDuration:`${s.duration}ms`,transform:s.distance?`translate3d(0,${s.distance}px, 0)`:""};return B("div",{ref:a,class:Je()},[B("div",{ref:r,class:Je("track"),style:y,onTouchstartPassive:v,onTouchend:C,onTouchcancel:C},[B("div",{class:Je("head"),style:u()},[g()]),(S=n.default)==null?void 0:S.call(n)])])}}});const pa=Ge(ga),ma=e=>e?.includes("/"),va=[...Po,"round","closeOnPopstate","safeAreaInsetBottom"],ya={qq:"qq",link:"link-o",weibo:"weibo",qrcode:"qr",poster:"photo-o",wechat:"wechat","weapp-qrcode":"miniprogram-o","wechat-moments":"wechat-moments"},[ba,ye,wa]=qe("share-sheet"),Sa=Oo({},No,{title:String,round:Be,options:Fo(),cancelText:String,description:String,closeOnPopstate:Be,safeAreaInsetBottom:Be});var _a=He({name:ba,props:Sa,emits:["cancel","select","update:show"],setup(e,{emit:t,slots:n}){const o=c=>t("update:show",c),a=()=>{o(!1),t("cancel")},r=(c,h)=>t("select",c,h),i=()=>{const c=n.title?n.title():e.title,h=n.description?n.description():e.description;if(c||h)return B("div",{class:ye("header")},[c&&B("h2",{class:ye("title")},[c]),h&&B("span",{class:ye("description")},[h])])},s=c=>ma(c)?B("img",{src:c,class:ye("image-icon")},null):B("div",{class:ye("icon",[c])},[B(Wn,{name:ya[c]||c},null)]),l=(c,h)=>{const{name:g,icon:p,className:D,description:v}=c;return B("div",{role:"button",tabindex:0,class:[ye("option"),D,Bo],onClick:()=>r(c,h)},[s(p),g&&B("span",{class:ye("name")},[g]),v&&B("span",{class:ye("option-description")},[v])])},u=(c,h)=>B("div",{class:ye("options",{border:h})},[c.map(l)]),d=()=>{const{options:c}=e;return Array.isArray(c[0])?c.map((h,g)=>u(h,g!==0)):u(c)},f=()=>{var c;const h=(c=e.cancelText)!=null?c:wa("cancel");if(n.cancel||h)return B("button",{type:"button",class:ye("cancel"),onClick:a},[n.cancel?n.cancel():h])};return()=>B(Mo,Hn({class:ye(),position:"bottom","onUpdate:show":o},Gt(e,va)),{default:()=>[i(),d(),f()]})}});const Da=Ge(_a),[xa,Bt]=qe("swipe-cell"),Ea={name:Re(""),disabled:Boolean,leftWidth:st,rightWidth:st,beforeClose:Function,stopPropagation:Boolean};var Ca=He({name:xa,props:Ea,emits:["open","close","click"],setup(e,{emit:t,slots:n}){let o,a,r,i;const s=G(),l=G(),u=G(),d=Pt({offset:0,dragging:!1}),f=Mt(),c=A=>A.value?Ln(A).width:0,h=oe(()=>gn(e.leftWidth)?+e.leftWidth:c(l)),g=oe(()=>gn(e.rightWidth)?+e.rightWidth:c(u)),p=A=>{d.offset=A==="left"?h.value:-g.value,o||(o=!0,t("open",{name:e.name,position:A}))},D=A=>{d.offset=0,o&&(o=!1,t("close",{name:e.name,position:A}))},v=A=>{const P=Math.abs(d.offset),H=.15,k=o?1-H:H,K=A==="left"?h.value:g.value;K&&P>K*k?p(A):D(A)},$=A=>{e.disabled||(r=d.offset,f.start(A))},C=A=>{if(e.disabled)return;const{deltaX:P}=f;f.move(A),f.isHorizontal()&&(a=!0,d.dragging=!0,(!o||P.value*r<0)&&rn(A,e.stopPropagation),d.offset=yt(P.value+r,-g.value,h.value))},S=()=>{d.dragging&&(d.dragging=!1,v(d.offset>0?"left":"right"),setTimeout(()=>{a=!1},0))},y=(A="outside",P)=>{i||(t("click",A),o&&!a&&(i=!0,Yo(e.beforeClose,{args:[{event:P,name:e.name,position:A}],done:()=>{i=!1,D(A)},canceled:()=>i=!1,error:()=>i=!1})))},F=A=>P=>{(a||o)&&P.stopPropagation(),!a&&y(A,P)},W=(A,P)=>{const H=n[A];if(H)return B("div",{ref:P,class:Bt(A),onClick:F(A)},[H()])};return an({open:p,close:D}),Ro(s,A=>y("outside",A),{eventName:"touchstart"}),Nt("touchmove",C,{target:s}),()=>{var A;const P={transform:`translate3d(${d.offset}px, 0, 0)`,transitionDuration:d.dragging?"0s":".6s"};return B("div",{ref:s,class:Bt(),onClick:F("cell"),onTouchstartPassive:$,onTouchend:S,onTouchcancel:S},[B("div",{class:Bt("wrapper"),style:P},[W("left",l),(A=n.default)==null?void 0:A.call(n),W("right",u)])])}}});const Ta=Ge(Ca);async function $a(){console.log("開始執行 getStocksFromDB");const e=await jn("all-stocks");if(e&&e.length>0)return console.log("從 IndexedDB 獲取的股票資料:",e),e;{console.log("all-stocks store 無資料，開始從 stock_list.json 獲取");const n=(await zn.get("stocks/stock_list.json")).data;for(const o of n)await Vn("all-stocks",o);return console.log("股票資料已快取到 IndexedDB:",n),n}}function ka(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _t={exports:{}},Aa=_t.exports,_n;function Ia(){return _n||(_n=1,function(e,t){(function(n,o){e.exports=o()})(Aa,function(){var n=1e3,o=6e4,a=36e5,r="millisecond",i="second",s="minute",l="hour",u="day",d="week",f="month",c="quarter",h="year",g="date",p="Invalid Date",D=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,$={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var _=["th","st","nd","rd"],m=T%100;return"["+T+(_[(m-20)%10]||_[m]||_[0])+"]"}},C=function(T,_,m){var E=String(T);return!E||E.length>=_?T:""+Array(_+1-E.length).join(m)+T},S={s:C,z:function(T){var _=-T.utcOffset(),m=Math.abs(_),E=Math.floor(m/60),w=m%60;return(_<=0?"+":"-")+C(E,2,"0")+":"+C(w,2,"0")},m:function T(_,m){if(_.date()<m.date())return-T(m,_);var E=12*(m.year()-_.year())+(m.month()-_.month()),w=_.clone().add(E,f),M=m-w<0,N=_.clone().add(E+(M?-1:1),f);return+(-(E+(m-w)/(M?w-N:N-w))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:f,y:h,w:d,d:u,D:g,h:l,m:s,s:i,ms:r,Q:c}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},y="en",F={};F[y]=$;var W="$isDayjsObject",A=function(T){return T instanceof K||!(!T||!T[W])},P=function T(_,m,E){var w;if(!_)return y;if(typeof _=="string"){var M=_.toLowerCase();F[M]&&(w=M),m&&(F[M]=m,w=M);var N=_.split("-");if(!w&&N.length>1)return T(N[0])}else{var x=_.name;F[x]=_,w=x}return!E&&w&&(y=w),w||!E&&y},H=function(T,_){if(A(T))return T.clone();var m=typeof _=="object"?_:{};return m.date=T,m.args=arguments,new K(m)},k=S;k.l=P,k.i=A,k.w=function(T,_){return H(T,{locale:_.$L,utc:_.$u,x:_.$x,$offset:_.$offset})};var K=function(){function T(m){this.$L=P(m.locale,null,!0),this.parse(m),this.$x=this.$x||m.x||{},this[W]=!0}var _=T.prototype;return _.parse=function(m){this.$d=function(E){var w=E.date,M=E.utc;if(w===null)return new Date(NaN);if(k.u(w))return new Date;if(w instanceof Date)return new Date(w);if(typeof w=="string"&&!/Z$/i.test(w)){var N=w.match(D);if(N){var x=N[2]-1||0,R=(N[7]||"0").substring(0,3);return M?new Date(Date.UTC(N[1],x,N[3]||1,N[4]||0,N[5]||0,N[6]||0,R)):new Date(N[1],x,N[3]||1,N[4]||0,N[5]||0,N[6]||0,R)}}return new Date(w)}(m),this.init()},_.init=function(){var m=this.$d;this.$y=m.getFullYear(),this.$M=m.getMonth(),this.$D=m.getDate(),this.$W=m.getDay(),this.$H=m.getHours(),this.$m=m.getMinutes(),this.$s=m.getSeconds(),this.$ms=m.getMilliseconds()},_.$utils=function(){return k},_.isValid=function(){return this.$d.toString()!==p},_.isSame=function(m,E){var w=H(m);return this.startOf(E)<=w&&w<=this.endOf(E)},_.isAfter=function(m,E){return H(m)<this.startOf(E)},_.isBefore=function(m,E){return this.endOf(E)<H(m)},_.$g=function(m,E,w){return k.u(m)?this[E]:this.set(w,m)},_.unix=function(){return Math.floor(this.valueOf()/1e3)},_.valueOf=function(){return this.$d.getTime()},_.startOf=function(m,E){var w=this,M=!!k.u(E)||E,N=k.p(m),x=function(Pe,se){var ke=k.w(w.$u?Date.UTC(w.$y,se,Pe):new Date(w.$y,se,Pe),w);return M?ke:ke.endOf(u)},R=function(Pe,se){return k.w(w.toDate()[Pe].apply(w.toDate("s"),(M?[0,0,0,0]:[23,59,59,999]).slice(se)),w)},L=this.$W,U=this.$M,X=this.$D,ge="set"+(this.$u?"UTC":"");switch(N){case h:return M?x(1,0):x(31,11);case f:return M?x(1,U):x(0,U+1);case d:var ve=this.$locale().weekStart||0,Ke=(L<ve?L+7:L)-ve;return x(M?X-Ke:X+(6-Ke),U);case u:case g:return R(ge+"Hours",0);case l:return R(ge+"Minutes",1);case s:return R(ge+"Seconds",2);case i:return R(ge+"Milliseconds",3);default:return this.clone()}},_.endOf=function(m){return this.startOf(m,!1)},_.$set=function(m,E){var w,M=k.p(m),N="set"+(this.$u?"UTC":""),x=(w={},w[u]=N+"Date",w[g]=N+"Date",w[f]=N+"Month",w[h]=N+"FullYear",w[l]=N+"Hours",w[s]=N+"Minutes",w[i]=N+"Seconds",w[r]=N+"Milliseconds",w)[M],R=M===u?this.$D+(E-this.$W):E;if(M===f||M===h){var L=this.clone().set(g,1);L.$d[x](R),L.init(),this.$d=L.set(g,Math.min(this.$D,L.daysInMonth())).$d}else x&&this.$d[x](R);return this.init(),this},_.set=function(m,E){return this.clone().$set(m,E)},_.get=function(m){return this[k.p(m)]()},_.add=function(m,E){var w,M=this;m=Number(m);var N=k.p(E),x=function(U){var X=H(M);return k.w(X.date(X.date()+Math.round(U*m)),M)};if(N===f)return this.set(f,this.$M+m);if(N===h)return this.set(h,this.$y+m);if(N===u)return x(1);if(N===d)return x(7);var R=(w={},w[s]=o,w[l]=a,w[i]=n,w)[N]||1,L=this.$d.getTime()+m*R;return k.w(L,this)},_.subtract=function(m,E){return this.add(-1*m,E)},_.format=function(m){var E=this,w=this.$locale();if(!this.isValid())return w.invalidDate||p;var M=m||"YYYY-MM-DDTHH:mm:ssZ",N=k.z(this),x=this.$H,R=this.$m,L=this.$M,U=w.weekdays,X=w.months,ge=w.meridiem,ve=function(se,ke,Ze,ut){return se&&(se[ke]||se(E,M))||Ze[ke].slice(0,ut)},Ke=function(se){return k.s(x%12||12,se,"0")},Pe=ge||function(se,ke,Ze){var ut=se<12?"AM":"PM";return Ze?ut.toLowerCase():ut};return M.replace(v,function(se,ke){return ke||function(Ze){switch(Ze){case"YY":return String(E.$y).slice(-2);case"YYYY":return k.s(E.$y,4,"0");case"M":return L+1;case"MM":return k.s(L+1,2,"0");case"MMM":return ve(w.monthsShort,L,X,3);case"MMMM":return ve(X,L);case"D":return E.$D;case"DD":return k.s(E.$D,2,"0");case"d":return String(E.$W);case"dd":return ve(w.weekdaysMin,E.$W,U,2);case"ddd":return ve(w.weekdaysShort,E.$W,U,3);case"dddd":return U[E.$W];case"H":return String(x);case"HH":return k.s(x,2,"0");case"h":return Ke(1);case"hh":return Ke(2);case"a":return Pe(x,R,!0);case"A":return Pe(x,R,!1);case"m":return String(R);case"mm":return k.s(R,2,"0");case"s":return String(E.$s);case"ss":return k.s(E.$s,2,"0");case"SSS":return k.s(E.$ms,3,"0");case"Z":return N}return null}(se)||N.replace(":","")})},_.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},_.diff=function(m,E,w){var M,N=this,x=k.p(E),R=H(m),L=(R.utcOffset()-this.utcOffset())*o,U=this-R,X=function(){return k.m(N,R)};switch(x){case h:M=X()/12;break;case f:M=X();break;case c:M=X()/3;break;case d:M=(U-L)/6048e5;break;case u:M=(U-L)/864e5;break;case l:M=U/a;break;case s:M=U/o;break;case i:M=U/n;break;default:M=U}return w?M:k.a(M)},_.daysInMonth=function(){return this.endOf(f).$D},_.$locale=function(){return F[this.$L]},_.locale=function(m,E){if(!m)return this.$L;var w=this.clone(),M=P(m,E,!0);return M&&(w.$L=M),w},_.clone=function(){return k.w(this.$d,this)},_.toDate=function(){return new Date(this.valueOf())},_.toJSON=function(){return this.isValid()?this.toISOString():null},_.toISOString=function(){return this.$d.toISOString()},_.toString=function(){return this.$d.toUTCString()},T}(),ee=K.prototype;return H.prototype=ee,[["$ms",r],["$s",i],["$m",s],["$H",l],["$W",u],["$M",f],["$y",h],["$D",g]].forEach(function(T){ee[T[1]]=function(_){return this.$g(_,T[0],T[1])}}),H.extend=function(T,_){return T.$i||(T(_,K,H),T.$i=!0),H},H.locale=P,H.isDayjs=A,H.unix=function(T){return H(1e3*T)},H.en=F[y],H.Ls=F,H.p={},H})}(_t)),_t.exports}var Oa=Ia();const Jt=ka(Oa);function Pa(e,t=30){if(!e)return!0;const n=Jt(),o=Jt(e);return n.diff(o,"minute")>t}async function Ma(e){try{console.log(`開始抓取股票 ${e} 的資料...`);const t=await zn.get(`stocks/${e}/all.json`);if(t.data){const n={stockCode:e,data:t.data,lastUpdated:new Date().toISOString(),fetchedAt:Jt().format("YYYY-MM-DD HH:mm:ss")};return console.log(`成功抓取股票 ${e} 資料`),n}return console.warn(`股票 ${e} 無資料回傳`),null}catch(t){return console.error(`抓取股票 ${e} 失敗:`,t),null}}async function Na(e){try{const t={id:e.stockCode,daily:e.data,lastUpdated:e.lastUpdated,fetchedAt:e.fetchedAt};await Vn("user-stock-data",t),console.log(`股票 ${e.stockCode} 資料已儲存到 IndexedDB`)}catch(t){console.error(`儲存股票 ${e.stockCode} 資料失敗:`,t)}}async function Dn(e){try{return await(await Lo()).get("user-stock-data",e)||null}catch(t){return console.error(`讀取股票 ${e} 快取資料失敗:`,t),null}}async function Zn(e,t=!1){if(!t){const a=await Dn(e);if(a&&!Pa(a.lastUpdated))return console.log(`使用快取資料: ${e}`),{...a,data:a.daily}}const n=await Ma(e);if(n)return await Na(n),n;const o=await Dn(e);return o?(console.warn(`API 失敗，使用舊快取資料: ${e}`),o):null}async function Fa(e,t=5,n=!1){if(!e||e.length===0)return[];console.log(`開始批量抓取 ${e.length} 支股票資料，併發數: ${t}`);const o=[],a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));for(const r of a){const i=r.map(l=>Zn(l,n));(await Promise.allSettled(i)).forEach((l,u)=>{l.status==="fulfilled"&&l.value?o.push(l.value):console.error(`股票 ${r[u]} 抓取失敗:`,l.reason)}),a.indexOf(r)<a.length-1&&await new Promise(l=>setTimeout(l,100))}return console.log(`批量抓取完成，成功: ${o.length}/${e.length}`),o}async function xn(e,t){const n=await Zn(e);if(!n||!n.data)return console.warn(`股票 ${e} 無價格資料`),null;const o=n.data;let a=null,r=0,i=0;if(Array.isArray(o)&&o.length>0){const l=o[o.length-1];if(a=l.close||l.price||l[4],o.length>1){const u=o[o.length-2],d=u.close||u.price||u[4];r=a-d,i=r/d*100}}else typeof o=="object"&&(a=o.price||o.close||o.last,r=o.change||0,i=o.changePercent||0);return{...t,price:a||0,change:Number(r.toFixed(2)),changePercent:Number(i.toFixed(2)),lastUpdated:n.lastUpdated,weeklyKD:Math.floor(Math.random()*100),rsi:Math.floor(Math.random()*100)}}Ho().catch(console.error);const Jn=Wo("stock",()=>{const e=G([]);async function t(){try{console.log("開始載入使用者股票清單...");const c=await jn("user-stock-info");return console.log("從 IndexedDB 載入的股票:",c),c&&c.length>0&&(e.value=c,await u()),e.value}catch(c){return console.error("載入使用者股票清單失敗:",c),e.value}}async function n(c){if(console.log("開始新增股票:",c),e.value.find(D=>D.id===c.id))return console.log("股票已存在，取消新增"),{success:!1,message:"股票已存在於清單中"};const g={id:c.id,name:c.name,industryCategory:Array.isArray(c.industryCategory)?Array.from(c.industryCategory):c.industryCategory?[c.industryCategory]:[],type:c.type,addedAt:new Date().toISOString()},p={...c,addedAt:g.addedAt,price:0,change:0,changePercent:0,weeklyKD:0,rsi:0};console.log("新增股票到 Pinia store:",p),e.value.push(p);try{return console.log("準備儲存股票到 user-stock-info:",g),await ft("user-stock-info",g),console.log("股票已成功儲存到 user-stock-info"),d(c.id).catch(D=>{console.error(`背景更新股票 ${c.id} 價格失敗:`,D)}),{success:!0,message:"股票已新增至清單"}}catch(D){return console.error("儲存股票失敗:",D),e.value=e.value.filter(v=>v.id!==c.id),{success:!1,message:"新增失敗，請稍後再試"}}}async function o(c){try{return await jo("user-stock-info",c),e.value=e.value.filter(h=>h.id!==c),{success:!0,message:"股票已從清單中移除"}}catch(h){return console.error("移除股票失敗:",h),{success:!1,message:"移除失敗，請稍後再試"}}}function a(c){return e.value.some(h=>h.id===c)}async function r(c){e.value=c,await i()}async function i(){try{await zo("user-stock-info");for(const c of e.value){const h={id:c.id,name:c.name,industryCategory:Array.isArray(c.industryCategory)?Array.from(c.industryCategory):c.industryCategory?[c.industryCategory]:[],type:c.type,addedAt:c.addedAt};await ft("user-stock-info",h)}}catch(c){console.error("儲存股票排序失敗:",c)}}async function s(c){const h=await pn("all-stocks",c);h&&(e.value.find(p=>p.id===h.id)||e.value.push(h))}async function l(c){const h=e.value.find(g=>g.id===c);h&&await ft("all-stocks",h)}async function u(){if(e.value.length===0){console.log("無股票需要更新價格");return}console.log(`開始批量更新 ${e.value.length} 支股票價格...`);try{const c=e.value.map(g=>g.id||g.code);(await Promise.all(e.value.map(async g=>{try{return await xn(g.id||g.code,g)}catch(p){return console.error(`更新股票 ${g.id} 價格失敗:`,p),null}}))).forEach((g,p)=>{if(g){const D=e.value[p];e.value[p]={...D,price:g.price,change:g.change,changePercent:g.changePercent,weeklyKD:g.weeklyKD,rsi:g.rsi,lastUpdated:g.lastUpdated}}}),await i(),console.log("所有股票價格更新完成")}catch(c){console.error("批量更新股票價格失敗:",c)}}async function d(c){const h=e.value.findIndex(g=>g.id===c);if(h===-1){console.warn(`找不到股票 ${c}`);return}console.log(`開始更新股票 ${c} 價格...`);try{const g=e.value[h],p=await xn(c,g);if(p){e.value[h]={...g,price:p.price,change:p.change,changePercent:p.changePercent,weeklyKD:p.weeklyKD,rsi:p.rsi,lastUpdated:p.lastUpdated};let D=null,v=null;try{const C=await pn("user-stock-data",c);if(C&&Array.isArray(C.daily)&&C.daily.length>0){const S=C.daily[C.daily.length-1];Array.isArray(S)?(D=S[0],v=S[1]):typeof S=="object"&&(D=S.date||S.Date||S.日期||null,v=S.value||S.close||S.price||null)}}catch(C){console.warn("取得 user-stock-data 最後一筆失敗",C)}const $={id:g.id,name:g.name,industryCategory:Array.isArray(g.industryCategory)?Array.from(g.industryCategory):g.industryCategory?[g.industryCategory]:[],type:g.type,addedAt:g.addedAt,lastDate:D,lastValue:v};console.log("[user-stock-info] set",$),await ft("user-stock-info",$),console.log(`股票 ${c} 價格更新完成`)}}catch(g){console.error(`更新股票 ${c} 價格失敗:`,g)}}async function f(){if(console.log("手動重新整理所有股票價格..."),e.value.length===0)return console.log("無股票需要重新整理"),{success:!0,message:"無股票需要更新"};try{const c=e.value.map(h=>h.id||h.code);return await Fa(c,3,!0),await u(),{success:!0,message:`已更新 ${e.value.length} 支股票價格`}}catch(c){return console.error("手動重新整理股票價格失敗:",c),{success:!1,message:"重新整理失敗，請稍後再試"}}}return{userStocks:e,loadUserStocks:t,addStock:n,removeStock:o,isStockAdded:a,reorderStocks:r,loadStock:s,saveStock:l,updateAllStockPrices:u,updateSingleStockPrice:d,refreshAllStockPrices:f}}),Ba={style:{display:"flex","flex-direction":"column",height:"100%","min-height":"60vh"}},Ra={style:{flex:"1 1 auto"}},Ya={style:{display:"flex",gap:"8px","flex-wrap":"wrap","justify-content":"center","margin-bottom":"24px"}},Ha=["onClick"],La={key:0,style:{"margin-top":"12px"}},Wa={key:0},ja={style:{"font-size":"17px","font-weight":"bold",color:"#222","margin-right":"16px","min-width":"60px"}},za={style:{"font-size":"16px",color:"#333",flex:"1"}},Va={key:1,style:{color:"#999","text-align":"center","margin-top":"16px"}},Ua={__name:"StockSearch",setup(e){const t=Jn(),n=Un("stock-search"),o=G(!1);Ye(()=>{n.on(p=>{o.value=p})}),Vo(()=>{n.reset()});const a=G(),r=G(""),i=G([]),s=["台積電","鴻海","聯發科","長榮","中鋼"],l={background:"#fff",color:"#878787",borderRadius:"16px",padding:"4px 16px",fontSize:"15px",cursor:"pointer",userSelect:"none",fontWeight:"500",transition:"background 0.2s, color 0.2s"},u={background:"#ffe066",color:"#222",fontWeight:"bold",boxShadow:"0 0 0 2px #ffe06688"};function d(p){return r.value===p?{...l,...u}:l}function f(){Se(()=>{const p=a.value?.$el?.querySelector("input");p&&p.focus()})}De(()=>o.value,p=>{p&&setTimeout(()=>{f()},300)}),De(()=>r.value,async p=>{if(console.log("localSearch 更新:",p),!p||p.length<1){i.value=[];return}console.log("觸發 getStocksFromDB");try{const D=await $a();console.log("getStocksFromDB 執行成功"),i.value=D.filter(v=>v.name.includes(p)||v.id.includes(p)),console.log("搜尋結果:",i.value)}catch(D){console.error("getStocksFromDB 執行失敗:",D)}});function c(p){}function h(p){console.log("點擊熱門標籤:",p),r.value=p}async function g(p){const D=await t.addStock(p);je({message:D.message,type:D.success?"success":"fail"})}return(p,D)=>(me(),Uo(ne(Da),{show:o.value,"onUpdate:show":D[1]||(D[1]=v=>ne(n).emit(!1)),"cancel-text":"離開",options:[],style:{"--van-share-sheet-header-padding":"24px 24px 0 24px"}},{title:ce(()=>D[2]||(D[2]=[j("div",{style:{"font-size":"18px","font-weight":"bold","letter-spacing":"1px","text-align":"center","margin-top":"0","margin-bottom":"0",color:"#222","line-height":"1.2"}}," 股票搜尋 ",-1)])),description:ce(()=>[j("div",Ba,[j("div",Ra,[j("div",null,[B(ne(Qo),{ref_key:"searchInputRef",ref:a,modelValue:r.value,"onUpdate:modelValue":D[0]||(D[0]=v=>r.value=v),placeholder:"請輸入股票名稱或代碼","action-text":"",style:{"--van-search-input-height":"48px","font-size":"18px"},onSearch:c},null,8,["modelValue"])]),j("div",null,[D[3]||(D[3]=j("div",{style:{display:"flex","align-items":"center",margin:"0 0 10px 0"}},[j("div",{style:{"margin-left":"16px","font-size":"16px",color:"#222","font-weight":"bold","letter-spacing":"1px"}}," | 熱門股票 ")],-1)),j("div",Ya,[(me(),we(mn,null,vn(s,v=>j("span",{key:v,onClick:$=>h(v),style:Xn(d(v))},fe(v),13,Ha)),64))]),r.value&&r.value.length>=1?(me(),we("div",La,[i.value.length?(me(),we("div",Wa,[(me(!0),we(mn,null,vn(i.value,v=>(me(),we("div",{key:v.id,style:{background:"#fff","border-radius":"12px","box-shadow":"0 2px 8px #0001",padding:"16px 20px","margin-bottom":"12px",display:"flex","align-items":"center","min-height":"56px"}},[j("div",ja,fe(v.id),1),j("div",za,fe(v.name),1),B(ne(St),{type:ne(t).isStockAdded(v.id)?"default":"primary",size:"small",disabled:ne(t).isStockAdded(v.id),onClick:$=>g(v),style:{"margin-left":"12px","min-width":"60px"}},{default:ce(()=>[Kt(fe(ne(t).isStockAdded(v.id)?"已新增":"新增"),1)]),_:2},1032,["type","disabled","onClick"])]))),128))])):(me(),we("div",Va," 查無資料 "))])):Xo("",!0)])])])]),_:1},8,["show"]))}},Xa={key:0,class:"chart-placeholder"},qa={__name:"KChart",props:{width:{type:Number,default:200},height:{type:Number,default:100},stockData:{type:Object,required:!0},stockIndex:{type:Number,default:0}},setup(e){const t=e;Ye(()=>{Se(()=>{})});const n=G(null),o=G(null),a=G(!1),r=G(null),{stop:i}=qo(n,([{isIntersecting:f}])=>{f&&!a.value&&(console.log(`股票 ${t.stockData.name} 的圖表進入視窗，開始渲染...`),a.value=!0,Se(()=>{s()}))},{threshold:.1,rootMargin:"50px"});function s(){if(o.value)try{console.log(`正在為股票 ${t.stockData.name} 創建 K 線圖...`);const f=o.value.getContext("2d"),c=l();u(f,c),console.log(`股票 ${t.stockData.name} 的 K 線圖創建成功`)}catch(f){console.error(`創建股票 ${t.stockData.name} 的圖表時發生錯誤:`,f),d()}}function l(){const c=[],h=30+t.stockIndex*2,g=8+t.stockIndex%3*2;let p=h;for(let D=0;D<6;D++){const v=p,$=(Math.random()-.5)*g,C=v+$,S=Math.max(v,C)+Math.random()*(g*.3),y=Math.min(v,C)-Math.random()*(g*.3);c.push({open:v,high:S,low:y,close:C}),p=C}return c}function u(f,c){const h=o.value,g=h.clientWidth,p=h.clientHeight;h.width=g,h.height=p,f.clearRect(0,0,g,p);const D=10,v=g-D*2,$=p-D*2,C=c.flatMap(P=>[P.open,P.high,P.low,P.close]),S=Math.min(...C),y=Math.max(...C),F=y-S,W=v/c.length,A=W*.6;c.forEach((P,H)=>{const k=D+(H+.5)*W,K=P.close>P.open,ee=K?"#ef5350":"#26a69a",T=D+(y-P.high)/F*$,_=D+(y-P.low)/F*$,m=D+(y-P.open)/F*$,E=D+(y-P.close)/F*$,w=Math.min(m,E),M=Math.max(m,E),N=Math.max(M-w,1);f.strokeStyle=ee,f.lineWidth=1,f.beginPath(),f.moveTo(k,T),f.lineTo(k,_),f.stroke(),f.fillStyle=K?ee:"#fff",f.strokeStyle=ee,f.lineWidth=1,f.fillRect(k-A/2,w,A,N),f.strokeRect(k-A/2,w,A,N)})}function d(){n.value&&(n.value.innerHTML=`
                <div style="
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    height: 100%;
                    background: #f0f0f0;
                    color: #666;
                    font-size: 12px;
                    border-radius: 6px;
                ">
                    圖表暫不可用
                </div>
            `)}return De(()=>t.stockData,()=>{a.value&&Se(()=>{s()})},{deep:!0}),Yn(()=>{i(),r.value=null}),(f,c)=>(me(),we("div",{ref_key:"chartContainer",ref:n,class:"mini-k-chart",style:{width:"100%",height:"100%"}},[a.value?(me(),we("canvas",{key:1,ref_key:"chartCanvas",ref:o,style:{width:"100%",height:"100%"}},null,512)):(me(),we("div",Xa,c[0]||(c[0]=[j("div",{class:"placeholder-content"},"圖表載入中...",-1)])))],512))}},Ga=sn(qa,[["__scopeId","data-v-1755c118"]]),Ka={class:"stock-name"},Za={class:"stock-name-main"},Ja={class:"stock-name-left"},Qa={class:"name highlight"},er={class:"code"},tr={class:"stock-name-right"},nr={class:"stock-progress-bar"},or={class:"progress-text"},ar={__name:"StockName",props:{name:String,code:String,price:[String,Number],change:[String,Number],changePercent:[String,Number],priceClass:String,progress:Number,progressText:String},setup(e){return(t,n)=>(me(),we("div",Ka,[j("div",Za,[j("div",Ja,[j("div",Qa,fe(e.name),1),j("div",er,fe(e.code),1),n[0]||(n[0]=j("div",{class:"star-area"},[j("span",{class:"star"},"★")],-1))]),j("div",tr,[j("div",{class:Zt(["price",e.priceClass])},fe(e.price),3),j("div",{class:Zt(["change",e.priceClass])},fe(e.change>0?"+":"")+fe(e.change)+" ("+fe(e.changePercent)+"%) ",3)])]),j("div",nr,[j("div",{class:"stock-progress-inner",style:Xn({width:(e.progress||0)+"%"})},[j("span",or,fe(e.progressText||(e.progress||0)+"%"),1)],4)])]))}},rr=sn(ar,[["__scopeId","data-v-c759bb7e"]]);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function En(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,o)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?En(Object(n),!0).forEach(function(o){ir(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Dt(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Dt=function(t){return typeof t}:Dt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(e)}function ir(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Te(){return Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Te.apply(this,arguments)}function sr(e,t){if(e==null)return{};var n={},o=Object.keys(e),a,r;for(r=0;r<o.length;r++)a=o[r],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function lr(e,t){if(e==null)return{};var n=sr(e,t),o,a;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)o=r[a],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var cr="1.14.0";function Ce(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var $e=Ce(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),lt=Ce(/Edge/i),Cn=Ce(/firefox/i),nt=Ce(/safari/i)&&!Ce(/chrome/i)&&!Ce(/android/i),Qn=Ce(/iP(ad|od|hone)/i),ur=Ce(/chrome/i)&&Ce(/android/i),eo={capture:!1,passive:!1};function V(e,t,n){e.addEventListener(t,n,!$e&&eo)}function z(e,t,n){e.removeEventListener(t,n,!$e&&eo)}function $t(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function dr(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function _e(e,t,n,o){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&$t(e,t):$t(e,t))||o&&e===n)return e;if(e===n)break}while(e=dr(e))}return null}var Tn=/\s+/g;function ue(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(Tn," ").replace(" "+t+" "," ");e.className=(o+(n?" "+t:"")).replace(Tn," ")}}function I(e,t,n){var o=e&&e.style;if(o){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in o)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),o[t]=n+(typeof n=="string"?"":"px")}}function Ue(e,t){var n="";if(typeof e=="string")n=e;else do{var o=I(e,"transform");o&&o!=="none"&&(n=o+" "+n)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(n)}function to(e,t,n){if(e){var o=e.getElementsByTagName(t),a=0,r=o.length;if(n)for(;a<r;a++)n(o[a],a);return o}return[]}function xe(){var e=document.scrollingElement;return e||document.documentElement}function te(e,t,n,o,a){if(!(!e.getBoundingClientRect&&e!==window)){var r,i,s,l,u,d,f;if(e!==window&&e.parentNode&&e!==xe()?(r=e.getBoundingClientRect(),i=r.top,s=r.left,l=r.bottom,u=r.right,d=r.height,f=r.width):(i=0,s=0,l=window.innerHeight,u=window.innerWidth,d=window.innerHeight,f=window.innerWidth),(t||n)&&e!==window&&(a=a||e.parentNode,!$e))do if(a&&a.getBoundingClientRect&&(I(a,"transform")!=="none"||n&&I(a,"position")!=="static")){var c=a.getBoundingClientRect();i-=c.top+parseInt(I(a,"border-top-width")),s-=c.left+parseInt(I(a,"border-left-width")),l=i+r.height,u=s+r.width;break}while(a=a.parentNode);if(o&&e!==window){var h=Ue(a||e),g=h&&h.a,p=h&&h.d;h&&(i/=p,s/=g,f/=g,d/=p,l=i+d,u=s+f)}return{top:i,left:s,bottom:l,right:u,width:f,height:d}}}function $n(e,t,n){for(var o=Oe(e,!0),a=te(e)[t];o;){var r=te(o)[n],i=void 0;if(i=a>=r,!i)return o;if(o===xe())break;o=Oe(o,!1)}return!1}function Xe(e,t,n,o){for(var a=0,r=0,i=e.children;r<i.length;){if(i[r].style.display!=="none"&&i[r]!==O.ghost&&(o||i[r]!==O.dragged)&&_e(i[r],n.draggable,e,!1)){if(a===t)return i[r];a++}r++}return null}function ln(e,t){for(var n=e.lastElementChild;n&&(n===O.ghost||I(n,"display")==="none"||t&&!$t(n,t));)n=n.previousElementSibling;return n||null}function pe(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==O.clone&&(!t||$t(e,t))&&n++;return n}function kn(e){var t=0,n=0,o=xe();if(e)do{var a=Ue(e),r=a.a,i=a.d;t+=e.scrollLeft*r,n+=e.scrollTop*i}while(e!==o&&(e=e.parentNode));return[t,n]}function fr(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[n][o])return Number(n)}return-1}function Oe(e,t){if(!e||!e.getBoundingClientRect)return xe();var n=e,o=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var a=I(n);if(n.clientWidth<n.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return xe();if(o||t)return n;o=!0}}while(n=n.parentNode);return xe()}function hr(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Rt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var ot;function no(e,t){return function(){if(!ot){var n=arguments,o=this;n.length===1?e.call(o,n[0]):e.apply(o,n),ot=setTimeout(function(){ot=void 0},t)}}}function gr(){clearTimeout(ot),ot=void 0}function oo(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function ao(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var he="Sortable"+new Date().getTime();function pr(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(a){if(!(I(a,"display")==="none"||a===O.ghost)){e.push({target:a,rect:te(a)});var r=Ee({},e[e.length-1].rect);if(a.thisAnimationDuration){var i=Ue(a,!0);i&&(r.top-=i.f,r.left-=i.e)}a.fromRect=r}})}},addAnimationState:function(o){e.push(o)},removeAnimationState:function(o){e.splice(fr(e,{target:o}),1)},animateAll:function(o){var a=this;if(!this.options.animation){clearTimeout(t),typeof o=="function"&&o();return}var r=!1,i=0;e.forEach(function(s){var l=0,u=s.target,d=u.fromRect,f=te(u),c=u.prevFromRect,h=u.prevToRect,g=s.rect,p=Ue(u,!0);p&&(f.top-=p.f,f.left-=p.e),u.toRect=f,u.thisAnimationDuration&&Rt(c,f)&&!Rt(d,f)&&(g.top-f.top)/(g.left-f.left)===(d.top-f.top)/(d.left-f.left)&&(l=vr(g,c,h,a.options)),Rt(f,d)||(u.prevFromRect=d,u.prevToRect=f,l||(l=a.options.animation),a.animate(u,g,f,l)),l&&(r=!0,i=Math.max(i,l),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},l),u.thisAnimationDuration=l)}),clearTimeout(t),r?t=setTimeout(function(){typeof o=="function"&&o()},i):typeof o=="function"&&o(),e=[]},animate:function(o,a,r,i){if(i){I(o,"transition",""),I(o,"transform","");var s=Ue(this.el),l=s&&s.a,u=s&&s.d,d=(a.left-r.left)/(l||1),f=(a.top-r.top)/(u||1);o.animatingX=!!d,o.animatingY=!!f,I(o,"transform","translate3d("+d+"px,"+f+"px,0)"),this.forRepaintDummy=mr(o),I(o,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),I(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){I(o,"transition",""),I(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},i)}}}}function mr(e){return e.offsetWidth}function vr(e,t,n,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*o.animation}var Le=[],Yt={initializeByDefault:!0},ct={mount:function(t){for(var n in Yt)Yt.hasOwnProperty(n)&&!(n in t)&&(t[n]=Yt[n]);Le.forEach(function(o){if(o.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Le.push(t)},pluginEvent:function(t,n,o){var a=this;this.eventCanceled=!1,o.cancel=function(){a.eventCanceled=!0};var r=t+"Global";Le.forEach(function(i){n[i.pluginName]&&(n[i.pluginName][r]&&n[i.pluginName][r](Ee({sortable:n},o)),n.options[i.pluginName]&&n[i.pluginName][t]&&n[i.pluginName][t](Ee({sortable:n},o)))})},initializePlugins:function(t,n,o,a){Le.forEach(function(s){var l=s.pluginName;if(!(!t.options[l]&&!s.initializeByDefault)){var u=new s(t,n,t.options);u.sortable=t,u.options=t.options,t[l]=u,Te(o,u.defaults)}});for(var r in t.options)if(t.options.hasOwnProperty(r)){var i=this.modifyOption(t,r,t.options[r]);typeof i<"u"&&(t.options[r]=i)}},getEventProperties:function(t,n){var o={};return Le.forEach(function(a){typeof a.eventProperties=="function"&&Te(o,a.eventProperties.call(n[a.pluginName],t))}),o},modifyOption:function(t,n,o){var a;return Le.forEach(function(r){t[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[n]=="function"&&(a=r.optionListeners[n].call(t[r.pluginName],o))}),a}};function yr(e){var t=e.sortable,n=e.rootEl,o=e.name,a=e.targetEl,r=e.cloneEl,i=e.toEl,s=e.fromEl,l=e.oldIndex,u=e.newIndex,d=e.oldDraggableIndex,f=e.newDraggableIndex,c=e.originalEvent,h=e.putSortable,g=e.extraEventProperties;if(t=t||n&&n[he],!!t){var p,D=t.options,v="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!$e&&!lt?p=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(p=document.createEvent("Event"),p.initEvent(o,!0,!0)),p.to=i||n,p.from=s||n,p.item=a||n,p.clone=r,p.oldIndex=l,p.newIndex=u,p.oldDraggableIndex=d,p.newDraggableIndex=f,p.originalEvent=c,p.pullMode=h?h.lastPutMode:void 0;var $=Ee(Ee({},g),ct.getEventProperties(o,t));for(var C in $)p[C]=$[C];n&&n.dispatchEvent(p),D[v]&&D[v].call(t,p)}}var br=["evt"],le=function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.evt,r=lr(o,br);ct.pluginEvent.bind(O)(t,n,Ee({dragEl:b,parentEl:Z,ghostEl:Y,rootEl:q,nextEl:Fe,lastDownEl:xt,cloneEl:J,cloneHidden:Ie,dragStarted:Qe,putSortable:ae,activeSortable:O.active,originalEvent:a,oldIndex:Ve,oldDraggableIndex:at,newIndex:de,newDraggableIndex:Ae,hideGhostForTarget:lo,unhideGhostForTarget:co,cloneNowHidden:function(){Ie=!0},cloneNowShown:function(){Ie=!1},dispatchSortableEvent:function(s){ie({sortable:n,name:s,originalEvent:a})}},r))};function ie(e){yr(Ee({putSortable:ae,cloneEl:J,targetEl:b,rootEl:q,oldIndex:Ve,oldDraggableIndex:at,newIndex:de,newDraggableIndex:Ae},e))}var b,Z,Y,q,Fe,xt,J,Ie,Ve,de,at,Ae,gt,ae,ze=!1,kt=!1,At=[],Me,be,Ht,Lt,An,In,Qe,We,rt,it=!1,pt=!1,Et,re,Wt=[],Qt=!1,It=[],Ft=typeof document<"u",mt=Qn,On=lt||$e?"cssFloat":"float",wr=Ft&&!ur&&!Qn&&"draggable"in document.createElement("div"),ro=function(){if(Ft){if($e)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),io=function(t,n){var o=I(t),a=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),r=Xe(t,0,n),i=Xe(t,1,n),s=r&&I(r),l=i&&I(i),u=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+te(r).width,d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+te(i).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return i&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return r&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||u>=a&&o[On]==="none"||i&&o[On]==="none"&&u+d>a)?"vertical":"horizontal"},Sr=function(t,n,o){var a=o?t.left:t.top,r=o?t.right:t.bottom,i=o?t.width:t.height,s=o?n.left:n.top,l=o?n.right:n.bottom,u=o?n.width:n.height;return a===s||r===l||a+i/2===s+u/2},_r=function(t,n){var o;return At.some(function(a){var r=a[he].options.emptyInsertThreshold;if(!(!r||ln(a))){var i=te(a),s=t>=i.left-r&&t<=i.right+r,l=n>=i.top-r&&n<=i.bottom+r;if(s&&l)return o=a}}),o},so=function(t){function n(r,i){return function(s,l,u,d){var f=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(r==null&&(i||f))return!0;if(r==null||r===!1)return!1;if(i&&r==="clone")return r;if(typeof r=="function")return n(r(s,l,u,d),i)(s,l,u,d);var c=(i?s:l).options.group.name;return r===!0||typeof r=="string"&&r===c||r.join&&r.indexOf(c)>-1}}var o={},a=t.group;(!a||Dt(a)!="object")&&(a={name:a}),o.name=a.name,o.checkPull=n(a.pull,!0),o.checkPut=n(a.put),o.revertClone=a.revertClone,t.group=o},lo=function(){!ro&&Y&&I(Y,"display","none")},co=function(){!ro&&Y&&I(Y,"display","")};Ft&&document.addEventListener("click",function(e){if(kt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),kt=!1,!1},!0);var Ne=function(t){if(b){t=t.touches?t.touches[0]:t;var n=_r(t.clientX,t.clientY);if(n){var o={};for(var a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);o.target=o.rootEl=n,o.preventDefault=void 0,o.stopPropagation=void 0,n[he]._onDragOver(o)}}},Dr=function(t){b&&b.parentNode[he]._isOutsideThisEl(t.target)};function O(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Te({},t),e[he]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return io(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(i,s){i.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:O.supportPointer!==!1&&"PointerEvent"in window&&!nt,emptyInsertThreshold:5};ct.initializePlugins(this,e,n);for(var o in n)!(o in t)&&(t[o]=n[o]);so(t);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=t.forceFallback?!1:wr,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?V(e,"pointerdown",this._onTapStart):(V(e,"mousedown",this._onTapStart),V(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(V(e,"dragover",this),V(e,"dragenter",this)),At.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Te(this,pr())}O.prototype={constructor:O,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(We=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,b):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,o=this.el,a=this.options,r=a.preventOnFilter,i=t.type,s=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(s||t).target,u=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,d=a.filter;if(Ir(o),!b&&!(/mousedown|pointerdown/.test(i)&&t.button!==0||a.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&nt&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=_e(l,a.draggable,o,!1),!(l&&l.animated)&&xt!==l)){if(Ve=pe(l),at=pe(l,a.draggable),typeof d=="function"){if(d.call(this,t,l,this)){ie({sortable:n,rootEl:u,name:"filter",targetEl:l,toEl:o,fromEl:o}),le("filter",n,{evt:t}),r&&t.cancelable&&t.preventDefault();return}}else if(d&&(d=d.split(",").some(function(f){if(f=_e(u,f.trim(),o,!1),f)return ie({sortable:n,rootEl:f,name:"filter",targetEl:l,fromEl:o,toEl:o}),le("filter",n,{evt:t}),!0}),d)){r&&t.cancelable&&t.preventDefault();return}a.handle&&!_e(u,a.handle,o,!1)||this._prepareDragStart(t,s,l)}}},_prepareDragStart:function(t,n,o){var a=this,r=a.el,i=a.options,s=r.ownerDocument,l;if(o&&!b&&o.parentNode===r){var u=te(o);if(q=r,b=o,Z=b.parentNode,Fe=b.nextSibling,xt=o,gt=i.group,O.dragged=b,Me={target:b,clientX:(n||t).clientX,clientY:(n||t).clientY},An=Me.clientX-u.left,In=Me.clientY-u.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,b.style["will-change"]="all",l=function(){if(le("delayEnded",a,{evt:t}),O.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Cn&&a.nativeDraggable&&(b.draggable=!0),a._triggerDragStart(t,n),ie({sortable:a,name:"choose",originalEvent:t}),ue(b,i.chosenClass,!0)},i.ignore.split(",").forEach(function(d){to(b,d.trim(),jt)}),V(s,"dragover",Ne),V(s,"mousemove",Ne),V(s,"touchmove",Ne),V(s,"mouseup",a._onDrop),V(s,"touchend",a._onDrop),V(s,"touchcancel",a._onDrop),Cn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,b.draggable=!0),le("delayStart",this,{evt:t}),i.delay&&(!i.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(lt||$e))){if(O.eventCanceled){this._onDrop();return}V(s,"mouseup",a._disableDelayedDrag),V(s,"touchend",a._disableDelayedDrag),V(s,"touchcancel",a._disableDelayedDrag),V(s,"mousemove",a._delayedDragTouchMoveHandler),V(s,"touchmove",a._delayedDragTouchMoveHandler),i.supportPointer&&V(s,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(l,i.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){b&&jt(b),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;z(t,"mouseup",this._disableDelayedDrag),z(t,"touchend",this._disableDelayedDrag),z(t,"touchcancel",this._disableDelayedDrag),z(t,"mousemove",this._delayedDragTouchMoveHandler),z(t,"touchmove",this._delayedDragTouchMoveHandler),z(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?V(document,"pointermove",this._onTouchMove):n?V(document,"touchmove",this._onTouchMove):V(document,"mousemove",this._onTouchMove):(V(b,"dragend",this),V(q,"dragstart",this._onDragStart));try{document.selection?Ct(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(ze=!1,q&&b){le("dragStarted",this,{evt:n}),this.nativeDraggable&&V(document,"dragover",Dr);var o=this.options;!t&&ue(b,o.dragClass,!1),ue(b,o.ghostClass,!0),O.active=this,t&&this._appendGhost(),ie({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(be){this._lastX=be.clientX,this._lastY=be.clientY,lo();for(var t=document.elementFromPoint(be.clientX,be.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(be.clientX,be.clientY),t!==n);)n=t;if(b.parentNode[he]._isOutsideThisEl(t),n)do{if(n[he]){var o=void 0;if(o=n[he]._onDragOver({clientX:be.clientX,clientY:be.clientY,target:t,rootEl:n}),o&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);co()}},_onTouchMove:function(t){if(Me){var n=this.options,o=n.fallbackTolerance,a=n.fallbackOffset,r=t.touches?t.touches[0]:t,i=Y&&Ue(Y,!0),s=Y&&i&&i.a,l=Y&&i&&i.d,u=mt&&re&&kn(re),d=(r.clientX-Me.clientX+a.x)/(s||1)+(u?u[0]-Wt[0]:0)/(s||1),f=(r.clientY-Me.clientY+a.y)/(l||1)+(u?u[1]-Wt[1]:0)/(l||1);if(!O.active&&!ze){if(o&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<o)return;this._onDragStart(t,!0)}if(Y){i?(i.e+=d-(Ht||0),i.f+=f-(Lt||0)):i={a:1,b:0,c:0,d:1,e:d,f};var c="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");I(Y,"webkitTransform",c),I(Y,"mozTransform",c),I(Y,"msTransform",c),I(Y,"transform",c),Ht=d,Lt=f,be=r}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!Y){var t=this.options.fallbackOnBody?document.body:q,n=te(b,!0,mt,!0,t),o=this.options;if(mt){for(re=t;I(re,"position")==="static"&&I(re,"transform")==="none"&&re!==document;)re=re.parentNode;re!==document.body&&re!==document.documentElement?(re===document&&(re=xe()),n.top+=re.scrollTop,n.left+=re.scrollLeft):re=xe(),Wt=kn(re)}Y=b.cloneNode(!0),ue(Y,o.ghostClass,!1),ue(Y,o.fallbackClass,!0),ue(Y,o.dragClass,!0),I(Y,"transition",""),I(Y,"transform",""),I(Y,"box-sizing","border-box"),I(Y,"margin",0),I(Y,"top",n.top),I(Y,"left",n.left),I(Y,"width",n.width),I(Y,"height",n.height),I(Y,"opacity","0.8"),I(Y,"position",mt?"absolute":"fixed"),I(Y,"zIndex","100000"),I(Y,"pointerEvents","none"),O.ghost=Y,t.appendChild(Y),I(Y,"transform-origin",An/parseInt(Y.style.width)*100+"% "+In/parseInt(Y.style.height)*100+"%")}},_onDragStart:function(t,n){var o=this,a=t.dataTransfer,r=o.options;if(le("dragStart",this,{evt:t}),O.eventCanceled){this._onDrop();return}le("setupClone",this),O.eventCanceled||(J=ao(b),J.draggable=!1,J.style["will-change"]="",this._hideClone(),ue(J,this.options.chosenClass,!1),O.clone=J),o.cloneId=Ct(function(){le("clone",o),!O.eventCanceled&&(o.options.removeCloneOnHide||q.insertBefore(J,b),o._hideClone(),ie({sortable:o,name:"clone"}))}),!n&&ue(b,r.dragClass,!0),n?(kt=!0,o._loopId=setInterval(o._emulateDragOver,50)):(z(document,"mouseup",o._onDrop),z(document,"touchend",o._onDrop),z(document,"touchcancel",o._onDrop),a&&(a.effectAllowed="move",r.setData&&r.setData.call(o,a,b)),V(document,"drop",o),I(b,"transform","translateZ(0)")),ze=!0,o._dragStartId=Ct(o._dragStarted.bind(o,n,t)),V(document,"selectstart",o),Qe=!0,nt&&I(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,o=t.target,a,r,i,s=this.options,l=s.group,u=O.active,d=gt===l,f=s.sort,c=ae||u,h,g=this,p=!1;if(Qt)return;function D(w,M){le(w,g,Ee({evt:t,isOwner:d,axis:h?"vertical":"horizontal",revert:i,dragRect:a,targetRect:r,canSort:f,fromSortable:c,target:o,completed:$,onMove:function(x,R){return vt(q,n,b,a,x,te(x),t,R)},changed:C},M))}function v(){D("dragOverAnimationCapture"),g.captureAnimationState(),g!==c&&c.captureAnimationState()}function $(w){return D("dragOverCompleted",{insertion:w}),w&&(d?u._hideClone():u._showClone(g),g!==c&&(ue(b,ae?ae.options.ghostClass:u.options.ghostClass,!1),ue(b,s.ghostClass,!0)),ae!==g&&g!==O.active?ae=g:g===O.active&&ae&&(ae=null),c===g&&(g._ignoreWhileAnimating=o),g.animateAll(function(){D("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==c&&(c.animateAll(),c._ignoreWhileAnimating=null)),(o===b&&!b.animated||o===n&&!o.animated)&&(We=null),!s.dragoverBubble&&!t.rootEl&&o!==document&&(b.parentNode[he]._isOutsideThisEl(t.target),!w&&Ne(t)),!s.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),p=!0}function C(){de=pe(b),Ae=pe(b,s.draggable),ie({sortable:g,name:"change",toEl:n,newIndex:de,newDraggableIndex:Ae,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),o=_e(o,s.draggable,n,!0),D("dragOver"),O.eventCanceled)return p;if(b.contains(t.target)||o.animated&&o.animatingX&&o.animatingY||g._ignoreWhileAnimating===o)return $(!1);if(kt=!1,u&&!s.disabled&&(d?f||(i=Z!==q):ae===this||(this.lastPutMode=gt.checkPull(this,u,b,t))&&l.checkPut(this,u,b,t))){if(h=this._getDirection(t,o)==="vertical",a=te(b),D("dragOverValid"),O.eventCanceled)return p;if(i)return Z=q,v(),this._hideClone(),D("revert"),O.eventCanceled||(Fe?q.insertBefore(b,Fe):q.appendChild(b)),$(!0);var S=ln(n,s.draggable);if(!S||Tr(t,h,this)&&!S.animated){if(S===b)return $(!1);if(S&&n===t.target&&(o=S),o&&(r=te(o)),vt(q,n,b,a,o,r,t,!!o)!==!1)return v(),n.appendChild(b),Z=n,C(),$(!0)}else if(S&&Cr(t,h,this)){var y=Xe(n,0,s,!0);if(y===b)return $(!1);if(o=y,r=te(o),vt(q,n,b,a,o,r,t,!1)!==!1)return v(),n.insertBefore(b,y),Z=n,C(),$(!0)}else if(o.parentNode===n){r=te(o);var F=0,W,A=b.parentNode!==n,P=!Sr(b.animated&&b.toRect||a,o.animated&&o.toRect||r,h),H=h?"top":"left",k=$n(o,"top","top")||$n(b,"top","top"),K=k?k.scrollTop:void 0;We!==o&&(W=r[H],it=!1,pt=!P&&s.invertSwap||A),F=$r(t,o,r,h,P?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,pt,We===o);var ee;if(F!==0){var T=pe(b);do T-=F,ee=Z.children[T];while(ee&&(I(ee,"display")==="none"||ee===Y))}if(F===0||ee===o)return $(!1);We=o,rt=F;var _=o.nextElementSibling,m=!1;m=F===1;var E=vt(q,n,b,a,o,r,t,m);if(E!==!1)return(E===1||E===-1)&&(m=E===1),Qt=!0,setTimeout(Er,30),v(),m&&!_?n.appendChild(b):o.parentNode.insertBefore(b,m?_:o),k&&oo(k,0,K-k.scrollTop),Z=b.parentNode,W!==void 0&&!pt&&(Et=Math.abs(W-te(o)[H])),C(),$(!0)}if(n.contains(b))return $(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){z(document,"mousemove",this._onTouchMove),z(document,"touchmove",this._onTouchMove),z(document,"pointermove",this._onTouchMove),z(document,"dragover",Ne),z(document,"mousemove",Ne),z(document,"touchmove",Ne)},_offUpEvents:function(){var t=this.el.ownerDocument;z(t,"mouseup",this._onDrop),z(t,"touchend",this._onDrop),z(t,"pointerup",this._onDrop),z(t,"touchcancel",this._onDrop),z(document,"selectstart",this)},_onDrop:function(t){var n=this.el,o=this.options;if(de=pe(b),Ae=pe(b,o.draggable),le("drop",this,{evt:t}),Z=b&&b.parentNode,de=pe(b),Ae=pe(b,o.draggable),O.eventCanceled){this._nulling();return}ze=!1,pt=!1,it=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),en(this.cloneId),en(this._dragStartId),this.nativeDraggable&&(z(document,"drop",this),z(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),nt&&I(document.body,"user-select",""),I(b,"transform",""),t&&(Qe&&(t.cancelable&&t.preventDefault(),!o.dropBubble&&t.stopPropagation()),Y&&Y.parentNode&&Y.parentNode.removeChild(Y),(q===Z||ae&&ae.lastPutMode!=="clone")&&J&&J.parentNode&&J.parentNode.removeChild(J),b&&(this.nativeDraggable&&z(b,"dragend",this),jt(b),b.style["will-change"]="",Qe&&!ze&&ue(b,ae?ae.options.ghostClass:this.options.ghostClass,!1),ue(b,this.options.chosenClass,!1),ie({sortable:this,name:"unchoose",toEl:Z,newIndex:null,newDraggableIndex:null,originalEvent:t}),q!==Z?(de>=0&&(ie({rootEl:Z,name:"add",toEl:Z,fromEl:q,originalEvent:t}),ie({sortable:this,name:"remove",toEl:Z,originalEvent:t}),ie({rootEl:Z,name:"sort",toEl:Z,fromEl:q,originalEvent:t}),ie({sortable:this,name:"sort",toEl:Z,originalEvent:t})),ae&&ae.save()):de!==Ve&&de>=0&&(ie({sortable:this,name:"update",toEl:Z,originalEvent:t}),ie({sortable:this,name:"sort",toEl:Z,originalEvent:t})),O.active&&((de==null||de===-1)&&(de=Ve,Ae=at),ie({sortable:this,name:"end",toEl:Z,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){le("nulling",this),q=b=Z=Y=Fe=J=xt=Ie=Me=be=Qe=de=Ae=Ve=at=We=rt=ae=gt=O.dragged=O.ghost=O.clone=O.active=null,It.forEach(function(t){t.checked=!0}),It.length=Ht=Lt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":b&&(this._onDragOver(t),xr(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,o=this.el.children,a=0,r=o.length,i=this.options;a<r;a++)n=o[a],_e(n,i.draggable,this.el,!1)&&t.push(n.getAttribute(i.dataIdAttr)||Ar(n));return t},sort:function(t,n){var o={},a=this.el;this.toArray().forEach(function(r,i){var s=a.children[i];_e(s,this.options.draggable,a,!1)&&(o[r]=s)},this),n&&this.captureAnimationState(),t.forEach(function(r){o[r]&&(a.removeChild(o[r]),a.appendChild(o[r]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return _e(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var o=this.options;if(n===void 0)return o[t];var a=ct.modifyOption(this,t,n);typeof a<"u"?o[t]=a:o[t]=n,t==="group"&&so(o)},destroy:function(){le("destroy",this);var t=this.el;t[he]=null,z(t,"mousedown",this._onTapStart),z(t,"touchstart",this._onTapStart),z(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(z(t,"dragover",this),z(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),At.splice(At.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!Ie){if(le("hideClone",this),O.eventCanceled)return;I(J,"display","none"),this.options.removeCloneOnHide&&J.parentNode&&J.parentNode.removeChild(J),Ie=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(Ie){if(le("showClone",this),O.eventCanceled)return;b.parentNode==q&&!this.options.group.revertClone?q.insertBefore(J,b):Fe?q.insertBefore(J,Fe):q.appendChild(J),this.options.group.revertClone&&this.animate(b,J),I(J,"display",""),Ie=!1}}};function xr(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function vt(e,t,n,o,a,r,i,s){var l,u=e[he],d=u.options.onMove,f;return window.CustomEvent&&!$e&&!lt?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=e,l.dragged=n,l.draggedRect=o,l.related=a||t,l.relatedRect=r||te(t),l.willInsertAfter=s,l.originalEvent=i,e.dispatchEvent(l),d&&(f=d.call(u,l,i)),f}function jt(e){e.draggable=!1}function Er(){Qt=!1}function Cr(e,t,n){var o=te(Xe(n.el,0,n.options,!0)),a=10;return t?e.clientX<o.left-a||e.clientY<o.top&&e.clientX<o.right:e.clientY<o.top-a||e.clientY<o.bottom&&e.clientX<o.left}function Tr(e,t,n){var o=te(ln(n.el,n.options.draggable)),a=10;return t?e.clientX>o.right+a||e.clientX<=o.right&&e.clientY>o.bottom&&e.clientX>=o.left:e.clientX>o.right&&e.clientY>o.top||e.clientX<=o.right&&e.clientY>o.bottom+a}function $r(e,t,n,o,a,r,i,s){var l=o?e.clientY:e.clientX,u=o?n.height:n.width,d=o?n.top:n.left,f=o?n.bottom:n.right,c=!1;if(!i){if(s&&Et<u*a){if(!it&&(rt===1?l>d+u*r/2:l<f-u*r/2)&&(it=!0),it)c=!0;else if(rt===1?l<d+Et:l>f-Et)return-rt}else if(l>d+u*(1-a)/2&&l<f-u*(1-a)/2)return kr(t)}return c=c||i,c&&(l<d+u*r/2||l>f-u*r/2)?l>d+u/2?1:-1:0}function kr(e){return pe(b)<pe(e)?1:-1}function Ar(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,o=0;n--;)o+=t.charCodeAt(n);return o.toString(36)}function Ir(e){It.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var o=t[n];o.checked&&It.push(o)}}function Ct(e){return setTimeout(e,0)}function en(e){return clearTimeout(e)}Ft&&V(document,"touchmove",function(e){(O.active||ze)&&e.cancelable&&e.preventDefault()});O.utils={on:V,off:z,css:I,find:to,is:function(t,n){return!!_e(t,n,t,!1)},extend:hr,throttle:no,closest:_e,toggleClass:ue,clone:ao,index:pe,nextTick:Ct,cancelNextTick:en,detectDirection:io,getChild:Xe};O.get=function(e){return e[he]};O.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(O.utils=Ee(Ee({},O.utils),o.utils)),ct.mount(o)})};O.create=function(e,t){return new O(e,t)};O.version=cr;var Q=[],et,tn,nn=!1,zt,Vt,Ot,tt;function Or(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var o=n.originalEvent;this.sortable.nativeDraggable?V(document,"dragover",this._handleAutoScroll):this.options.supportPointer?V(document,"pointermove",this._handleFallbackAutoScroll):o.touches?V(document,"touchmove",this._handleFallbackAutoScroll):V(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var o=n.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?z(document,"dragover",this._handleAutoScroll):(z(document,"pointermove",this._handleFallbackAutoScroll),z(document,"touchmove",this._handleFallbackAutoScroll),z(document,"mousemove",this._handleFallbackAutoScroll)),Pn(),Tt(),gr()},nulling:function(){Ot=tn=et=nn=tt=zt=Vt=null,Q.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,o){var a=this,r=(n.touches?n.touches[0]:n).clientX,i=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(r,i);if(Ot=n,o||this.options.forceAutoScrollFallback||lt||$e||nt){Ut(n,this.options,s,o);var l=Oe(s,!0);nn&&(!tt||r!==zt||i!==Vt)&&(tt&&Pn(),tt=setInterval(function(){var u=Oe(document.elementFromPoint(r,i),!0);u!==l&&(l=u,Tt()),Ut(n,a.options,u,o)},10),zt=r,Vt=i)}else{if(!this.options.bubbleScroll||Oe(s,!0)===xe()){Tt();return}Ut(n,this.options,Oe(s,!1),!1)}}},Te(e,{pluginName:"scroll",initializeByDefault:!0})}function Tt(){Q.forEach(function(e){clearInterval(e.pid)}),Q=[]}function Pn(){clearInterval(tt)}var Ut=no(function(e,t,n,o){if(t.scroll){var a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,i=t.scrollSensitivity,s=t.scrollSpeed,l=xe(),u=!1,d;tn!==n&&(tn=n,Tt(),et=t.scroll,d=t.scrollFn,et===!0&&(et=Oe(n,!0)));var f=0,c=et;do{var h=c,g=te(h),p=g.top,D=g.bottom,v=g.left,$=g.right,C=g.width,S=g.height,y=void 0,F=void 0,W=h.scrollWidth,A=h.scrollHeight,P=I(h),H=h.scrollLeft,k=h.scrollTop;h===l?(y=C<W&&(P.overflowX==="auto"||P.overflowX==="scroll"||P.overflowX==="visible"),F=S<A&&(P.overflowY==="auto"||P.overflowY==="scroll"||P.overflowY==="visible")):(y=C<W&&(P.overflowX==="auto"||P.overflowX==="scroll"),F=S<A&&(P.overflowY==="auto"||P.overflowY==="scroll"));var K=y&&(Math.abs($-a)<=i&&H+C<W)-(Math.abs(v-a)<=i&&!!H),ee=F&&(Math.abs(D-r)<=i&&k+S<A)-(Math.abs(p-r)<=i&&!!k);if(!Q[f])for(var T=0;T<=f;T++)Q[T]||(Q[T]={});(Q[f].vx!=K||Q[f].vy!=ee||Q[f].el!==h)&&(Q[f].el=h,Q[f].vx=K,Q[f].vy=ee,clearInterval(Q[f].pid),(K!=0||ee!=0)&&(u=!0,Q[f].pid=setInterval((function(){o&&this.layer===0&&O.active._onTouchMove(Ot);var _=Q[this.layer].vy?Q[this.layer].vy*s:0,m=Q[this.layer].vx?Q[this.layer].vx*s:0;typeof d=="function"&&d.call(O.dragged.parentNode[he],m,_,e,Ot,Q[this.layer].el)!=="continue"||oo(Q[this.layer].el,m,_)}).bind({layer:f}),24))),f++}while(t.bubbleScroll&&c!==l&&(c=Oe(c,!1)));nn=u}},30),uo=function(t){var n=t.originalEvent,o=t.putSortable,a=t.dragEl,r=t.activeSortable,i=t.dispatchSortableEvent,s=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(n){var u=o||r;s();var d=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,f=document.elementFromPoint(d.clientX,d.clientY);l(),u&&!u.el.contains(f)&&(i("spill"),this.onSpill({dragEl:a,putSortable:o}))}};function cn(){}cn.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,o=t.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var a=Xe(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(n,a):this.sortable.el.appendChild(n),this.sortable.animateAll(),o&&o.animateAll()},drop:uo};Te(cn,{pluginName:"revertOnSpill"});function un(){}un.prototype={onSpill:function(t){var n=t.dragEl,o=t.putSortable,a=o||this.sortable;a.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),a.animateAll()},drop:uo};Te(un,{pluginName:"removeOnSpill"});O.mount(new Or);O.mount(un,cn);function Xt(e){e.parentElement!==null&&e.parentElement.removeChild(e)}function Mn(e,t,n){const o=n===0?e.children[0]:e.children[n-1].nextSibling;e.insertBefore(t,o)}function Pr(){return typeof window<"u"?window.console:global.console}const Mr=Pr();function Nr(e){const t=Object.create(null);return function(o){return t[o]||(t[o]=e(o))}}const Fr=/-(\w)/g,Br=Nr(e=>e.replace(Fr,(t,n)=>n.toUpperCase())),fo=["Start","Add","Remove","Update","End"],ho=["Choose","Unchoose","Sort","Filter","Clone"],go=["Move"],Rr=[go,fo,ho].flatMap(e=>e).map(e=>`on${e}`),on={manage:go,manageAndEmit:fo,emit:ho};function Yr(e){return Rr.indexOf(e)!==-1}const Hr=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function Lr(e){return Hr.includes(e)}function Wr(e){return["transition-group","TransitionGroup"].includes(e)}function po(e){return["id","class","role","style"].includes(e)||e.startsWith("data-")||e.startsWith("aria-")||e.startsWith("on")}function mo(e){return e.reduce((t,[n,o])=>(t[n]=o,t),{})}function jr({$attrs:e,componentData:t={}}){return{...mo(Object.entries(e).filter(([o,a])=>po(o))),...t}}function zr({$attrs:e,callBackBuilder:t}){const n=mo(vo(e));Object.entries(t).forEach(([a,r])=>{on[a].forEach(i=>{n[`on${i}`]=r(i)})});const o=`[data-draggable]${n.draggable||""}`;return{...n,draggable:o}}function vo(e){return Object.entries(e).filter(([t,n])=>!po(t)).map(([t,n])=>[Br(t),n]).filter(([t,n])=>!Yr(t))}const Nn=({el:e})=>e,Vr=(e,t)=>e.__draggable_context=t,Fn=e=>e.__draggable_context;class Ur{constructor({nodes:{header:t,default:n,footer:o},root:a,realList:r}){this.defaultNodes=n,this.children=[...t,...n,...o],this.externalComponent=a.externalComponent,this.rootTransition=a.transition,this.tag=a.tag,this.realList=r}get _isRootComponent(){return this.externalComponent||this.rootTransition}render(t,n){const{tag:o,children:a,_isRootComponent:r}=this;return t(o,n,r?{default:()=>a}:a)}updated(){const{defaultNodes:t,realList:n}=this;t.forEach((o,a)=>{Vr(Nn(o),{element:n[a],index:a})})}getUnderlyingVm(t){return Fn(t)}getVmIndexFromDomIndex(t,n){const{defaultNodes:o}=this,{length:a}=o,r=n.children,i=r.item(t);if(i===null)return a;const s=Fn(i);if(s)return s.index;if(a===0)return 0;const l=Nn(o[0]),u=[...r].findIndex(d=>d===l);return t<u?0:a}}function Xr(e,t){const n=e[t];return n?n():[]}function qr({$slots:e,realList:t,getKey:n}){const o=t||[],[a,r]=["header","footer"].map(l=>Xr(e,l)),{item:i}=e;if(!i)throw new Error("draggable element must have an item slot");const s=o.flatMap((l,u)=>i({element:l,index:u}).map(d=>(d.key=n(l),d.props={...d.props||{},"data-draggable":!0},d)));if(s.length!==o.length)throw new Error("Item slot must have only one child");return{header:a,footer:r,default:s}}function Gr(e){const t=Wr(e),n=!Lr(e)&&!t;return{transition:t,externalComponent:n,tag:n?Go(e):t?Ko:e}}function Kr({$slots:e,tag:t,realList:n,getKey:o}){const a=qr({$slots:e,realList:n,getKey:o}),r=Gr(t);return new Ur({nodes:a,root:r,realList:n})}function yo(e,t){Se(()=>this.$emit(e.toLowerCase(),t))}function bo(e){return(t,n)=>{if(this.realList!==null)return this[`onDrag${e}`](t,n)}}function Zr(e){const t=bo.call(this,e);return(n,o)=>{t.call(this,n,o),yo.call(this,e,n)}}let qt=null;const Jr={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:e=>e},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Qr=["update:modelValue","change",...[...on.manageAndEmit,...on.emit].map(e=>e.toLowerCase())],ei=He({name:"draggable",inheritAttrs:!1,props:Jr,emits:Qr,data(){return{error:!1}},render(){try{this.error=!1;const{$slots:e,$attrs:t,tag:n,componentData:o,realList:a,getKey:r}=this,i=Kr({$slots:e,tag:n,realList:a,getKey:r});this.componentStructure=i;const s=jr({$attrs:t,componentData:o});return i.render(yn,s)}catch(e){return this.error=!0,yn("pre",{style:{color:"red"}},e.stack)}},created(){this.list!==null&&this.modelValue!==null&&Mr.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted(){if(this.error)return;const{$attrs:e,$el:t,componentStructure:n}=this;n.updated();const o=zr({$attrs:e,callBackBuilder:{manageAndEmit:r=>Zr.call(this,r),emit:r=>yo.bind(this,r),manage:r=>bo.call(this,r)}}),a=t.nodeType===1?t:t.parentElement;this._sortable=new O(a,o),this.targetDomElement=a,a.__draggable_component__=this},updated(){this.componentStructure.updated()},beforeUnmount(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList(){const{list:e}=this;return e||this.modelValue},getKey(){const{itemKey:e}=this;return typeof e=="function"?e:t=>t[e]}},watch:{$attrs:{handler(e){const{_sortable:t}=this;t&&vo(e).forEach(([n,o])=>{t.option(n,o)})},deep:!0}},methods:{getUnderlyingVm(e){return this.componentStructure.getUnderlyingVm(e)||null},getUnderlyingPotencialDraggableComponent(e){return e.__draggable_component__},emitChanges(e){Se(()=>this.$emit("change",e))},alterList(e){if(this.list){e(this.list);return}const t=[...this.modelValue];e(t),this.$emit("update:modelValue",t)},spliceList(){const e=t=>t.splice(...arguments);this.alterList(e)},updatePosition(e,t){const n=o=>o.splice(t,0,o.splice(e,1)[0]);this.alterList(n)},getRelatedContextFromMoveEvent({to:e,related:t}){const n=this.getUnderlyingPotencialDraggableComponent(e);if(!n)return{component:n};const o=n.realList,a={list:o,component:n};return e!==t&&o?{...n.getUnderlyingVm(t)||{},...a}:a},getVmIndexFromDomIndex(e){return this.componentStructure.getVmIndexFromDomIndex(e,this.targetDomElement)},onDragStart(e){this.context=this.getUnderlyingVm(e.item),e.item._underlying_vm_=this.clone(this.context.element),qt=e.item},onDragAdd(e){const t=e.item._underlying_vm_;if(t===void 0)return;Xt(e.item);const n=this.getVmIndexFromDomIndex(e.newIndex);this.spliceList(n,0,t);const o={element:t,newIndex:n};this.emitChanges({added:o})},onDragRemove(e){if(Mn(this.$el,e.item,e.oldIndex),e.pullMode==="clone"){Xt(e.clone);return}const{index:t,element:n}=this.context;this.spliceList(t,1);const o={element:n,oldIndex:t};this.emitChanges({removed:o})},onDragUpdate(e){Xt(e.item),Mn(e.from,e.item,e.oldIndex);const t=this.context.index,n=this.getVmIndexFromDomIndex(e.newIndex);this.updatePosition(t,n);const o={element:this.context.element,oldIndex:t,newIndex:n};this.emitChanges({moved:o})},computeFutureIndex(e,t){if(!e.element)return 0;const n=[...t.to.children].filter(i=>i.style.display!=="none"),o=n.indexOf(t.related),a=e.component.getVmIndexFromDomIndex(o);return n.indexOf(qt)!==-1||!t.willInsertAfter?a:a+1},onDragMove(e,t){const{move:n,realList:o}=this;if(!n||!o)return!0;const a=this.getRelatedContextFromMoveEvent(e),r=this.computeFutureIndex(a,e),i={...this.context,futureIndex:r},s={...e,relatedContext:a,draggedContext:i};return n(s,t)},onDragEnd(){qt=null}}}),ti={class:"stock-page"},ni={class:"action-buttons"},oi={class:"stock-content"},ai={class:"stock-indicator"},ri={class:"kd-indicator"},ii={class:"rsi-indicator"},si={class:"rsi-value"},li={class:"bubble-content",style:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}},ci={__name:"Stock",setup(e){const t=Jn(),n=Un("stock-search");G(null),G(null),G(0);const o=G(!1);Ye(async()=>{try{t.loadUserStocks()}catch(v){console.error("初始化資料庫失敗:",v)}});const a=oe({get(){return t.userStocks},set(v){t.reorderStocks(v)}});function r(){n.emit(!0)}async function i(){o.value=!0;try{const v=await t.refreshAllStockPrices();je(v.message)}catch(v){console.error("重新整理失敗:",v),je("重新整理失敗")}finally{o.value=!1}}function s(v,$){console.log(`Stock ${$} indicator changed to ${v}`)}function l(v){return v>0?"price-up":v<0?"price-down":"price-flat"}function u(v){return v>70?"rsi-overbought":v<30?"rsi-oversold":"rsi-normal"}function d(v){return v>70?"超買":v<30?"超賣":"正常"}function f(){}function c(v){je(`買賣 ${v.name}`)}function h(v){je(`${v.name} 策略設定`)}function g(v){je(`${v.name} 其他功能`)}function p(v){console.log("開始拖曳",v)}function D(v){console.log("拖曳結束",v)}return Zo(document,"visibilitychange",()=>{document.visibilityState==="visible"&&t.loadUserStocks()}),Ye(()=>{}),(v,$)=>(me(),we("div",ti,[B(ne(pa),{modelValue:o.value,"onUpdate:modelValue":$[2]||($[2]=C=>o.value=C),onRefresh:i,"pulling-text":"下拉重新整理股票價格","loosing-text":"釋放立即更新","loading-text":"正在更新股票價格..."},{default:ce(()=>[B(ne(ei),{modelValue:a.value,"onUpdate:modelValue":$[1]||($[1]=C=>a.value=C),"item-key":"id",delay:200,animation:200,"ghost-class":"stock-row-ghost",onStart:p,onEnd:D},{item:ce(({element:C,index:S})=>[j("div",{class:"stock-row",onContextmenu:$[0]||($[0]=Jo(()=>{},["prevent"]))},[B(ne(Ta),{"left-width":200,onClickLeft:f},{left:ce(()=>[j("div",ni,[B(ne(St),{type:"primary",size:"small",class:"action-btn buy-btn",onClick:y=>c(C)},{default:ce(()=>$[3]||($[3]=[j("div",null,"交 易",-1),j("div",null,"記 錄",-1)])),_:2,__:[3]},1032,["onClick"]),B(ne(St),{type:"warning",size:"small",class:"action-btn strategy-btn",onClick:y=>h(C)},{default:ce(()=>$[4]||($[4]=[Kt(" 策 略 ",-1)])),_:2,__:[4]},1032,["onClick"]),B(ne(St),{type:"default",size:"small",class:"action-btn other-btn",onClick:y=>g(C)},{default:ce(()=>$[5]||($[5]=[Kt(" 更 多 ",-1)])),_:2,__:[5]},1032,["onClick"])])]),default:ce(()=>[j("div",oi,[B(rr,{name:C.name,code:C.code,price:C.price,change:C.change,"change-percent":C.changePercent,"price-class":l(C.change),progress:C.progress,"progress-text":C.progressText},null,8,["name","code","price","change","change-percent","price-class","progress","progress-text"]),j("div",ai,[B(ne(na),{"show-indicators":!1,loop:!1,autoplay:0,onChange:y=>s(y,S)},{default:ce(()=>[B(ne(wn),{class:"indicator-content"},{default:ce(()=>[j("div",ri,[B(Ga,{width:120,height:60,"stock-data":C,"stock-index":S},null,8,["stock-data","stock-index"])])]),_:2},1024),B(ne(wn),{class:"indicator-content"},{default:ce(()=>[j("div",ii,[j("div",si,fe(C.rsi),1),j("div",{class:Zt(["rsi-trend",u(C.rsi)])},fe(d(C.rsi)),3)])]),_:2},1024)]),_:2},1032,["onChange"])])])]),_:2},1024)],32)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),B(ne(ca),{axis:"xy",magnetic:"x",gap:{x:20,y:80},style:{"--van-floating-bubble-size":"56px","--van-floating-bubble-background":"rgba(255, 224, 102, 0.9)","--van-floating-bubble-icon-size":"22px","--van-floating-bubble-color":"#322b0d"},onClick:r},{default:ce(()=>[j("div",li,[B(ne(Wn),{name:"plus",size:"22",color:"#322b0d",style:{"margin-bottom":"2px"}}),$[6]||($[6]=j("span",{class:"bubble-label",style:{color:"#322b0d","font-size":"14px"}},"新增",-1))])]),_:1}),B(Ua)]))}},fi=sn(ci,[["__scopeId","data-v-32c08f71"]]);export{fi as default};
