import{d as Xe,t as Be,m as gt,n as Ct,c as nt,r as J,a as en,u as tn,b as yo,e as ne,f as nn,w as Ee,g as bo,o as Re,h as Nn,i as wo,j as Fn,k as Bn,l as on,p as H,q as cn,s as _e,v as pt,x as st,y as mt,z as vt,A as Rn,B as ot,C as So,D as _o,E as un,F as dn,G as Do,H as xo,I as Eo,J as Yn,T as Co,K as Ln,L as Xt,M as ko,N as To,P as $o,O as Io,Q as Oo,R as Ao,S as Hn,U as fn,V as Po,W as Mo,X as Wn,Y as jn,Z as zn,_ as No,$ as Fo,a0 as Bo,a1 as lt,a2 as Ro,a3 as Yo,a4 as hn,a5 as Xn,a6 as Lo,a7 as Ho,a8 as me,a9 as de,aa as j,ab as re,ac as we,ad as Wo,ae as gn,af as pn,ag as Un,ah as fe,ai as Ut,aj as yt,ak as rn,al as jo,am as Vt,an as zo,ao as Xo,ap as mn,aq as Uo,ar as Vo}from"./index-V79FvH6B.js";import{S as qo,B as bt}from"./index-e3pb5bmo.js";function vn(e,t){return e.reduce((n,o)=>Math.abs(n-t)<Math.abs(o-t)?n:o)}const[Vn,ct]=nt("swipe"),Go={loop:Be,width:Ct,height:Ct,vertical:Boolean,autoplay:gt(0),duration:gt(500),touchable:Be,lazyRender:Boolean,initialSwipe:gt(0),indicatorColor:String,showIndicators:Be,stopPropagation:Be},qn=Symbol(Vn);var Ko=Xe({name:Vn,props:Go,emits:["change","dragStart","dragEnd"],setup(e,{emit:t,slots:n}){const o=J(),r=J(),a=en({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let i=!1;const c=tn(),{children:s,linkChildren:u}=yo(qn),d=ne(()=>s.length),f=ne(()=>a[e.vertical?"height":"width"]),l=ne(()=>e.vertical?c.deltaY.value:c.deltaX.value),g=ne(()=>a.rect?(e.vertical?a.rect.height:a.rect.width)-f.value*d.value:0),p=ne(()=>f.value?Math.ceil(Math.abs(g.value)/f.value):d.value),h=ne(()=>d.value*f.value),v=ne(()=>(a.active+d.value)%d.value),_=ne(()=>{const S=e.vertical?"vertical":"horizontal";return c.direction.value===S}),F=ne(()=>{const S={transitionDuration:`${a.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${+a.offset.toFixed(2)}px)`};if(f.value){const P=e.vertical?"height":"width",R=e.vertical?"width":"height";S[P]=`${h.value}px`,S[R]=e[R]?`${e[R]}px`:""}return S}),M=S=>{const{active:P}=a;return S?e.loop?pt(P+S,-1,d.value):pt(P+S,0,p.value):P},Y=(S,P=0)=>{let R=S*f.value;e.loop||(R=Math.min(R,-g.value));let U=P-R;return e.loop||(U=pt(U,g.value,0)),U},x=({pace:S=0,offset:P=0,emitChange:R})=>{if(d.value<=1)return;const{active:U}=a,V=M(S),ge=Y(V,P);if(e.loop){if(s[0]&&ge!==g.value){const ve=ge<g.value;s[0].setOffset(ve?h.value:0)}if(s[d.value-1]&&ge!==0){const ve=ge>0;s[d.value-1].setOffset(ve?-h.value:0)}}a.active=V,a.offset=ge,R&&V!==U&&t("change",v.value)},L=()=>{a.swiping=!0,a.active<=-1?x({pace:d.value}):a.active>=d.value&&x({pace:-d.value})},W=()=>{L(),c.reset(),st(()=>{a.swiping=!1,x({pace:-1,emitChange:!0})})},k=()=>{L(),c.reset(),st(()=>{a.swiping=!1,x({pace:1,emitChange:!0})})};let I;const B=()=>clearTimeout(I),C=()=>{B(),+e.autoplay>0&&d.value>1&&(I=setTimeout(()=>{k(),C()},+e.autoplay))},G=(S=+e.initialSwipe)=>{if(!o.value)return;const P=()=>{var R,U;if(!cn(o)){const V={width:o.value.offsetWidth,height:o.value.offsetHeight};a.rect=V,a.width=+((R=e.width)!=null?R:V.width),a.height=+((U=e.height)!=null?U:V.height)}d.value&&(S=Math.min(d.value-1,S),S===-1&&(S=d.value-1)),a.active=S,a.swiping=!0,a.offset=Y(S),s.forEach(V=>{V.setOffset(0)}),C()};cn(o)?_e().then(P):P()},ee=()=>G(a.active);let E;const w=S=>{!e.touchable||S.touches.length>1||(c.start(S),i=!1,E=Date.now(),B(),L())},m=S=>{e.touchable&&a.swiping&&(c.move(S),_.value&&(!e.loop&&(a.active===0&&l.value>0||a.active===d.value-1&&l.value<0)||(Rn(S,e.stopPropagation),x({offset:l.value}),i||(t("dragStart",{index:v.value}),i=!0))))},D=()=>{if(!e.touchable||!a.swiping)return;const S=Date.now()-E,P=l.value/S;if((Math.abs(P)>.25||Math.abs(l.value)>f.value/2)&&_.value){const U=e.vertical?c.offsetY.value:c.offsetX.value;let V=0;e.loop?V=U>0?l.value>0?-1:1:0:V=-Math[l.value>0?"ceil":"floor"](l.value/f.value),x({pace:V,emitChange:!0})}else l.value&&x({pace:0});i=!1,a.swiping=!1,t("dragEnd",{index:v.value}),C()},b=(S,P={})=>{L(),c.reset(),st(()=>{let R;e.loop&&S===d.value?R=a.active===0?0:S:R=S%d.value,P.immediate?st(()=>{a.swiping=!1}):a.swiping=!1,x({pace:R-a.active,emitChange:!0})})},O=(S,P)=>{const R=P===v.value,U=R?{backgroundColor:e.indicatorColor}:void 0;return H("i",{style:U,class:ct("indicator",{active:R})},null)},A=()=>{if(n.indicator)return n.indicator({active:v.value,total:d.value});if(e.showIndicators&&d.value>1)return H("div",{class:ct("indicators",{vertical:e.vertical})},[Array(d.value).fill("").map(O)])};return nn({prev:W,next:k,state:a,resize:ee,swipeTo:b}),u({size:f,props:e,count:d,activeIndicator:v}),Ee(()=>e.initialSwipe,S=>G(+S)),Ee(d,()=>G(a.active)),Ee(()=>e.autoplay,C),Ee([mt,vt,()=>e.width,()=>e.height],ee),Ee(bo(),S=>{S==="visible"?C():B()}),Re(G),Nn(()=>G(a.active)),wo(()=>G(a.active)),Fn(B),Bn(B),on("touchmove",m,{target:r}),()=>{var S;return H("div",{ref:o,class:ct()},[H("div",{ref:r,style:F.value,class:ct("track",{vertical:e.vertical}),onTouchstartPassive:w,onTouchend:D,onTouchcancel:D},[(S=n.default)==null?void 0:S.call(n)]),A()])}}});const Zo=ot(Ko),[Jo,Qo]=nt("swipe-item");var er=Xe({name:Jo,setup(e,{slots:t}){let n;const o=en({offset:0,inited:!1,mounted:!1}),{parent:r,index:a}=So(qn);if(!r)return;const i=ne(()=>{const u={},{vertical:d}=r.props;return r.size.value&&(u[d?"height":"width"]=`${r.size.value}px`),o.offset&&(u.transform=`translate${d?"Y":"X"}(${o.offset}px)`),u}),c=ne(()=>{const{loop:u,lazyRender:d}=r.props;if(!d||n)return!0;if(!o.mounted)return!1;const f=r.activeIndicator.value,l=r.count.value-1,g=f===0&&u?l:f-1,p=f===l&&u?0:f+1;return n=a.value===f||a.value===g||a.value===p,n}),s=u=>{o.offset=u};return Re(()=>{_e(()=>{o.mounted=!0})}),nn({setOffset:s}),()=>{var u;return H("div",{class:Qo(),style:i.value},[c.value?(u=t.default)==null?void 0:u.call(t):null])}}});const yn=ot(er),tr={gap:{type:[Number,Object],default:24},icon:String,axis:_o("y"),magnetic:String,offset:Object,teleport:{type:[String,Object],default:"body"}},[nr,bn]=nt("floating-bubble");var or=Xe({name:nr,inheritAttrs:!1,props:tr,emits:["click","update:offset","offsetChange"],setup(e,{slots:t,emit:n,attrs:o}){const r=J(),a=J({x:0,y:0,width:0,height:0}),i=ne(()=>un(e.gap)?e.gap.x:e.gap),c=ne(()=>un(e.gap)?e.gap.y:e.gap),s=ne(()=>({top:c.value,right:mt.value-a.value.width-i.value,bottom:vt.value-a.value.height-c.value,left:i.value})),u=J(!1);let d=!1;const f=ne(()=>{const x={},L=dn(a.value.x),W=dn(a.value.y);return x.transform=`translate3d(${L}, ${W}, 0)`,(u.value||!d)&&(x.transition="none"),x}),l=()=>{if(!Y.value)return;const{width:x,height:L}=Ln(r.value),{offset:W}=e;a.value={x:W?W.x:mt.value-x-i.value,y:W?W.y:vt.value-L-c.value,width:x,height:L}},g=tn();let p=0,h=0;const v=x=>{g.start(x),u.value=!0,p=a.value.x,h=a.value.y};on("touchmove",x=>{if(x.preventDefault(),g.move(x),e.axis!=="lock"&&!g.isTap.value){if(e.axis==="x"||e.axis==="xy"){let W=p+g.deltaX.value;W<s.value.left&&(W=s.value.left),W>s.value.right&&(W=s.value.right),a.value.x=W}if(e.axis==="y"||e.axis==="xy"){let W=h+g.deltaY.value;W<s.value.top&&(W=s.value.top),W>s.value.bottom&&(W=s.value.bottom),a.value.y=W}const L=Xt(a.value,["x","y"]);n("update:offset",L)}},{target:r});const F=()=>{u.value=!1,_e(()=>{if(e.magnetic==="x"){const x=vn([s.value.left,s.value.right],a.value.x);a.value.x=x}if(e.magnetic==="y"){const x=vn([s.value.top,s.value.bottom],a.value.y);a.value.y=x}if(!g.isTap.value){const x=Xt(a.value,["x","y"]);n("update:offset",x),(p!==x.x||h!==x.y)&&n("offsetChange",x)}})},M=x=>{g.isTap.value?n("click",x):x.stopPropagation()};Re(()=>{l(),_e(()=>{d=!0})}),Ee([mt,vt,i,c,()=>e.offset],l,{deep:!0});const Y=J(!0);return Nn(()=>{Y.value=!0}),Fn(()=>{e.teleport&&(Y.value=!1)}),()=>{const x=Do(H("div",Yn({class:bn(),ref:r,onTouchstartPassive:v,onTouchend:F,onTouchcancel:F,onClickCapture:M,style:f.value},o),[t.default?t.default():H(Eo,{name:e.icon,class:bn("icon")},null)]),[[xo,Y.value]]);return e.teleport?H(Co,{to:e.teleport},{default:()=>[x]}):x}}});const rr=ot(or),ar=e=>e?.includes("/"),ir=[...To,"round","closeOnPopstate","safeAreaInsetBottom"],sr={qq:"qq",link:"link-o",weibo:"weibo",qrcode:"qr",poster:"photo-o",wechat:"wechat","weapp-qrcode":"miniprogram-o","wechat-moments":"wechat-moments"},[lr,ye,cr]=nt("share-sheet"),ur=ko({},Io,{title:String,round:Be,options:Oo(),cancelText:String,description:String,closeOnPopstate:Be,safeAreaInsetBottom:Be});var dr=Xe({name:lr,props:ur,emits:["cancel","select","update:show"],setup(e,{emit:t,slots:n}){const o=l=>t("update:show",l),r=()=>{o(!1),t("cancel")},a=(l,g)=>t("select",l,g),i=()=>{const l=n.title?n.title():e.title,g=n.description?n.description():e.description;if(l||g)return H("div",{class:ye("header")},[l&&H("h2",{class:ye("title")},[l]),g&&H("span",{class:ye("description")},[g])])},c=l=>ar(l)?H("img",{src:l,class:ye("image-icon")},null):H("div",{class:ye("icon",[l])},[H(Hn,{name:sr[l]||l},null)]),s=(l,g)=>{const{name:p,icon:h,className:v,description:_}=l;return H("div",{role:"button",tabindex:0,class:[ye("option"),v,Ao],onClick:()=>a(l,g)},[c(h),p&&H("span",{class:ye("name")},[p]),_&&H("span",{class:ye("option-description")},[_])])},u=(l,g)=>H("div",{class:ye("options",{border:g})},[l.map(s)]),d=()=>{const{options:l}=e;return Array.isArray(l[0])?l.map((g,p)=>u(g,p!==0)):u(l)},f=()=>{var l;const g=(l=e.cancelText)!=null?l:cr("cancel");if(n.cancel||g)return H("button",{type:"button",class:ye("cancel"),onClick:r},[n.cancel?n.cancel():g])};return()=>H($o,Yn({class:ye(),position:"bottom","onUpdate:show":o},Xt(e,ir)),{default:()=>[i(),d(),f()]})}});const fr=ot(dr),[hr,Pt]=nt("swipe-cell"),gr={name:gt(""),disabled:Boolean,leftWidth:Ct,rightWidth:Ct,beforeClose:Function,stopPropagation:Boolean};var pr=Xe({name:hr,props:gr,emits:["open","close","click"],setup(e,{emit:t,slots:n}){let o,r,a,i;const c=J(),s=J(),u=J(),d=en({offset:0,dragging:!1}),f=tn(),l=k=>k.value?Ln(k).width:0,g=ne(()=>fn(e.leftWidth)?+e.leftWidth:l(s)),p=ne(()=>fn(e.rightWidth)?+e.rightWidth:l(u)),h=k=>{d.offset=k==="left"?g.value:-p.value,o||(o=!0,t("open",{name:e.name,position:k}))},v=k=>{d.offset=0,o&&(o=!1,t("close",{name:e.name,position:k}))},_=k=>{const I=Math.abs(d.offset),B=.15,C=o?1-B:B,G=k==="left"?g.value:p.value;G&&I>G*C?h(k):v(k)},F=k=>{e.disabled||(a=d.offset,f.start(k))},M=k=>{if(e.disabled)return;const{deltaX:I}=f;f.move(k),f.isHorizontal()&&(r=!0,d.dragging=!0,(!o||I.value*a<0)&&Rn(k,e.stopPropagation),d.offset=pt(I.value+a,-p.value,g.value))},Y=()=>{d.dragging&&(d.dragging=!1,_(d.offset>0?"left":"right"),setTimeout(()=>{r=!1},0))},x=(k="outside",I)=>{i||(t("click",k),o&&!r&&(i=!0,Mo(e.beforeClose,{args:[{event:I,name:e.name,position:k}],done:()=>{i=!1,v(k)},canceled:()=>i=!1,error:()=>i=!1})))},L=k=>I=>{(r||o)&&I.stopPropagation(),!r&&x(k,I)},W=(k,I)=>{const B=n[k];if(B)return H("div",{ref:I,class:Pt(k),onClick:L(k)},[B()])};return nn({open:h,close:v}),Po(c,k=>x("outside",k),{eventName:"touchstart"}),on("touchmove",M,{target:c}),()=>{var k;const I={transform:`translate3d(${d.offset}px, 0, 0)`,transitionDuration:d.dragging?"0s":".6s"};return H("div",{ref:c,class:Pt(),onClick:L("cell"),onTouchstartPassive:F,onTouchend:Y,onTouchcancel:Y},[H("div",{class:Pt("wrapper"),style:I},[W("left",s),(k=n.default)==null?void 0:k.call(n),W("right",u)])])}}});const mr=ot(pr);async function vr(){console.log("開始執行 getStocksFromDB");const e=await Wn("all-stocks");if(e&&e.length>0)return console.log("從 IndexedDB 獲取的股票資料:",e),e;{console.log("all-stocks store 無資料，開始從 stock_list.json 獲取");const n=(await jn.get("stocks/stock_list.json")).data;for(const o of n)await zn("all-stocks",o);return console.log("股票資料已快取到 IndexedDB:",n),n}}function yr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wt={exports:{}},br=wt.exports,wn;function wr(){return wn||(wn=1,function(e,t){(function(n,o){e.exports=o()})(br,function(){var n=1e3,o=6e4,r=36e5,a="millisecond",i="second",c="minute",s="hour",u="day",d="week",f="month",l="quarter",g="year",p="date",h="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,F={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(E){var w=["th","st","nd","rd"],m=E%100;return"["+E+(w[(m-20)%10]||w[m]||w[0])+"]"}},M=function(E,w,m){var D=String(E);return!D||D.length>=w?E:""+Array(w+1-D.length).join(m)+E},Y={s:M,z:function(E){var w=-E.utcOffset(),m=Math.abs(w),D=Math.floor(m/60),b=m%60;return(w<=0?"+":"-")+M(D,2,"0")+":"+M(b,2,"0")},m:function E(w,m){if(w.date()<m.date())return-E(m,w);var D=12*(m.year()-w.year())+(m.month()-w.month()),b=w.clone().add(D,f),O=m-b<0,A=w.clone().add(D+(O?-1:1),f);return+(-(D+(m-b)/(O?b-A:A-b))||0)},a:function(E){return E<0?Math.ceil(E)||0:Math.floor(E)},p:function(E){return{M:f,y:g,w:d,d:u,D:p,h:s,m:c,s:i,ms:a,Q:l}[E]||String(E||"").toLowerCase().replace(/s$/,"")},u:function(E){return E===void 0}},x="en",L={};L[x]=F;var W="$isDayjsObject",k=function(E){return E instanceof G||!(!E||!E[W])},I=function E(w,m,D){var b;if(!w)return x;if(typeof w=="string"){var O=w.toLowerCase();L[O]&&(b=O),m&&(L[O]=m,b=O);var A=w.split("-");if(!b&&A.length>1)return E(A[0])}else{var S=w.name;L[S]=w,b=S}return!D&&b&&(x=b),b||!D&&x},B=function(E,w){if(k(E))return E.clone();var m=typeof w=="object"?w:{};return m.date=E,m.args=arguments,new G(m)},C=Y;C.l=I,C.i=k,C.w=function(E,w){return B(E,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var G=function(){function E(m){this.$L=I(m.locale,null,!0),this.parse(m),this.$x=this.$x||m.x||{},this[W]=!0}var w=E.prototype;return w.parse=function(m){this.$d=function(D){var b=D.date,O=D.utc;if(b===null)return new Date(NaN);if(C.u(b))return new Date;if(b instanceof Date)return new Date(b);if(typeof b=="string"&&!/Z$/i.test(b)){var A=b.match(v);if(A){var S=A[2]-1||0,P=(A[7]||"0").substring(0,3);return O?new Date(Date.UTC(A[1],S,A[3]||1,A[4]||0,A[5]||0,A[6]||0,P)):new Date(A[1],S,A[3]||1,A[4]||0,A[5]||0,A[6]||0,P)}}return new Date(b)}(m),this.init()},w.init=function(){var m=this.$d;this.$y=m.getFullYear(),this.$M=m.getMonth(),this.$D=m.getDate(),this.$W=m.getDay(),this.$H=m.getHours(),this.$m=m.getMinutes(),this.$s=m.getSeconds(),this.$ms=m.getMilliseconds()},w.$utils=function(){return C},w.isValid=function(){return this.$d.toString()!==h},w.isSame=function(m,D){var b=B(m);return this.startOf(D)<=b&&b<=this.endOf(D)},w.isAfter=function(m,D){return B(m)<this.startOf(D)},w.isBefore=function(m,D){return this.endOf(D)<B(m)},w.$g=function(m,D,b){return C.u(m)?this[D]:this.set(b,m)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(m,D){var b=this,O=!!C.u(D)||D,A=C.p(m),S=function(Pe,se){var $e=C.w(b.$u?Date.UTC(b.$y,se,Pe):new Date(b.$y,se,Pe),b);return O?$e:$e.endOf(u)},P=function(Pe,se){return C.w(b.toDate()[Pe].apply(b.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(se)),b)},R=this.$W,U=this.$M,V=this.$D,ge="set"+(this.$u?"UTC":"");switch(A){case g:return O?S(1,0):S(31,11);case f:return O?S(1,U):S(0,U+1);case d:var ve=this.$locale().weekStart||0,Ue=(R<ve?R+7:R)-ve;return S(O?V-Ue:V+(6-Ue),U);case u:case p:return P(ge+"Hours",0);case s:return P(ge+"Minutes",1);case c:return P(ge+"Seconds",2);case i:return P(ge+"Milliseconds",3);default:return this.clone()}},w.endOf=function(m){return this.startOf(m,!1)},w.$set=function(m,D){var b,O=C.p(m),A="set"+(this.$u?"UTC":""),S=(b={},b[u]=A+"Date",b[p]=A+"Date",b[f]=A+"Month",b[g]=A+"FullYear",b[s]=A+"Hours",b[c]=A+"Minutes",b[i]=A+"Seconds",b[a]=A+"Milliseconds",b)[O],P=O===u?this.$D+(D-this.$W):D;if(O===f||O===g){var R=this.clone().set(p,1);R.$d[S](P),R.init(),this.$d=R.set(p,Math.min(this.$D,R.daysInMonth())).$d}else S&&this.$d[S](P);return this.init(),this},w.set=function(m,D){return this.clone().$set(m,D)},w.get=function(m){return this[C.p(m)]()},w.add=function(m,D){var b,O=this;m=Number(m);var A=C.p(D),S=function(U){var V=B(O);return C.w(V.date(V.date()+Math.round(U*m)),O)};if(A===f)return this.set(f,this.$M+m);if(A===g)return this.set(g,this.$y+m);if(A===u)return S(1);if(A===d)return S(7);var P=(b={},b[c]=o,b[s]=r,b[i]=n,b)[A]||1,R=this.$d.getTime()+m*P;return C.w(R,this)},w.subtract=function(m,D){return this.add(-1*m,D)},w.format=function(m){var D=this,b=this.$locale();if(!this.isValid())return b.invalidDate||h;var O=m||"YYYY-MM-DDTHH:mm:ssZ",A=C.z(this),S=this.$H,P=this.$m,R=this.$M,U=b.weekdays,V=b.months,ge=b.meridiem,ve=function(se,$e,Ve,it){return se&&(se[$e]||se(D,O))||Ve[$e].slice(0,it)},Ue=function(se){return C.s(S%12||12,se,"0")},Pe=ge||function(se,$e,Ve){var it=se<12?"AM":"PM";return Ve?it.toLowerCase():it};return O.replace(_,function(se,$e){return $e||function(Ve){switch(Ve){case"YY":return String(D.$y).slice(-2);case"YYYY":return C.s(D.$y,4,"0");case"M":return R+1;case"MM":return C.s(R+1,2,"0");case"MMM":return ve(b.monthsShort,R,V,3);case"MMMM":return ve(V,R);case"D":return D.$D;case"DD":return C.s(D.$D,2,"0");case"d":return String(D.$W);case"dd":return ve(b.weekdaysMin,D.$W,U,2);case"ddd":return ve(b.weekdaysShort,D.$W,U,3);case"dddd":return U[D.$W];case"H":return String(S);case"HH":return C.s(S,2,"0");case"h":return Ue(1);case"hh":return Ue(2);case"a":return Pe(S,P,!0);case"A":return Pe(S,P,!1);case"m":return String(P);case"mm":return C.s(P,2,"0");case"s":return String(D.$s);case"ss":return C.s(D.$s,2,"0");case"SSS":return C.s(D.$ms,3,"0");case"Z":return A}return null}(se)||A.replace(":","")})},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(m,D,b){var O,A=this,S=C.p(D),P=B(m),R=(P.utcOffset()-this.utcOffset())*o,U=this-P,V=function(){return C.m(A,P)};switch(S){case g:O=V()/12;break;case f:O=V();break;case l:O=V()/3;break;case d:O=(U-R)/6048e5;break;case u:O=(U-R)/864e5;break;case s:O=U/r;break;case c:O=U/o;break;case i:O=U/n;break;default:O=U}return b?O:C.a(O)},w.daysInMonth=function(){return this.endOf(f).$D},w.$locale=function(){return L[this.$L]},w.locale=function(m,D){if(!m)return this.$L;var b=this.clone(),O=I(m,D,!0);return O&&(b.$L=O),b},w.clone=function(){return C.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},E}(),ee=G.prototype;return B.prototype=ee,[["$ms",a],["$s",i],["$m",c],["$H",s],["$W",u],["$M",f],["$y",g],["$D",p]].forEach(function(E){ee[E[1]]=function(w){return this.$g(w,E[0],E[1])}}),B.extend=function(E,w){return E.$i||(E(w,G,B),E.$i=!0),B},B.locale=I,B.isDayjs=k,B.unix=function(E){return B(1e3*E)},B.en=L[x],B.Ls=L,B.p={},B})}(wt)),wt.exports}var Sr=wr();const qt=yr(Sr);function _r(e,t=30){if(!e)return!0;const n=qt(),o=qt(e);return n.diff(o,"minute")>t}async function Dr(e){try{console.log(`開始抓取股票 ${e} 的資料...`);const t=await jn.get(`stocks/${e}/all.json`);if(t.data){const n={stockCode:e,data:t.data,lastUpdated:new Date().toISOString(),fetchedAt:qt().format("YYYY-MM-DD HH:mm:ss")};return console.log(`成功抓取股票 ${e} 資料`),n}return console.warn(`股票 ${e} 無資料回傳`),null}catch(t){return console.error(`抓取股票 ${e} 失敗:`,t),null}}async function xr(e){try{const t={id:e.stockCode,daily:e.data,lastUpdated:e.lastUpdated,fetchedAt:e.fetchedAt};await zn("user-stock-data",t),console.log(`股票 ${e.stockCode} 資料已儲存到 IndexedDB`)}catch(t){console.error(`儲存股票 ${e.stockCode} 資料失敗:`,t)}}async function Sn(e){try{return await(await Fo()).get("user-stock-data",e)||null}catch(t){return console.error(`讀取股票 ${e} 快取資料失敗:`,t),null}}async function Gn(e,t=!1){if(!t){const r=await Sn(e);if(r&&!_r(r.lastUpdated))return console.log(`使用快取資料: ${e}`),{...r,data:r.daily}}const n=await Dr(e);if(n)return await xr(n),n;const o=await Sn(e);return o?(console.warn(`API 失敗，使用舊快取資料: ${e}`),o):null}async function Er(e,t=5,n=!1){if(!e||e.length===0)return[];console.log(`開始批量抓取 ${e.length} 支股票資料，併發數: ${t}`);const o=[],r=[];for(let a=0;a<e.length;a+=t)r.push(e.slice(a,a+t));for(const a of r){const i=a.map(s=>Gn(s,n));(await Promise.allSettled(i)).forEach((s,u)=>{s.status==="fulfilled"&&s.value?o.push(s.value):console.error(`股票 ${a[u]} 抓取失敗:`,s.reason)}),r.indexOf(a)<r.length-1&&await new Promise(s=>setTimeout(s,100))}return console.log(`批量抓取完成，成功: ${o.length}/${e.length}`),o}async function _n(e,t){const n=await Gn(e);if(!n||!n.data)return console.warn(`股票 ${e} 無價格資料`),null;const o=n.data;let r=null,a=0,i=0;if(Array.isArray(o)&&o.length>0){const s=o[o.length-1];if(r=s.close||s.price||s[4],o.length>1){const u=o[o.length-2],d=u.close||u.price||u[4];a=r-d,i=a/d*100}}else typeof o=="object"&&(r=o.price||o.close||o.last,a=o.change||0,i=o.changePercent||0);return{...t,price:r||0,change:Number(a.toFixed(2)),changePercent:Number(i.toFixed(2)),lastUpdated:n.lastUpdated,weeklyKD:Math.floor(Math.random()*100),rsi:Math.floor(Math.random()*100)}}No().catch(console.error);const Kn=Bo("stock",()=>{const e=J([]);async function t(){try{console.log("開始載入使用者股票清單...");const l=await Wn("user-stock-info");return console.log("從 IndexedDB 載入的股票:",l),l&&l.length>0&&(e.value=l,await u()),e.value}catch(l){return console.error("載入使用者股票清單失敗:",l),e.value}}async function n(l){if(console.log("開始新增股票:",l),e.value.find(v=>v.id===l.id))return console.log("股票已存在，取消新增"),{success:!1,message:"股票已存在於清單中"};const p={id:l.id,name:l.name,industryCategory:Array.isArray(l.industryCategory)?Array.from(l.industryCategory):l.industryCategory?[l.industryCategory]:[],type:l.type,addedAt:new Date().toISOString()},h={...l,addedAt:p.addedAt,price:0,change:0,changePercent:0,weeklyKD:0,rsi:0};console.log("新增股票到 Pinia store:",h),e.value.push(h);try{return console.log("準備儲存股票到 user-stock-info:",p),await lt("user-stock-info",p),console.log("股票已成功儲存到 user-stock-info"),d(l.id).catch(v=>{console.error(`背景更新股票 ${l.id} 價格失敗:`,v)}),{success:!0,message:"股票已新增至清單"}}catch(v){return console.error("儲存股票失敗:",v),e.value=e.value.filter(_=>_.id!==l.id),{success:!1,message:"新增失敗，請稍後再試"}}}async function o(l){try{return await Ro("user-stock-info",l),e.value=e.value.filter(g=>g.id!==l),{success:!0,message:"股票已從清單中移除"}}catch(g){return console.error("移除股票失敗:",g),{success:!1,message:"移除失敗，請稍後再試"}}}function r(l){return e.value.some(g=>g.id===l)}async function a(l){e.value=l,await i()}async function i(){try{await Yo("user-stock-info");for(const l of e.value){const g={id:l.id,name:l.name,industryCategory:Array.isArray(l.industryCategory)?Array.from(l.industryCategory):l.industryCategory?[l.industryCategory]:[],type:l.type,addedAt:l.addedAt};await lt("user-stock-info",g)}}catch(l){console.error("儲存股票排序失敗:",l)}}async function c(l){const g=await hn("all-stocks",l);g&&(e.value.find(h=>h.id===g.id)||e.value.push(g))}async function s(l){const g=e.value.find(p=>p.id===l);g&&await lt("all-stocks",g)}async function u(){if(e.value.length===0){console.log("無股票需要更新價格");return}console.log(`開始批量更新 ${e.value.length} 支股票價格...`);try{const l=e.value.map(p=>p.id||p.code);(await Promise.all(e.value.map(async p=>{try{return await _n(p.id||p.code,p)}catch(h){return console.error(`更新股票 ${p.id} 價格失敗:`,h),null}}))).forEach((p,h)=>{if(p){const v=e.value[h];e.value[h]={...v,price:p.price,change:p.change,changePercent:p.changePercent,weeklyKD:p.weeklyKD,rsi:p.rsi,lastUpdated:p.lastUpdated}}}),await i(),console.log("所有股票價格更新完成")}catch(l){console.error("批量更新股票價格失敗:",l)}}async function d(l){const g=e.value.findIndex(p=>p.id===l);if(g===-1){console.warn(`找不到股票 ${l}`);return}console.log(`開始更新股票 ${l} 價格...`);try{const p=e.value[g],h=await _n(l,p);if(h){e.value[g]={...p,price:h.price,change:h.change,changePercent:h.changePercent,weeklyKD:h.weeklyKD,rsi:h.rsi,lastUpdated:h.lastUpdated};let v=null,_=null;try{const M=await hn("user-stock-data",l);if(M&&Array.isArray(M.daily)&&M.daily.length>0){const Y=M.daily[M.daily.length-1];Array.isArray(Y)?(v=Y[0],_=Y[1]):typeof Y=="object"&&(v=Y.date||Y.Date||Y.日期||null,_=Y.value||Y.close||Y.price||null)}}catch(M){console.warn("取得 user-stock-data 最後一筆失敗",M)}const F={id:p.id,name:p.name,industryCategory:Array.isArray(p.industryCategory)?Array.from(p.industryCategory):p.industryCategory?[p.industryCategory]:[],type:p.type,addedAt:p.addedAt,lastDate:v,lastValue:_};console.log("[user-stock-info] set",F),await lt("user-stock-info",F),console.log(`股票 ${l} 價格更新完成`)}}catch(p){console.error(`更新股票 ${l} 價格失敗:`,p)}}async function f(){if(console.log("手動重新整理所有股票價格..."),e.value.length===0)return console.log("無股票需要重新整理"),{success:!0,message:"無股票需要更新"};try{const l=e.value.map(g=>g.id||g.code);return await Er(l,3,!0),await u(),{success:!0,message:`已更新 ${e.value.length} 支股票價格`}}catch(l){return console.error("手動重新整理股票價格失敗:",l),{success:!1,message:"重新整理失敗，請稍後再試"}}}return{userStocks:e,loadUserStocks:t,addStock:n,removeStock:o,isStockAdded:r,reorderStocks:a,loadStock:c,saveStock:s,updateAllStockPrices:u,updateSingleStockPrice:d,refreshAllStockPrices:f}}),Cr={style:{display:"flex","flex-direction":"column",height:"100%","min-height":"60vh"}},kr={style:{flex:"1 1 auto"}},Tr={style:{display:"flex",gap:"8px","flex-wrap":"wrap","justify-content":"center","margin-bottom":"24px"}},$r=["onClick"],Ir={key:0,style:{"margin-top":"12px"}},Or={key:0},Ar={style:{"font-size":"17px","font-weight":"bold",color:"#222","margin-right":"16px","min-width":"60px"}},Pr={style:{"font-size":"16px",color:"#333",flex:"1"}},Mr={key:1,style:{color:"#999","text-align":"center","margin-top":"16px"}},Nr={__name:"StockSearch",setup(e){const t=Kn(),n=Xn("stock-search"),o=J(!1);Re(()=>{n.on(h=>{o.value=h})}),Lo(()=>{n.reset()});const r=J(),a=J(""),i=J([]),c=["台積電","鴻海","聯發科","長榮","中鋼"],s={background:"#fff",color:"#878787",borderRadius:"16px",padding:"4px 16px",fontSize:"15px",cursor:"pointer",userSelect:"none",fontWeight:"500",transition:"background 0.2s, color 0.2s"},u={background:"#ffe066",color:"#222",fontWeight:"bold",boxShadow:"0 0 0 2px #ffe06688"};function d(h){return a.value===h?{...s,...u}:s}function f(){_e(()=>{const h=r.value?.$el?.querySelector("input");h&&h.focus()})}Ee(()=>o.value,h=>{h&&setTimeout(()=>{f()},300)}),Ee(()=>a.value,async h=>{if(console.log("localSearch 更新:",h),!h||h.length<1){i.value=[];return}console.log("觸發 getStocksFromDB");try{const v=await vr();console.log("getStocksFromDB 執行成功"),i.value=v.filter(_=>_.name.includes(h)||_.id.includes(h)),console.log("搜尋結果:",i.value)}catch(v){console.error("getStocksFromDB 執行失敗:",v)}});function l(h){}function g(h){console.log("點擊熱門標籤:",h),a.value=h}async function p(h){const v=await t.addStock(h);yt({message:v.message,type:v.success?"success":"fail"})}return(h,v)=>(me(),Ho(re(fr),{show:o.value,"onUpdate:show":v[1]||(v[1]=_=>re(n).emit(!1)),"cancel-text":"離開",options:[],style:{"--van-share-sheet-header-padding":"24px 24px 0 24px"}},{title:de(()=>v[2]||(v[2]=[j("div",{style:{"font-size":"18px","font-weight":"bold","letter-spacing":"1px","text-align":"center","margin-top":"0","margin-bottom":"0",color:"#222","line-height":"1.2"}}," 股票搜尋 ",-1)])),description:de(()=>[j("div",Cr,[j("div",kr,[j("div",null,[H(re(qo),{ref_key:"searchInputRef",ref:r,modelValue:a.value,"onUpdate:modelValue":v[0]||(v[0]=_=>a.value=_),placeholder:"請輸入股票名稱或代碼","action-text":"",style:{"--van-search-input-height":"48px","font-size":"18px"},onSearch:l},null,8,["modelValue"])]),j("div",null,[v[3]||(v[3]=j("div",{style:{display:"flex","align-items":"center",margin:"0 0 10px 0"}},[j("div",{style:{"margin-left":"16px","font-size":"16px",color:"#222","font-weight":"bold","letter-spacing":"1px"}}," | 熱門股票 ")],-1)),j("div",Tr,[(me(),we(gn,null,pn(c,_=>j("span",{key:_,onClick:F=>g(_),style:Un(d(_))},fe(_),13,$r)),64))]),a.value&&a.value.length>=1?(me(),we("div",Ir,[i.value.length?(me(),we("div",Or,[(me(!0),we(gn,null,pn(i.value,_=>(me(),we("div",{key:_.id,style:{background:"#fff","border-radius":"12px","box-shadow":"0 2px 8px #0001",padding:"16px 20px","margin-bottom":"12px",display:"flex","align-items":"center","min-height":"56px"}},[j("div",Ar,fe(_.id),1),j("div",Pr,fe(_.name),1),H(re(bt),{type:re(t).isStockAdded(_.id)?"default":"primary",size:"small",disabled:re(t).isStockAdded(_.id),onClick:F=>p(_),style:{"margin-left":"12px","min-width":"60px"}},{default:de(()=>[Ut(fe(re(t).isStockAdded(_.id)?"已新增":"新增"),1)]),_:2},1032,["type","disabled","onClick"])]))),128))])):(me(),we("div",Mr," 查無資料 "))])):Wo("",!0)])])])]),_:1},8,["show"]))}},Fr={key:0,class:"chart-placeholder"},Br={__name:"KChart",props:{width:{type:Number,default:200},height:{type:Number,default:100},stockData:{type:Object,required:!0},stockIndex:{type:Number,default:0}},setup(e){const t=e;Re(()=>{_e(()=>{})});const n=J(null),o=J(null),r=J(!1),a=J(null),{stop:i}=jo(n,([{isIntersecting:f}])=>{f&&!r.value&&(console.log(`股票 ${t.stockData.name} 的圖表進入視窗，開始渲染...`),r.value=!0,_e(()=>{c()}))},{threshold:.1,rootMargin:"50px"});function c(){if(o.value)try{console.log(`正在為股票 ${t.stockData.name} 創建 K 線圖...`);const f=o.value.getContext("2d"),l=s();u(f,l),console.log(`股票 ${t.stockData.name} 的 K 線圖創建成功`)}catch(f){console.error(`創建股票 ${t.stockData.name} 的圖表時發生錯誤:`,f),d()}}function s(){const l=[],g=30+t.stockIndex*2,p=8+t.stockIndex%3*2;let h=g;for(let v=0;v<6;v++){const _=h,F=(Math.random()-.5)*p,M=_+F,Y=Math.max(_,M)+Math.random()*(p*.3),x=Math.min(_,M)-Math.random()*(p*.3);l.push({open:_,high:Y,low:x,close:M}),h=M}return l}function u(f,l){const g=o.value,p=g.clientWidth,h=g.clientHeight;g.width=p,g.height=h,f.clearRect(0,0,p,h);const v=10,_=p-v*2,F=h-v*2,M=l.flatMap(I=>[I.open,I.high,I.low,I.close]),Y=Math.min(...M),x=Math.max(...M),L=x-Y,W=_/l.length,k=W*.6;l.forEach((I,B)=>{const C=v+(B+.5)*W,G=I.close>I.open,ee=G?"#ef5350":"#26a69a",E=v+(x-I.high)/L*F,w=v+(x-I.low)/L*F,m=v+(x-I.open)/L*F,D=v+(x-I.close)/L*F,b=Math.min(m,D),O=Math.max(m,D),A=Math.max(O-b,1);f.strokeStyle=ee,f.lineWidth=1,f.beginPath(),f.moveTo(C,E),f.lineTo(C,w),f.stroke(),f.fillStyle=G?ee:"#fff",f.strokeStyle=ee,f.lineWidth=1,f.fillRect(C-k/2,b,k,A),f.strokeRect(C-k/2,b,k,A)})}function d(){n.value&&(n.value.innerHTML=`
                <div style="
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    height: 100%;
                    background: #f0f0f0;
                    color: #666;
                    font-size: 12px;
                    border-radius: 6px;
                ">
                    圖表暫不可用
                </div>
            `)}return Ee(()=>t.stockData,()=>{r.value&&_e(()=>{c()})},{deep:!0}),Bn(()=>{i(),a.value=null}),(f,l)=>(me(),we("div",{ref_key:"chartContainer",ref:n,class:"mini-k-chart",style:{width:"100%",height:"100%"}},[r.value?(me(),we("canvas",{key:1,ref_key:"chartCanvas",ref:o,style:{width:"100%",height:"100%"}},null,512)):(me(),we("div",Fr,l[0]||(l[0]=[j("div",{class:"placeholder-content"},"圖表載入中...",-1)])))],512))}},Rr=rn(Br,[["__scopeId","data-v-1755c118"]]),Yr={class:"stock-name"},Lr={class:"stock-name-main"},Hr={class:"stock-name-left"},Wr={class:"name highlight"},jr={class:"code"},zr={class:"stock-name-right"},Xr={class:"stock-progress-bar"},Ur={class:"progress-text"},Vr={__name:"StockName",props:{name:String,code:String,price:[String,Number],change:[String,Number],changePercent:[String,Number],priceClass:String,progress:Number,progressText:String},setup(e){return(t,n)=>(me(),we("div",Yr,[j("div",Lr,[j("div",Hr,[j("div",Wr,fe(e.name),1),j("div",jr,fe(e.code),1),n[0]||(n[0]=j("div",{class:"star-area"},[j("span",{class:"star"},"★")],-1))]),j("div",zr,[j("div",{class:Vt(["price",e.priceClass])},fe(e.price),3),j("div",{class:Vt(["change",e.priceClass])},fe(e.change>0?"+":"")+fe(e.change)+" ("+fe(e.changePercent)+"%) ",3)])]),j("div",Xr,[j("div",{class:"stock-progress-inner",style:Un({width:(e.progress||0)+"%"})},[j("span",Ur,fe(e.progressText||(e.progress||0)+"%"),1)],4)])]))}},qr=rn(Vr,[["__scopeId","data-v-c759bb7e"]]);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,o)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Dn(Object(n),!0).forEach(function(o){Gr(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function St(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?St=function(t){return typeof t}:St=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(e)}function Gr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ke(){return ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ke.apply(this,arguments)}function Kr(e,t){if(e==null)return{};var n={},o=Object.keys(e),r,a;for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function Zr(e,t){if(e==null)return{};var n=Kr(e,t),o,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var Jr="1.14.0";function Ce(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Te=Ce(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),rt=Ce(/Edge/i),xn=Ce(/firefox/i),Ze=Ce(/safari/i)&&!Ce(/chrome/i)&&!Ce(/android/i),Zn=Ce(/iP(ad|od|hone)/i),Qr=Ce(/chrome/i)&&Ce(/android/i),Jn={capture:!1,passive:!1};function X(e,t,n){e.addEventListener(t,n,!Te&&Jn)}function z(e,t,n){e.removeEventListener(t,n,!Te&&Jn)}function kt(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function ea(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Se(e,t,n,o){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&kt(e,t):kt(e,t))||o&&e===n)return e;if(e===n)break}while(e=ea(e))}return null}var En=/\s+/g;function ce(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(En," ").replace(" "+t+" "," ");e.className=(o+(n?" "+t:"")).replace(En," ")}}function T(e,t,n){var o=e&&e.style;if(o){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in o)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),o[t]=n+(typeof n=="string"?"":"px")}}function je(e,t){var n="";if(typeof e=="string")n=e;else do{var o=T(e,"transform");o&&o!=="none"&&(n=o+" "+n)}while(!t&&(e=e.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function Qn(e,t,n){if(e){var o=e.getElementsByTagName(t),r=0,a=o.length;if(n)for(;r<a;r++)n(o[r],r);return o}return[]}function De(){var e=document.scrollingElement;return e||document.documentElement}function te(e,t,n,o,r){if(!(!e.getBoundingClientRect&&e!==window)){var a,i,c,s,u,d,f;if(e!==window&&e.parentNode&&e!==De()?(a=e.getBoundingClientRect(),i=a.top,c=a.left,s=a.bottom,u=a.right,d=a.height,f=a.width):(i=0,c=0,s=window.innerHeight,u=window.innerWidth,d=window.innerHeight,f=window.innerWidth),(t||n)&&e!==window&&(r=r||e.parentNode,!Te))do if(r&&r.getBoundingClientRect&&(T(r,"transform")!=="none"||n&&T(r,"position")!=="static")){var l=r.getBoundingClientRect();i-=l.top+parseInt(T(r,"border-top-width")),c-=l.left+parseInt(T(r,"border-left-width")),s=i+a.height,u=c+a.width;break}while(r=r.parentNode);if(o&&e!==window){var g=je(r||e),p=g&&g.a,h=g&&g.d;g&&(i/=h,c/=p,f/=p,d/=h,s=i+d,u=c+f)}return{top:i,left:c,bottom:s,right:u,width:f,height:d}}}function Cn(e,t,n){for(var o=Ae(e,!0),r=te(e)[t];o;){var a=te(o)[n],i=void 0;if(i=r>=a,!i)return o;if(o===De())break;o=Ae(o,!1)}return!1}function ze(e,t,n,o){for(var r=0,a=0,i=e.children;a<i.length;){if(i[a].style.display!=="none"&&i[a]!==$.ghost&&(o||i[a]!==$.dragged)&&Se(i[a],n.draggable,e,!1)){if(r===t)return i[a];r++}a++}return null}function an(e,t){for(var n=e.lastElementChild;n&&(n===$.ghost||T(n,"display")==="none"||t&&!kt(n,t));)n=n.previousElementSibling;return n||null}function pe(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==$.clone&&(!t||kt(e,t))&&n++;return n}function kn(e){var t=0,n=0,o=De();if(e)do{var r=je(e),a=r.a,i=r.d;t+=e.scrollLeft*a,n+=e.scrollTop*i}while(e!==o&&(e=e.parentNode));return[t,n]}function ta(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[n][o])return Number(n)}return-1}function Ae(e,t){if(!e||!e.getBoundingClientRect)return De();var n=e,o=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=T(n);if(n.clientWidth<n.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return De();if(o||t)return n;o=!0}}while(n=n.parentNode);return De()}function na(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Mt(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var Je;function eo(e,t){return function(){if(!Je){var n=arguments,o=this;n.length===1?e.call(o,n[0]):e.apply(o,n),Je=setTimeout(function(){Je=void 0},t)}}}function oa(){clearTimeout(Je),Je=void 0}function to(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function no(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var he="Sortable"+new Date().getTime();function ra(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(r){if(!(T(r,"display")==="none"||r===$.ghost)){e.push({target:r,rect:te(r)});var a=xe({},e[e.length-1].rect);if(r.thisAnimationDuration){var i=je(r,!0);i&&(a.top-=i.f,a.left-=i.e)}r.fromRect=a}})}},addAnimationState:function(o){e.push(o)},removeAnimationState:function(o){e.splice(ta(e,{target:o}),1)},animateAll:function(o){var r=this;if(!this.options.animation){clearTimeout(t),typeof o=="function"&&o();return}var a=!1,i=0;e.forEach(function(c){var s=0,u=c.target,d=u.fromRect,f=te(u),l=u.prevFromRect,g=u.prevToRect,p=c.rect,h=je(u,!0);h&&(f.top-=h.f,f.left-=h.e),u.toRect=f,u.thisAnimationDuration&&Mt(l,f)&&!Mt(d,f)&&(p.top-f.top)/(p.left-f.left)===(d.top-f.top)/(d.left-f.left)&&(s=ia(p,l,g,r.options)),Mt(f,d)||(u.prevFromRect=d,u.prevToRect=f,s||(s=r.options.animation),r.animate(u,p,f,s)),s&&(a=!0,i=Math.max(i,s),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},s),u.thisAnimationDuration=s)}),clearTimeout(t),a?t=setTimeout(function(){typeof o=="function"&&o()},i):typeof o=="function"&&o(),e=[]},animate:function(o,r,a,i){if(i){T(o,"transition",""),T(o,"transform","");var c=je(this.el),s=c&&c.a,u=c&&c.d,d=(r.left-a.left)/(s||1),f=(r.top-a.top)/(u||1);o.animatingX=!!d,o.animatingY=!!f,T(o,"transform","translate3d("+d+"px,"+f+"px,0)"),this.forRepaintDummy=aa(o),T(o,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),T(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){T(o,"transition",""),T(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},i)}}}}function aa(e){return e.offsetWidth}function ia(e,t,n,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*o.animation}var Ye=[],Nt={initializeByDefault:!0},at={mount:function(t){for(var n in Nt)Nt.hasOwnProperty(n)&&!(n in t)&&(t[n]=Nt[n]);Ye.forEach(function(o){if(o.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Ye.push(t)},pluginEvent:function(t,n,o){var r=this;this.eventCanceled=!1,o.cancel=function(){r.eventCanceled=!0};var a=t+"Global";Ye.forEach(function(i){n[i.pluginName]&&(n[i.pluginName][a]&&n[i.pluginName][a](xe({sortable:n},o)),n.options[i.pluginName]&&n[i.pluginName][t]&&n[i.pluginName][t](xe({sortable:n},o)))})},initializePlugins:function(t,n,o,r){Ye.forEach(function(c){var s=c.pluginName;if(!(!t.options[s]&&!c.initializeByDefault)){var u=new c(t,n,t.options);u.sortable=t,u.options=t.options,t[s]=u,ke(o,u.defaults)}});for(var a in t.options)if(t.options.hasOwnProperty(a)){var i=this.modifyOption(t,a,t.options[a]);typeof i<"u"&&(t.options[a]=i)}},getEventProperties:function(t,n){var o={};return Ye.forEach(function(r){typeof r.eventProperties=="function"&&ke(o,r.eventProperties.call(n[r.pluginName],t))}),o},modifyOption:function(t,n,o){var r;return Ye.forEach(function(a){t[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[n]=="function"&&(r=a.optionListeners[n].call(t[a.pluginName],o))}),r}};function sa(e){var t=e.sortable,n=e.rootEl,o=e.name,r=e.targetEl,a=e.cloneEl,i=e.toEl,c=e.fromEl,s=e.oldIndex,u=e.newIndex,d=e.oldDraggableIndex,f=e.newDraggableIndex,l=e.originalEvent,g=e.putSortable,p=e.extraEventProperties;if(t=t||n&&n[he],!!t){var h,v=t.options,_="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!Te&&!rt?h=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(h=document.createEvent("Event"),h.initEvent(o,!0,!0)),h.to=i||n,h.from=c||n,h.item=r||n,h.clone=a,h.oldIndex=s,h.newIndex=u,h.oldDraggableIndex=d,h.newDraggableIndex=f,h.originalEvent=l,h.pullMode=g?g.lastPutMode:void 0;var F=xe(xe({},p),at.getEventProperties(o,t));for(var M in F)h[M]=F[M];n&&n.dispatchEvent(h),v[_]&&v[_].call(t,h)}}var la=["evt"],le=function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=o.evt,a=Zr(o,la);at.pluginEvent.bind($)(t,n,xe({dragEl:y,parentEl:K,ghostEl:N,rootEl:q,nextEl:Fe,lastDownEl:_t,cloneEl:Z,cloneHidden:Oe,dragStarted:qe,putSortable:oe,activeSortable:$.active,originalEvent:r,oldIndex:We,oldDraggableIndex:Qe,newIndex:ue,newDraggableIndex:Ie,hideGhostForTarget:io,unhideGhostForTarget:so,cloneNowHidden:function(){Oe=!0},cloneNowShown:function(){Oe=!1},dispatchSortableEvent:function(c){ie({sortable:n,name:c,originalEvent:r})}},a))};function ie(e){sa(xe({putSortable:oe,cloneEl:Z,targetEl:y,rootEl:q,oldIndex:We,oldDraggableIndex:Qe,newIndex:ue,newDraggableIndex:Ie},e))}var y,K,N,q,Fe,_t,Z,Oe,We,ue,Qe,Ie,ut,oe,He=!1,Tt=!1,$t=[],Me,be,Ft,Bt,Tn,$n,qe,Le,et,tt=!1,dt=!1,Dt,ae,Rt=[],Gt=!1,It=[],At=typeof document<"u",ft=Zn,In=rt||Te?"cssFloat":"float",ca=At&&!Qr&&!Zn&&"draggable"in document.createElement("div"),oo=function(){if(At){if(Te)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),ro=function(t,n){var o=T(t),r=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),a=ze(t,0,n),i=ze(t,1,n),c=a&&T(a),s=i&&T(i),u=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+te(a).width,d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+te(i).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&c.float&&c.float!=="none"){var f=c.float==="left"?"left":"right";return i&&(s.clear==="both"||s.clear===f)?"vertical":"horizontal"}return a&&(c.display==="block"||c.display==="flex"||c.display==="table"||c.display==="grid"||u>=r&&o[In]==="none"||i&&o[In]==="none"&&u+d>r)?"vertical":"horizontal"},ua=function(t,n,o){var r=o?t.left:t.top,a=o?t.right:t.bottom,i=o?t.width:t.height,c=o?n.left:n.top,s=o?n.right:n.bottom,u=o?n.width:n.height;return r===c||a===s||r+i/2===c+u/2},da=function(t,n){var o;return $t.some(function(r){var a=r[he].options.emptyInsertThreshold;if(!(!a||an(r))){var i=te(r),c=t>=i.left-a&&t<=i.right+a,s=n>=i.top-a&&n<=i.bottom+a;if(c&&s)return o=r}}),o},ao=function(t){function n(a,i){return function(c,s,u,d){var f=c.options.group.name&&s.options.group.name&&c.options.group.name===s.options.group.name;if(a==null&&(i||f))return!0;if(a==null||a===!1)return!1;if(i&&a==="clone")return a;if(typeof a=="function")return n(a(c,s,u,d),i)(c,s,u,d);var l=(i?c:s).options.group.name;return a===!0||typeof a=="string"&&a===l||a.join&&a.indexOf(l)>-1}}var o={},r=t.group;(!r||St(r)!="object")&&(r={name:r}),o.name=r.name,o.checkPull=n(r.pull,!0),o.checkPut=n(r.put),o.revertClone=r.revertClone,t.group=o},io=function(){!oo&&N&&T(N,"display","none")},so=function(){!oo&&N&&T(N,"display","")};At&&document.addEventListener("click",function(e){if(Tt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Tt=!1,!1},!0);var Ne=function(t){if(y){t=t.touches?t.touches[0]:t;var n=da(t.clientX,t.clientY);if(n){var o={};for(var r in t)t.hasOwnProperty(r)&&(o[r]=t[r]);o.target=o.rootEl=n,o.preventDefault=void 0,o.stopPropagation=void 0,n[he]._onDragOver(o)}}},fa=function(t){y&&y.parentNode[he]._isOutsideThisEl(t.target)};function $(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=ke({},t),e[he]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ro(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(i,c){i.setData("Text",c.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:$.supportPointer!==!1&&"PointerEvent"in window&&!Ze,emptyInsertThreshold:5};at.initializePlugins(this,e,n);for(var o in n)!(o in t)&&(t[o]=n[o]);ao(t);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=t.forceFallback?!1:ca,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?X(e,"pointerdown",this._onTapStart):(X(e,"mousedown",this._onTapStart),X(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(X(e,"dragover",this),X(e,"dragenter",this)),$t.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),ke(this,ra())}$.prototype={constructor:$,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Le=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,y):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,o=this.el,r=this.options,a=r.preventOnFilter,i=t.type,c=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,s=(c||t).target,u=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,d=r.filter;if(wa(o),!y&&!(/mousedown|pointerdown/.test(i)&&t.button!==0||r.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&Ze&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=Se(s,r.draggable,o,!1),!(s&&s.animated)&&_t!==s)){if(We=pe(s),Qe=pe(s,r.draggable),typeof d=="function"){if(d.call(this,t,s,this)){ie({sortable:n,rootEl:u,name:"filter",targetEl:s,toEl:o,fromEl:o}),le("filter",n,{evt:t}),a&&t.cancelable&&t.preventDefault();return}}else if(d&&(d=d.split(",").some(function(f){if(f=Se(u,f.trim(),o,!1),f)return ie({sortable:n,rootEl:f,name:"filter",targetEl:s,fromEl:o,toEl:o}),le("filter",n,{evt:t}),!0}),d)){a&&t.cancelable&&t.preventDefault();return}r.handle&&!Se(u,r.handle,o,!1)||this._prepareDragStart(t,c,s)}}},_prepareDragStart:function(t,n,o){var r=this,a=r.el,i=r.options,c=a.ownerDocument,s;if(o&&!y&&o.parentNode===a){var u=te(o);if(q=a,y=o,K=y.parentNode,Fe=y.nextSibling,_t=o,ut=i.group,$.dragged=y,Me={target:y,clientX:(n||t).clientX,clientY:(n||t).clientY},Tn=Me.clientX-u.left,$n=Me.clientY-u.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,y.style["will-change"]="all",s=function(){if(le("delayEnded",r,{evt:t}),$.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!xn&&r.nativeDraggable&&(y.draggable=!0),r._triggerDragStart(t,n),ie({sortable:r,name:"choose",originalEvent:t}),ce(y,i.chosenClass,!0)},i.ignore.split(",").forEach(function(d){Qn(y,d.trim(),Yt)}),X(c,"dragover",Ne),X(c,"mousemove",Ne),X(c,"touchmove",Ne),X(c,"mouseup",r._onDrop),X(c,"touchend",r._onDrop),X(c,"touchcancel",r._onDrop),xn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,y.draggable=!0),le("delayStart",this,{evt:t}),i.delay&&(!i.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(rt||Te))){if($.eventCanceled){this._onDrop();return}X(c,"mouseup",r._disableDelayedDrag),X(c,"touchend",r._disableDelayedDrag),X(c,"touchcancel",r._disableDelayedDrag),X(c,"mousemove",r._delayedDragTouchMoveHandler),X(c,"touchmove",r._delayedDragTouchMoveHandler),i.supportPointer&&X(c,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(s,i.delay)}else s()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){y&&Yt(y),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;z(t,"mouseup",this._disableDelayedDrag),z(t,"touchend",this._disableDelayedDrag),z(t,"touchcancel",this._disableDelayedDrag),z(t,"mousemove",this._delayedDragTouchMoveHandler),z(t,"touchmove",this._delayedDragTouchMoveHandler),z(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?X(document,"pointermove",this._onTouchMove):n?X(document,"touchmove",this._onTouchMove):X(document,"mousemove",this._onTouchMove):(X(y,"dragend",this),X(q,"dragstart",this._onDragStart));try{document.selection?xt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(He=!1,q&&y){le("dragStarted",this,{evt:n}),this.nativeDraggable&&X(document,"dragover",fa);var o=this.options;!t&&ce(y,o.dragClass,!1),ce(y,o.ghostClass,!0),$.active=this,t&&this._appendGhost(),ie({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(be){this._lastX=be.clientX,this._lastY=be.clientY,io();for(var t=document.elementFromPoint(be.clientX,be.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(be.clientX,be.clientY),t!==n);)n=t;if(y.parentNode[he]._isOutsideThisEl(t),n)do{if(n[he]){var o=void 0;if(o=n[he]._onDragOver({clientX:be.clientX,clientY:be.clientY,target:t,rootEl:n}),o&&!this.options.dragoverBubble)break}t=n}while(n=n.parentNode);so()}},_onTouchMove:function(t){if(Me){var n=this.options,o=n.fallbackTolerance,r=n.fallbackOffset,a=t.touches?t.touches[0]:t,i=N&&je(N,!0),c=N&&i&&i.a,s=N&&i&&i.d,u=ft&&ae&&kn(ae),d=(a.clientX-Me.clientX+r.x)/(c||1)+(u?u[0]-Rt[0]:0)/(c||1),f=(a.clientY-Me.clientY+r.y)/(s||1)+(u?u[1]-Rt[1]:0)/(s||1);if(!$.active&&!He){if(o&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<o)return;this._onDragStart(t,!0)}if(N){i?(i.e+=d-(Ft||0),i.f+=f-(Bt||0)):i={a:1,b:0,c:0,d:1,e:d,f};var l="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");T(N,"webkitTransform",l),T(N,"mozTransform",l),T(N,"msTransform",l),T(N,"transform",l),Ft=d,Bt=f,be=a}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!N){var t=this.options.fallbackOnBody?document.body:q,n=te(y,!0,ft,!0,t),o=this.options;if(ft){for(ae=t;T(ae,"position")==="static"&&T(ae,"transform")==="none"&&ae!==document;)ae=ae.parentNode;ae!==document.body&&ae!==document.documentElement?(ae===document&&(ae=De()),n.top+=ae.scrollTop,n.left+=ae.scrollLeft):ae=De(),Rt=kn(ae)}N=y.cloneNode(!0),ce(N,o.ghostClass,!1),ce(N,o.fallbackClass,!0),ce(N,o.dragClass,!0),T(N,"transition",""),T(N,"transform",""),T(N,"box-sizing","border-box"),T(N,"margin",0),T(N,"top",n.top),T(N,"left",n.left),T(N,"width",n.width),T(N,"height",n.height),T(N,"opacity","0.8"),T(N,"position",ft?"absolute":"fixed"),T(N,"zIndex","100000"),T(N,"pointerEvents","none"),$.ghost=N,t.appendChild(N),T(N,"transform-origin",Tn/parseInt(N.style.width)*100+"% "+$n/parseInt(N.style.height)*100+"%")}},_onDragStart:function(t,n){var o=this,r=t.dataTransfer,a=o.options;if(le("dragStart",this,{evt:t}),$.eventCanceled){this._onDrop();return}le("setupClone",this),$.eventCanceled||(Z=no(y),Z.draggable=!1,Z.style["will-change"]="",this._hideClone(),ce(Z,this.options.chosenClass,!1),$.clone=Z),o.cloneId=xt(function(){le("clone",o),!$.eventCanceled&&(o.options.removeCloneOnHide||q.insertBefore(Z,y),o._hideClone(),ie({sortable:o,name:"clone"}))}),!n&&ce(y,a.dragClass,!0),n?(Tt=!0,o._loopId=setInterval(o._emulateDragOver,50)):(z(document,"mouseup",o._onDrop),z(document,"touchend",o._onDrop),z(document,"touchcancel",o._onDrop),r&&(r.effectAllowed="move",a.setData&&a.setData.call(o,r,y)),X(document,"drop",o),T(y,"transform","translateZ(0)")),He=!0,o._dragStartId=xt(o._dragStarted.bind(o,n,t)),X(document,"selectstart",o),qe=!0,Ze&&T(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,o=t.target,r,a,i,c=this.options,s=c.group,u=$.active,d=ut===s,f=c.sort,l=oe||u,g,p=this,h=!1;if(Gt)return;function v(b,O){le(b,p,xe({evt:t,isOwner:d,axis:g?"vertical":"horizontal",revert:i,dragRect:r,targetRect:a,canSort:f,fromSortable:l,target:o,completed:F,onMove:function(S,P){return ht(q,n,y,r,S,te(S),t,P)},changed:M},O))}function _(){v("dragOverAnimationCapture"),p.captureAnimationState(),p!==l&&l.captureAnimationState()}function F(b){return v("dragOverCompleted",{insertion:b}),b&&(d?u._hideClone():u._showClone(p),p!==l&&(ce(y,oe?oe.options.ghostClass:u.options.ghostClass,!1),ce(y,c.ghostClass,!0)),oe!==p&&p!==$.active?oe=p:p===$.active&&oe&&(oe=null),l===p&&(p._ignoreWhileAnimating=o),p.animateAll(function(){v("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==l&&(l.animateAll(),l._ignoreWhileAnimating=null)),(o===y&&!y.animated||o===n&&!o.animated)&&(Le=null),!c.dragoverBubble&&!t.rootEl&&o!==document&&(y.parentNode[he]._isOutsideThisEl(t.target),!b&&Ne(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),h=!0}function M(){ue=pe(y),Ie=pe(y,c.draggable),ie({sortable:p,name:"change",toEl:n,newIndex:ue,newDraggableIndex:Ie,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),o=Se(o,c.draggable,n,!0),v("dragOver"),$.eventCanceled)return h;if(y.contains(t.target)||o.animated&&o.animatingX&&o.animatingY||p._ignoreWhileAnimating===o)return F(!1);if(Tt=!1,u&&!c.disabled&&(d?f||(i=K!==q):oe===this||(this.lastPutMode=ut.checkPull(this,u,y,t))&&s.checkPut(this,u,y,t))){if(g=this._getDirection(t,o)==="vertical",r=te(y),v("dragOverValid"),$.eventCanceled)return h;if(i)return K=q,_(),this._hideClone(),v("revert"),$.eventCanceled||(Fe?q.insertBefore(y,Fe):q.appendChild(y)),F(!0);var Y=an(n,c.draggable);if(!Y||ma(t,g,this)&&!Y.animated){if(Y===y)return F(!1);if(Y&&n===t.target&&(o=Y),o&&(a=te(o)),ht(q,n,y,r,o,a,t,!!o)!==!1)return _(),n.appendChild(y),K=n,M(),F(!0)}else if(Y&&pa(t,g,this)){var x=ze(n,0,c,!0);if(x===y)return F(!1);if(o=x,a=te(o),ht(q,n,y,r,o,a,t,!1)!==!1)return _(),n.insertBefore(y,x),K=n,M(),F(!0)}else if(o.parentNode===n){a=te(o);var L=0,W,k=y.parentNode!==n,I=!ua(y.animated&&y.toRect||r,o.animated&&o.toRect||a,g),B=g?"top":"left",C=Cn(o,"top","top")||Cn(y,"top","top"),G=C?C.scrollTop:void 0;Le!==o&&(W=a[B],tt=!1,dt=!I&&c.invertSwap||k),L=va(t,o,a,g,I?1:c.swapThreshold,c.invertedSwapThreshold==null?c.swapThreshold:c.invertedSwapThreshold,dt,Le===o);var ee;if(L!==0){var E=pe(y);do E-=L,ee=K.children[E];while(ee&&(T(ee,"display")==="none"||ee===N))}if(L===0||ee===o)return F(!1);Le=o,et=L;var w=o.nextElementSibling,m=!1;m=L===1;var D=ht(q,n,y,r,o,a,t,m);if(D!==!1)return(D===1||D===-1)&&(m=D===1),Gt=!0,setTimeout(ga,30),_(),m&&!w?n.appendChild(y):o.parentNode.insertBefore(y,m?w:o),C&&to(C,0,G-C.scrollTop),K=y.parentNode,W!==void 0&&!dt&&(Dt=Math.abs(W-te(o)[B])),M(),F(!0)}if(n.contains(y))return F(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){z(document,"mousemove",this._onTouchMove),z(document,"touchmove",this._onTouchMove),z(document,"pointermove",this._onTouchMove),z(document,"dragover",Ne),z(document,"mousemove",Ne),z(document,"touchmove",Ne)},_offUpEvents:function(){var t=this.el.ownerDocument;z(t,"mouseup",this._onDrop),z(t,"touchend",this._onDrop),z(t,"pointerup",this._onDrop),z(t,"touchcancel",this._onDrop),z(document,"selectstart",this)},_onDrop:function(t){var n=this.el,o=this.options;if(ue=pe(y),Ie=pe(y,o.draggable),le("drop",this,{evt:t}),K=y&&y.parentNode,ue=pe(y),Ie=pe(y,o.draggable),$.eventCanceled){this._nulling();return}He=!1,dt=!1,tt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Kt(this.cloneId),Kt(this._dragStartId),this.nativeDraggable&&(z(document,"drop",this),z(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ze&&T(document.body,"user-select",""),T(y,"transform",""),t&&(qe&&(t.cancelable&&t.preventDefault(),!o.dropBubble&&t.stopPropagation()),N&&N.parentNode&&N.parentNode.removeChild(N),(q===K||oe&&oe.lastPutMode!=="clone")&&Z&&Z.parentNode&&Z.parentNode.removeChild(Z),y&&(this.nativeDraggable&&z(y,"dragend",this),Yt(y),y.style["will-change"]="",qe&&!He&&ce(y,oe?oe.options.ghostClass:this.options.ghostClass,!1),ce(y,this.options.chosenClass,!1),ie({sortable:this,name:"unchoose",toEl:K,newIndex:null,newDraggableIndex:null,originalEvent:t}),q!==K?(ue>=0&&(ie({rootEl:K,name:"add",toEl:K,fromEl:q,originalEvent:t}),ie({sortable:this,name:"remove",toEl:K,originalEvent:t}),ie({rootEl:K,name:"sort",toEl:K,fromEl:q,originalEvent:t}),ie({sortable:this,name:"sort",toEl:K,originalEvent:t})),oe&&oe.save()):ue!==We&&ue>=0&&(ie({sortable:this,name:"update",toEl:K,originalEvent:t}),ie({sortable:this,name:"sort",toEl:K,originalEvent:t})),$.active&&((ue==null||ue===-1)&&(ue=We,Ie=Qe),ie({sortable:this,name:"end",toEl:K,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){le("nulling",this),q=y=K=N=Fe=Z=_t=Oe=Me=be=qe=ue=Ie=We=Qe=Le=et=oe=ut=$.dragged=$.ghost=$.clone=$.active=null,It.forEach(function(t){t.checked=!0}),It.length=Ft=Bt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":y&&(this._onDragOver(t),ha(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,o=this.el.children,r=0,a=o.length,i=this.options;r<a;r++)n=o[r],Se(n,i.draggable,this.el,!1)&&t.push(n.getAttribute(i.dataIdAttr)||ba(n));return t},sort:function(t,n){var o={},r=this.el;this.toArray().forEach(function(a,i){var c=r.children[i];Se(c,this.options.draggable,r,!1)&&(o[a]=c)},this),n&&this.captureAnimationState(),t.forEach(function(a){o[a]&&(r.removeChild(o[a]),r.appendChild(o[a]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return Se(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var o=this.options;if(n===void 0)return o[t];var r=at.modifyOption(this,t,n);typeof r<"u"?o[t]=r:o[t]=n,t==="group"&&ao(o)},destroy:function(){le("destroy",this);var t=this.el;t[he]=null,z(t,"mousedown",this._onTapStart),z(t,"touchstart",this._onTapStart),z(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(z(t,"dragover",this),z(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),$t.splice($t.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!Oe){if(le("hideClone",this),$.eventCanceled)return;T(Z,"display","none"),this.options.removeCloneOnHide&&Z.parentNode&&Z.parentNode.removeChild(Z),Oe=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(Oe){if(le("showClone",this),$.eventCanceled)return;y.parentNode==q&&!this.options.group.revertClone?q.insertBefore(Z,y):Fe?q.insertBefore(Z,Fe):q.appendChild(Z),this.options.group.revertClone&&this.animate(y,Z),T(Z,"display",""),Oe=!1}}};function ha(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function ht(e,t,n,o,r,a,i,c){var s,u=e[he],d=u.options.onMove,f;return window.CustomEvent&&!Te&&!rt?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=t,s.from=e,s.dragged=n,s.draggedRect=o,s.related=r||t,s.relatedRect=a||te(t),s.willInsertAfter=c,s.originalEvent=i,e.dispatchEvent(s),d&&(f=d.call(u,s,i)),f}function Yt(e){e.draggable=!1}function ga(){Gt=!1}function pa(e,t,n){var o=te(ze(n.el,0,n.options,!0)),r=10;return t?e.clientX<o.left-r||e.clientY<o.top&&e.clientX<o.right:e.clientY<o.top-r||e.clientY<o.bottom&&e.clientX<o.left}function ma(e,t,n){var o=te(an(n.el,n.options.draggable)),r=10;return t?e.clientX>o.right+r||e.clientX<=o.right&&e.clientY>o.bottom&&e.clientX>=o.left:e.clientX>o.right&&e.clientY>o.top||e.clientX<=o.right&&e.clientY>o.bottom+r}function va(e,t,n,o,r,a,i,c){var s=o?e.clientY:e.clientX,u=o?n.height:n.width,d=o?n.top:n.left,f=o?n.bottom:n.right,l=!1;if(!i){if(c&&Dt<u*r){if(!tt&&(et===1?s>d+u*a/2:s<f-u*a/2)&&(tt=!0),tt)l=!0;else if(et===1?s<d+Dt:s>f-Dt)return-et}else if(s>d+u*(1-r)/2&&s<f-u*(1-r)/2)return ya(t)}return l=l||i,l&&(s<d+u*a/2||s>f-u*a/2)?s>d+u/2?1:-1:0}function ya(e){return pe(y)<pe(e)?1:-1}function ba(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,o=0;n--;)o+=t.charCodeAt(n);return o.toString(36)}function wa(e){It.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var o=t[n];o.checked&&It.push(o)}}function xt(e){return setTimeout(e,0)}function Kt(e){return clearTimeout(e)}At&&X(document,"touchmove",function(e){($.active||He)&&e.cancelable&&e.preventDefault()});$.utils={on:X,off:z,css:T,find:Qn,is:function(t,n){return!!Se(t,n,t,!1)},extend:na,throttle:eo,closest:Se,toggleClass:ce,clone:no,index:pe,nextTick:xt,cancelNextTick:Kt,detectDirection:ro,getChild:ze};$.get=function(e){return e[he]};$.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&($.utils=xe(xe({},$.utils),o.utils)),at.mount(o)})};$.create=function(e,t){return new $(e,t)};$.version=Jr;var Q=[],Ge,Zt,Jt=!1,Lt,Ht,Ot,Ke;function Sa(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var o=n.originalEvent;this.sortable.nativeDraggable?X(document,"dragover",this._handleAutoScroll):this.options.supportPointer?X(document,"pointermove",this._handleFallbackAutoScroll):o.touches?X(document,"touchmove",this._handleFallbackAutoScroll):X(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var o=n.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?z(document,"dragover",this._handleAutoScroll):(z(document,"pointermove",this._handleFallbackAutoScroll),z(document,"touchmove",this._handleFallbackAutoScroll),z(document,"mousemove",this._handleFallbackAutoScroll)),On(),Et(),oa()},nulling:function(){Ot=Zt=Ge=Jt=Ke=Lt=Ht=null,Q.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,o){var r=this,a=(n.touches?n.touches[0]:n).clientX,i=(n.touches?n.touches[0]:n).clientY,c=document.elementFromPoint(a,i);if(Ot=n,o||this.options.forceAutoScrollFallback||rt||Te||Ze){Wt(n,this.options,c,o);var s=Ae(c,!0);Jt&&(!Ke||a!==Lt||i!==Ht)&&(Ke&&On(),Ke=setInterval(function(){var u=Ae(document.elementFromPoint(a,i),!0);u!==s&&(s=u,Et()),Wt(n,r.options,u,o)},10),Lt=a,Ht=i)}else{if(!this.options.bubbleScroll||Ae(c,!0)===De()){Et();return}Wt(n,this.options,Ae(c,!1),!1)}}},ke(e,{pluginName:"scroll",initializeByDefault:!0})}function Et(){Q.forEach(function(e){clearInterval(e.pid)}),Q=[]}function On(){clearInterval(Ke)}var Wt=eo(function(e,t,n,o){if(t.scroll){var r=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,i=t.scrollSensitivity,c=t.scrollSpeed,s=De(),u=!1,d;Zt!==n&&(Zt=n,Et(),Ge=t.scroll,d=t.scrollFn,Ge===!0&&(Ge=Ae(n,!0)));var f=0,l=Ge;do{var g=l,p=te(g),h=p.top,v=p.bottom,_=p.left,F=p.right,M=p.width,Y=p.height,x=void 0,L=void 0,W=g.scrollWidth,k=g.scrollHeight,I=T(g),B=g.scrollLeft,C=g.scrollTop;g===s?(x=M<W&&(I.overflowX==="auto"||I.overflowX==="scroll"||I.overflowX==="visible"),L=Y<k&&(I.overflowY==="auto"||I.overflowY==="scroll"||I.overflowY==="visible")):(x=M<W&&(I.overflowX==="auto"||I.overflowX==="scroll"),L=Y<k&&(I.overflowY==="auto"||I.overflowY==="scroll"));var G=x&&(Math.abs(F-r)<=i&&B+M<W)-(Math.abs(_-r)<=i&&!!B),ee=L&&(Math.abs(v-a)<=i&&C+Y<k)-(Math.abs(h-a)<=i&&!!C);if(!Q[f])for(var E=0;E<=f;E++)Q[E]||(Q[E]={});(Q[f].vx!=G||Q[f].vy!=ee||Q[f].el!==g)&&(Q[f].el=g,Q[f].vx=G,Q[f].vy=ee,clearInterval(Q[f].pid),(G!=0||ee!=0)&&(u=!0,Q[f].pid=setInterval((function(){o&&this.layer===0&&$.active._onTouchMove(Ot);var w=Q[this.layer].vy?Q[this.layer].vy*c:0,m=Q[this.layer].vx?Q[this.layer].vx*c:0;typeof d=="function"&&d.call($.dragged.parentNode[he],m,w,e,Ot,Q[this.layer].el)!=="continue"||to(Q[this.layer].el,m,w)}).bind({layer:f}),24))),f++}while(t.bubbleScroll&&l!==s&&(l=Ae(l,!1)));Jt=u}},30),lo=function(t){var n=t.originalEvent,o=t.putSortable,r=t.dragEl,a=t.activeSortable,i=t.dispatchSortableEvent,c=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(n){var u=o||a;c();var d=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,f=document.elementFromPoint(d.clientX,d.clientY);s(),u&&!u.el.contains(f)&&(i("spill"),this.onSpill({dragEl:r,putSortable:o}))}};function sn(){}sn.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,o=t.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var r=ze(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(n,r):this.sortable.el.appendChild(n),this.sortable.animateAll(),o&&o.animateAll()},drop:lo};ke(sn,{pluginName:"revertOnSpill"});function ln(){}ln.prototype={onSpill:function(t){var n=t.dragEl,o=t.putSortable,r=o||this.sortable;r.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),r.animateAll()},drop:lo};ke(ln,{pluginName:"removeOnSpill"});$.mount(new Sa);$.mount(ln,sn);function jt(e){e.parentElement!==null&&e.parentElement.removeChild(e)}function An(e,t,n){const o=n===0?e.children[0]:e.children[n-1].nextSibling;e.insertBefore(t,o)}function _a(){return typeof window<"u"?window.console:global.console}const Da=_a();function xa(e){const t=Object.create(null);return function(o){return t[o]||(t[o]=e(o))}}const Ea=/-(\w)/g,Ca=xa(e=>e.replace(Ea,(t,n)=>n.toUpperCase())),co=["Start","Add","Remove","Update","End"],uo=["Choose","Unchoose","Sort","Filter","Clone"],fo=["Move"],ka=[fo,co,uo].flatMap(e=>e).map(e=>`on${e}`),Qt={manage:fo,manageAndEmit:co,emit:uo};function Ta(e){return ka.indexOf(e)!==-1}const $a=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function Ia(e){return $a.includes(e)}function Oa(e){return["transition-group","TransitionGroup"].includes(e)}function ho(e){return["id","class","role","style"].includes(e)||e.startsWith("data-")||e.startsWith("aria-")||e.startsWith("on")}function go(e){return e.reduce((t,[n,o])=>(t[n]=o,t),{})}function Aa({$attrs:e,componentData:t={}}){return{...go(Object.entries(e).filter(([o,r])=>ho(o))),...t}}function Pa({$attrs:e,callBackBuilder:t}){const n=go(po(e));Object.entries(t).forEach(([r,a])=>{Qt[r].forEach(i=>{n[`on${i}`]=a(i)})});const o=`[data-draggable]${n.draggable||""}`;return{...n,draggable:o}}function po(e){return Object.entries(e).filter(([t,n])=>!ho(t)).map(([t,n])=>[Ca(t),n]).filter(([t,n])=>!Ta(t))}const Pn=({el:e})=>e,Ma=(e,t)=>e.__draggable_context=t,Mn=e=>e.__draggable_context;class Na{constructor({nodes:{header:t,default:n,footer:o},root:r,realList:a}){this.defaultNodes=n,this.children=[...t,...n,...o],this.externalComponent=r.externalComponent,this.rootTransition=r.transition,this.tag=r.tag,this.realList=a}get _isRootComponent(){return this.externalComponent||this.rootTransition}render(t,n){const{tag:o,children:r,_isRootComponent:a}=this;return t(o,n,a?{default:()=>r}:r)}updated(){const{defaultNodes:t,realList:n}=this;t.forEach((o,r)=>{Ma(Pn(o),{element:n[r],index:r})})}getUnderlyingVm(t){return Mn(t)}getVmIndexFromDomIndex(t,n){const{defaultNodes:o}=this,{length:r}=o,a=n.children,i=a.item(t);if(i===null)return r;const c=Mn(i);if(c)return c.index;if(r===0)return 0;const s=Pn(o[0]),u=[...a].findIndex(d=>d===s);return t<u?0:r}}function Fa(e,t){const n=e[t];return n?n():[]}function Ba({$slots:e,realList:t,getKey:n}){const o=t||[],[r,a]=["header","footer"].map(s=>Fa(e,s)),{item:i}=e;if(!i)throw new Error("draggable element must have an item slot");const c=o.flatMap((s,u)=>i({element:s,index:u}).map(d=>(d.key=n(s),d.props={...d.props||{},"data-draggable":!0},d)));if(c.length!==o.length)throw new Error("Item slot must have only one child");return{header:r,footer:a,default:c}}function Ra(e){const t=Oa(e),n=!Ia(e)&&!t;return{transition:t,externalComponent:n,tag:n?zo(e):t?Xo:e}}function Ya({$slots:e,tag:t,realList:n,getKey:o}){const r=Ba({$slots:e,realList:n,getKey:o}),a=Ra(t);return new Na({nodes:r,root:a,realList:n})}function mo(e,t){_e(()=>this.$emit(e.toLowerCase(),t))}function vo(e){return(t,n)=>{if(this.realList!==null)return this[`onDrag${e}`](t,n)}}function La(e){const t=vo.call(this,e);return(n,o)=>{t.call(this,n,o),mo.call(this,e,n)}}let zt=null;const Ha={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:e=>e},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Wa=["update:modelValue","change",...[...Qt.manageAndEmit,...Qt.emit].map(e=>e.toLowerCase())],ja=Xe({name:"draggable",inheritAttrs:!1,props:Ha,emits:Wa,data(){return{error:!1}},render(){try{this.error=!1;const{$slots:e,$attrs:t,tag:n,componentData:o,realList:r,getKey:a}=this,i=Ya({$slots:e,tag:n,realList:r,getKey:a});this.componentStructure=i;const c=Aa({$attrs:t,componentData:o});return i.render(mn,c)}catch(e){return this.error=!0,mn("pre",{style:{color:"red"}},e.stack)}},created(){this.list!==null&&this.modelValue!==null&&Da.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted(){if(this.error)return;const{$attrs:e,$el:t,componentStructure:n}=this;n.updated();const o=Pa({$attrs:e,callBackBuilder:{manageAndEmit:a=>La.call(this,a),emit:a=>mo.bind(this,a),manage:a=>vo.call(this,a)}}),r=t.nodeType===1?t:t.parentElement;this._sortable=new $(r,o),this.targetDomElement=r,r.__draggable_component__=this},updated(){this.componentStructure.updated()},beforeUnmount(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList(){const{list:e}=this;return e||this.modelValue},getKey(){const{itemKey:e}=this;return typeof e=="function"?e:t=>t[e]}},watch:{$attrs:{handler(e){const{_sortable:t}=this;t&&po(e).forEach(([n,o])=>{t.option(n,o)})},deep:!0}},methods:{getUnderlyingVm(e){return this.componentStructure.getUnderlyingVm(e)||null},getUnderlyingPotencialDraggableComponent(e){return e.__draggable_component__},emitChanges(e){_e(()=>this.$emit("change",e))},alterList(e){if(this.list){e(this.list);return}const t=[...this.modelValue];e(t),this.$emit("update:modelValue",t)},spliceList(){const e=t=>t.splice(...arguments);this.alterList(e)},updatePosition(e,t){const n=o=>o.splice(t,0,o.splice(e,1)[0]);this.alterList(n)},getRelatedContextFromMoveEvent({to:e,related:t}){const n=this.getUnderlyingPotencialDraggableComponent(e);if(!n)return{component:n};const o=n.realList,r={list:o,component:n};return e!==t&&o?{...n.getUnderlyingVm(t)||{},...r}:r},getVmIndexFromDomIndex(e){return this.componentStructure.getVmIndexFromDomIndex(e,this.targetDomElement)},onDragStart(e){this.context=this.getUnderlyingVm(e.item),e.item._underlying_vm_=this.clone(this.context.element),zt=e.item},onDragAdd(e){const t=e.item._underlying_vm_;if(t===void 0)return;jt(e.item);const n=this.getVmIndexFromDomIndex(e.newIndex);this.spliceList(n,0,t);const o={element:t,newIndex:n};this.emitChanges({added:o})},onDragRemove(e){if(An(this.$el,e.item,e.oldIndex),e.pullMode==="clone"){jt(e.clone);return}const{index:t,element:n}=this.context;this.spliceList(t,1);const o={element:n,oldIndex:t};this.emitChanges({removed:o})},onDragUpdate(e){jt(e.item),An(e.from,e.item,e.oldIndex);const t=this.context.index,n=this.getVmIndexFromDomIndex(e.newIndex);this.updatePosition(t,n);const o={element:this.context.element,oldIndex:t,newIndex:n};this.emitChanges({moved:o})},computeFutureIndex(e,t){if(!e.element)return 0;const n=[...t.to.children].filter(i=>i.style.display!=="none"),o=n.indexOf(t.related),r=e.component.getVmIndexFromDomIndex(o);return n.indexOf(zt)!==-1||!t.willInsertAfter?r:r+1},onDragMove(e,t){const{move:n,realList:o}=this;if(!n||!o)return!0;const r=this.getRelatedContextFromMoveEvent(e),a=this.computeFutureIndex(r,e),i={...this.context,futureIndex:a},c={...e,relatedContext:r,draggedContext:i};return n(c,t)},onDragEnd(){zt=null}}}),za={class:"stock-page"},Xa={class:"action-buttons"},Ua={class:"stock-content"},Va={class:"stock-indicator"},qa={class:"kd-indicator"},Ga={class:"rsi-indicator"},Ka={class:"rsi-value"},Za={class:"bubble-content",style:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}},Ja={__name:"Stock",setup(e){const t=Kn(),n=Xn("stock-search");J(null),J(null),J(0),Re(async()=>{try{t.loadUserStocks()}catch(h){console.error("初始化資料庫失敗:",h)}});const o=ne({get(){return t.userStocks},set(h){t.reorderStocks(h)}});function r(){n.emit(!0)}function a(h,v){console.log(`Stock ${v} indicator changed to ${h}`)}function i(h){return h>0?"price-up":h<0?"price-down":"price-flat"}function c(h){return h>70?"rsi-overbought":h<30?"rsi-oversold":"rsi-normal"}function s(h){return h>70?"超買":h<30?"超賣":"正常"}function u(){}function d(h){yt(`買賣 ${h.name}`)}function f(h){yt(`${h.name} 策略設定`)}function l(h){yt(`${h.name} 其他功能`)}function g(h){console.log("開始拖曳",h)}function p(h){console.log("拖曳結束",h)}return Uo(document,"visibilitychange",()=>{document.visibilityState==="visible"&&t.loadUserStocks()}),Re(()=>{}),(h,v)=>(me(),we("div",za,[H(re(ja),{modelValue:o.value,"onUpdate:modelValue":v[1]||(v[1]=_=>o.value=_),"item-key":"id",delay:200,animation:200,"ghost-class":"stock-row-ghost",onStart:g,onEnd:p},{item:de(({element:_,index:F})=>[j("div",{class:"stock-row",onContextmenu:v[0]||(v[0]=Vo(()=>{},["prevent"]))},[H(re(mr),{"left-width":200,onClickLeft:u},{left:de(()=>[j("div",Xa,[H(re(bt),{type:"primary",size:"small",class:"action-btn buy-btn",onClick:M=>d(_)},{default:de(()=>v[2]||(v[2]=[j("div",null,"交 易",-1),j("div",null,"記 錄",-1)])),_:2,__:[2]},1032,["onClick"]),H(re(bt),{type:"warning",size:"small",class:"action-btn strategy-btn",onClick:M=>f(_)},{default:de(()=>v[3]||(v[3]=[Ut(" 策 略 ",-1)])),_:2,__:[3]},1032,["onClick"]),H(re(bt),{type:"default",size:"small",class:"action-btn other-btn",onClick:M=>l(_)},{default:de(()=>v[4]||(v[4]=[Ut(" 更 多 ",-1)])),_:2,__:[4]},1032,["onClick"])])]),default:de(()=>[j("div",Ua,[H(qr,{name:_.name,code:_.code,price:_.price,change:_.change,"change-percent":_.changePercent,"price-class":i(_.change),progress:_.progress,"progress-text":_.progressText},null,8,["name","code","price","change","change-percent","price-class","progress","progress-text"]),j("div",Va,[H(re(Zo),{"show-indicators":!1,loop:!1,autoplay:0,onChange:M=>a(M,F)},{default:de(()=>[H(re(yn),{class:"indicator-content"},{default:de(()=>[j("div",qa,[H(Rr,{width:120,height:60,"stock-data":_,"stock-index":F},null,8,["stock-data","stock-index"])])]),_:2},1024),H(re(yn),{class:"indicator-content"},{default:de(()=>[j("div",Ga,[j("div",Ka,fe(_.rsi),1),j("div",{class:Vt(["rsi-trend",c(_.rsi)])},fe(s(_.rsi)),3)])]),_:2},1024)]),_:2},1032,["onChange"])])])]),_:2},1024)],32)]),_:1},8,["modelValue"]),H(re(rr),{axis:"xy",magnetic:"x",gap:{x:20,y:80},style:{"--van-floating-bubble-size":"56px","--van-floating-bubble-background":"rgba(255, 224, 102, 0.9)","--van-floating-bubble-icon-size":"22px","--van-floating-bubble-color":"#322b0d"},onClick:r},{default:de(()=>[j("div",Za,[H(re(Hn),{name:"plus",size:"22",color:"#322b0d",style:{"margin-bottom":"2px"}}),v[5]||(v[5]=j("span",{class:"bubble-label",style:{color:"#322b0d","font-size":"14px"}},"新增",-1))])]),_:1}),H(Nr)]))}},ti=rn(Ja,[["__scopeId","data-v-6ff44ccb"]]);export{ti as default};
