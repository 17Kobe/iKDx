import{aA as J,h as d,aB as X,w as Y,aj as D,j as T,q as Z,aC as A,_ as ss,a5 as m,a1 as f,a3 as s,aa as c,a7 as es,a8 as ts,ak as os,a9 as as,ap as ls,v as l,a2 as g,a4 as o,a6 as F,C as h,a0 as is,ao as L,aq as ns,ar as rs,ab as w,as as us}from"./index-DjD8zt9v.js";import{I as y,s as W}from"./iconify-D5br0ME2.js";import{T as cs,a as ds}from"./index-CQ8tfuwf.js";import{B as C}from"./index-DoVE3bBK.js";import{A as S}from"./index-w1Bq76Hu.js";import"./index-C2vRLVN4.js";const vs=J("theme",()=>{const _=d(0),r=d(!1),i=X();return Y([_,i],()=>{_.value===0?r.value=i.value:_.value===1?r.value=!1:r.value=!0,document.body.classList.toggle("dark",r.value)},{immediate:!0}),{mode:_,isDark:r}}),gs={class:"worker-monitor"},fs={class:"monitor-header"},ms={class:"total-cpu"},ps={class:"pool-stats"},hs={class:"pool-name"},_s={class:"pool-info"},ks={class:"stat-item"},bs={class:"value"},ws={class:"stat-item"},ys={class:"value busy"},xs={class:"stat-item"},Cs={class:"value queue"},$s={class:"stat-item"},Ss={class:"value utilization"},Ts={class:"progress-bar"},zs={class:"overall-stats"},Bs={class:"stat-box"},Ws={class:"stat-value"},Us={class:"stat-box"},As={class:"stat-value"},Fs={class:"stat-box"},Ls={class:"stat-value"},Ds={__name:"WorkerMonitor",setup(_){const r=d({}),i=d(navigator.hardwareConcurrency||4),$=T(()=>Object.values(r.value).reduce((n,t)=>n+t.busyWorkers,0)),k=T(()=>Object.values(r.value).reduce((n,t)=>n+t.queuedTasks,0)),b=T(()=>{const n=Object.values(r.value);return n.length===0?"0.0":(n.reduce((p,z)=>{const B=parseFloat(z.utilization)||0;return p+B},0)/n.length).toFixed(1)}),x=(n,t,u)=>{r.value={...u}};return Z(()=>{A.onAllStatusChange(x),r.value=A.getAllStatus()}),ss(()=>{}),(n,t)=>(f(),m("div",gs,[s("div",fs,[t[0]||(t[0]=s("h3",null,"Worker Pool 監控",-1)),s("span",ms,"CPU 核心數: "+c(i.value),1)]),s("div",ps,[(f(!0),m(es,null,ts(r.value,(u,p)=>(f(),m("div",{key:p,class:os(["pool-card",{"pool-busy":u.busyWorkers>0}])},[s("div",hs,c(p),1),s("div",_s,[s("div",ks,[t[1]||(t[1]=s("span",{class:"label"},"可用:",-1)),s("span",bs,c(u.availableWorkers)+"/"+c(u.totalWorkers),1)]),s("div",ws,[t[2]||(t[2]=s("span",{class:"label"},"使用中:",-1)),s("span",ys,c(u.busyWorkers),1)]),s("div",xs,[t[3]||(t[3]=s("span",{class:"label"},"排隊:",-1)),s("span",Cs,c(u.queuedTasks),1)]),s("div",$s,[t[4]||(t[4]=s("span",{class:"label"},"使用率:",-1)),s("span",Ss,c(u.utilization)+"%",1)])]),s("div",Ts,[s("div",{class:"progress-fill",style:as({width:u.utilization+"%"})},null,4)])],2))),128))]),s("div",zs,[s("div",Bs,[s("div",Ws,c($.value),1),t[5]||(t[5]=s("div",{class:"stat-label"},"總使用中",-1))]),s("div",Us,[s("div",As,c(k.value),1),t[6]||(t[6]=s("div",{class:"stat-label"},"總排隊",-1))]),s("div",Fs,[s("div",Ls,c(b.value)+"%",1),t[7]||(t[7]=s("div",{class:"stat-label"},"整體使用率",-1))])])]))}},Gs=D(Ds,[["__scopeId","data-v-4aea0f26"]]),Ms={class:"my-page"},Ps={class:"tab-content"},Vs={key:0,class:"auth-section"},Is={class:"login-prompt"},js={class:"login-icon"},qs={key:1,class:"user-section"},Ns={class:"user-info"},Os={class:"user-avatar"},Es=["src","alt"],Ks={class:"user-details"},Qs={key:2,class:"guest-section"},Rs={class:"guest-info"},Hs={class:"guest-icon"},Js={class:"guest-details"},Xs={class:"setting-list"},Ys={class:"setting-right"},Zs={class:"setting-value"},se={style:{padding:"20px","max-height":"70vh","overflow-y":"auto"}},ee={class:"login-sheet-content"},te={class:"login-logo-section"},oe={class:"app-logo"},ae={class:"login-buttons"},le={class:"login-terms"},ie={class:"terms-text"},ne={class:"loading-content"},re={__name:"My",setup(_){us();const r=vs(),i=ls(),$=d("basic"),k=d(!1),b=d(!1),x=d(!1),n=d(!1),t=d(!1),u=d(!1),p=d(!1),z=T(()=>{switch(r.mode){case 0:return"跟隨系統";case 1:return"亮";case 2:return"暗";default:return"跟隨系統"}}),B=[{name:"跟隨系統",value:0},{name:"亮",value:1},{name:"暗",value:2}],G=[{name:"Worker Pool 監控",value:"worker"},{name:"應用資訊",value:"info"},{name:"清除快取",value:"clear"}];function M(){k.value=!0}function P(){b.value=!0}function U(){n.value=!0}function V(){W({title:"確認登出",message:"確定要登出嗎？",showCancelButton:!0,confirmButtonText:"登出",cancelButtonText:"取消"}).then(()=>{i.logout(),w.success("已登出")}).catch(()=>{})}function I(a){console.log("切換到：",a)}function j(a){r.mode=a.value,k.value=!1}function q(a){switch(b.value=!1,a.value){case"worker":x.value=!0;break;case"info":console.log("顯示應用資訊");break;case"clear":console.log("清除快取");break}}async function N(){try{u.value=!0,t.value=!0;const a=await K();if(a.success)await i.loginWithGoogle(a.token),w.success("Google 登入成功！"),n.value=!1;else throw new Error(a.error)}catch(a){console.error("Google 登入失敗:",a),w.fail("Google 登入失敗，請稍後再試")}finally{u.value=!1,t.value=!1}}async function O(){try{p.value=!0,t.value=!0;const a=await Q();if(a.success)await i.loginWithFacebook(a.token),w.success("Facebook 登入成功！"),n.value=!1;else throw new Error(a.error)}catch(a){console.error("Facebook 登入失敗:",a),w.fail("Facebook 登入失敗，請稍後再試")}finally{p.value=!1,t.value=!1}}function E(){n.value=!1,w("繼續使用訪客模式")}async function K(){return new Promise(a=>{setTimeout(()=>{a({success:!0,token:"mock-google-token",user:{id:"google-123",name:"測試用戶",email:"test@gmail.com",avatar:""}})},1500)})}async function Q(){return new Promise(a=>{setTimeout(()=>{a({success:!0,token:"mock-facebook-token",user:{id:"fb-123",name:"測試用戶",email:"test@facebook.com",avatar:""}})},1500)})}function R(){W({title:"服務條款",message:"這裡是服務條款內容...",showCancelButton:!1,confirmButtonText:"我知道了"})}function H(){W({title:"隱私政策",message:"這裡是隱私政策內容...",showCancelButton:!1,confirmButtonText:"我知道了"})}return(a,e)=>(f(),m("div",Ms,[l(o(ds),{active:$.value,"onUpdate:active":e[0]||(e[0]=v=>$.value=v),swipeable:"",sticky:"",onChange:I,class:"custom-tabs"},{default:g(()=>[l(o(cs),{title:"基本",name:"basic"},{default:g(()=>[s("div",Ps,[o(i).isAuthenticated?o(i).isLoggedIn?(f(),m("div",qs,[s("div",Ns,[s("div",Os,[o(i).user?.avatar?(f(),m("img",{key:0,src:o(i).user.avatar,alt:o(i).user.name},null,8,Es)):(f(),is(o(y),{key:1,icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#ccc"}))]),s("div",Ks,[s("h3",null,c(o(i).user?.name||"用戶"),1),s("p",null,c(o(i).user?.email),1)])])])):o(i).isGuestMode?(f(),m("div",Qs,[s("div",Rs,[s("div",Hs,[l(o(y),{icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#999"})]),s("div",Js,[e[10]||(e[10]=s("h3",null,"訪客模式",-1)),e[11]||(e[11]=s("p",null,"資料僅保存在本地",-1)),l(o(C),{type:"primary",size:"small",plain:"",onClick:U,style:{"margin-top":"8px"}},{default:g(()=>e[9]||(e[9]=[h(" 切換到登入 ",-1)])),_:1,__:[9]})])])])):F("",!0):(f(),m("div",Vs,[s("div",Is,[s("div",js,[l(o(y),{icon:"flowbite:user-circle-solid",width:"60",height:"60",color:"#ccc"})]),e[7]||(e[7]=s("h3",null,"歡迎使用 iKDx",-1)),e[8]||(e[8]=s("p",null,"登入後可同步您的股票資料",-1)),l(o(C),{type:"primary",size:"large",round:"",block:"",onClick:U,style:{"margin-top":"16px"}},{default:g(()=>e[6]||(e[6]=[h(" 立即登入 ",-1)])),_:1,__:[6]})])])),s("div",Xs,[o(i).isLoggedIn?(f(),m("div",{key:0,class:"setting-item",onClick:V},e[12]||(e[12]=[s("div",{class:"setting-left"},[s("span",{class:"setting-title"},"登出")],-1),s("div",{class:"setting-right"},[s("span",{class:"arrow"},">")],-1)]))):F("",!0),s("div",{class:"setting-item",onClick:M},[e[14]||(e[14]=s("div",{class:"setting-left"},[s("span",{class:"setting-title"},"主題")],-1)),s("div",Ys,[s("span",Zs,c(z.value),1),e[13]||(e[13]=s("span",{class:"arrow"},">",-1))])]),s("div",{class:"setting-item",onClick:P},e[15]||(e[15]=[s("div",{class:"setting-left"},[s("span",{class:"setting-title"},"開發者")],-1),s("div",{class:"setting-right"},[s("span",{class:"arrow"},">")],-1)]))])])]),_:1})]),_:1},8,["active"]),l(o(S),{show:k.value,"onUpdate:show":e[1]||(e[1]=v=>k.value=v),actions:B,title:"選擇主題","cancel-text":"取消",onSelect:j},null,8,["show"]),l(o(S),{show:b.value,"onUpdate:show":e[2]||(e[2]=v=>b.value=v),actions:G,title:"開發者選項","cancel-text":"取消",onSelect:q},null,8,["show"]),l(o(S),{show:x.value,"onUpdate:show":e[3]||(e[3]=v=>x.value=v),title:"Worker Pool 監控","cancel-text":"關閉"},{default:g(()=>[s("div",se,[l(Gs)])]),_:1},8,["show"]),l(o(S),{show:n.value,"onUpdate:show":e[4]||(e[4]=v=>n.value=v),title:"登入 iKDx","cancel-text":"取消",class:"login-action-sheet"},{default:g(()=>[s("div",ee,[s("div",te,[s("div",oe,[l(o(y),{icon:"flowbite:star-solid",width:"50",height:"50",color:"#FFD600"})]),e[16]||(e[16]=s("h2",{class:"app-title"},"智能股票分析平台",-1)),e[17]||(e[17]=s("p",{class:"login-subtitle"},"登入後可同步您的股票資料到雲端",-1))]),s("div",ae,[l(o(C),{class:"login-btn google-btn",size:"large",block:"",loading:u.value,onClick:N},{default:g(()=>[l(o(y),{icon:"logos:google-icon",width:"20",height:"20",style:{"margin-right":"8px"}}),e[18]||(e[18]=h(" 使用 Google 帳號登入 ",-1))]),_:1,__:[18]},8,["loading"]),l(o(C),{class:"login-btn facebook-btn",size:"large",block:"",loading:p.value,onClick:O},{default:g(()=>[l(o(y),{icon:"logos:facebook",width:"20",height:"20",style:{"margin-right":"8px"}}),e[19]||(e[19]=h(" 使用 Facebook 帳號登入 ",-1))]),_:1,__:[19]},8,["loading"]),e[21]||(e[21]=s("div",{class:"login-divider"},[s("span",null,"或")],-1)),l(o(C),{class:"guest-continue-btn",size:"large",block:"",plain:"",onClick:E},{default:g(()=>e[20]||(e[20]=[h(" 繼續使用訪客模式 ",-1)])),_:1,__:[20]})]),s("div",le,[s("p",ie,[e[22]||(e[22]=h(" 登入即表示您同意我們的 ",-1)),s("a",{href:"#",onClick:L(R,["prevent"])},"服務條款"),e[23]||(e[23]=h(" 和 ",-1)),s("a",{href:"#",onClick:L(H,["prevent"])},"隱私政策")])])])]),_:1},8,["show"]),l(o(rs),{show:t.value,"onUpdate:show":e[5]||(e[5]=v=>t.value=v),class:"loading-overlay"},{default:g(()=>[s("div",ne,[l(o(ns),{size:"24px",vertical:""},{default:g(()=>e[24]||(e[24]=[h("登入中...",-1)])),_:1,__:[24]})])]),_:1},8,["show"])]))}},me=D(re,[["__scopeId","data-v-18419f83"]]);export{me as default};
