const n={calcTrade:async function(o){try{const{stockData:e,tradeParams:s}=o;if(!e||e.length===0)throw new Error("股價資料為空");const a=e[0],r=e[e.length-1],t={entryPrice:parseFloat(a[4]),exitPrice:parseFloat(r[4]),trades:e.length,profit:0,profitRate:0,startDate:a[0],endDate:r[0]};return t.profit=t.exitPrice-t.entryPrice,t.profitRate=t.profit/t.entryPrice*100,{success:!0,result:t,processedAt:new Date().toISOString()}}catch(e){return{success:!1,error:e.message,processedAt:new Date().toISOString()}}},ping:async function(){return"Trade Worker Pong! "+new Date().toISOString()}};self.onmessage=async function(o){const{messageId:e,method:s,params:a}=o.data;try{if(n[s]){const r=await n[s](a);self.postMessage({messageId:e,result:r,error:null})}else throw new Error(`未知的方法: ${s}`)}catch(r){self.postMessage({messageId:e,result:null,error:r.message})}};
